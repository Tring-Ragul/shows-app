const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-CM9hMnv_.js","assets/react-CM5yTbUf.js","assets/polyfills-B2r8-n11.js"])))=>i.map(i=>d[i]);
import{c as $d,j as n,r as m,a as Od,R as Md,b as he}from"./react-CM5yTbUf.js";import{W as Hc,c as Dd,s as Rd,i as Br,p as Fd,L as le,a as on,b as te,d as Wc,e as R,_ as Z,g as Zr,h as me,j as Vc,k as Bd,m as Ha,l as Ud,n as Wa,o as Hd,q as qc,r as Wd,t as Vd,B as qd,Q as zd,u as Gd,v as I,w as L,x as Jd,y as Yd,z as Kd,A as Qd,N as zc,T as Gc,C as Ds,V as Va,D as se,E as re,F as it,G as Xd,P as ft,H as Q,I as dn,R as Zd,J as qe,K as Hn,M as ea,O as ta,S as eu,U as Ur,X as tu,Y as Jc,Z as su,$ as nu,a0 as sa,a1 as Rs,a2 as Tt,a3 as na,a4 as ru,a5 as Os,a6 as Yc,a7 as au,a8 as Kc,a9 as ou,aa as iu,ab as cu,ac as lu,ad as du,ae as uu,af as hu,ag as mu,ah as pu,ai as fu,aj as gu,ak as qa,al as _u,am as Me,an as yu}from"./vendor-CM9hMnv_.js";import{I as Js}from"./inplayer-DK3H_jlA.js";import"./index-CcuyHatq.js";import"./polyfills-B2r8-n11.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();const vu="modulepreload",xu=function(t){return"/"+t},za={},ra=function(e,s,r){let a=Promise.resolve();if(s&&s.length>0){let l=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");a=l(s.map(d=>{if(d=xu(d),d in za)return;za[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":vu,u||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),u)return new Promise((g,f)=>{p.addEventListener("load",g),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return a.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};var GC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function JC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function bu(t={}){const{immediate:e=!1,onNeedRefresh:s,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=t;let c,l;const d=async(h=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(c=await ra(async()=>{const{Workbox:h}=await import("./vendor-CM9hMnv_.js").then(p=>p.ao);return{Workbox:h}},__vite__mapDeps([0,1,2])).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{i?.(h)}),!c)return;c.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),c.addEventListener("installed",h=>{h.isUpdate||r?.()}),c.register({immediate:e}).then(h=>{o?o("/sw.js",h):a?.(h)}).catch(h=>{i?.(h)})}}return l=u(),d}const M={APP_VERSION:"",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_API_ACCESS_BRIDGE_URL:"",APP_PLAYER_ID:"M4qoGvUk",APP_FOOTER_TEXT:"",APP_DEFAULT_LANGUAGE:"en",APP_PUBLIC_URL:"",APP_GTM_LOAD_ON_ACCEPT:!1},wu=t=>{M.APP_VERSION=t.APP_VERSION||M.APP_VERSION,M.APP_API_BASE_URL=t.APP_API_BASE_URL||M.APP_API_BASE_URL,M.APP_API_ACCESS_BRIDGE_URL=t.APP_API_ACCESS_BRIDGE_URL||M.APP_API_ACCESS_BRIDGE_URL,M.APP_PLAYER_ID=t.APP_PLAYER_ID||M.APP_PLAYER_ID,M.APP_FOOTER_TEXT=t.APP_FOOTER_TEXT||M.APP_FOOTER_TEXT,M.APP_DEFAULT_LANGUAGE=t.APP_DEFAULT_LANGUAGE||M.APP_DEFAULT_LANGUAGE,M.APP_PUBLIC_URL=t.APP_PUBLIC_URL||M.APP_PUBLIC_URL,M.APP_CONSENT_COOKIE_NAME||=t.APP_CONSENT_COOKIE_NAME,M.APP_CONSENT_COOKIE_POLICY_URL||=t.APP_CONSENT_COOKIE_POLICY_URL,M.APP_DEFAULT_CONFIG_SOURCE||=t.APP_DEFAULT_CONFIG_SOURCE,M.APP_PLAYER_LICENSE_KEY||=t.APP_PLAYER_LICENSE_KEY,M.APP_BODY_FONT=M.APP_BODY_FONT,M.APP_BODY_ALT_FONT=M.APP_BODY_ALT_FONT,M.APP_GTM_TAG_ID||=t.APP_GTM_TAG_ID,M.APP_GTM_TAG_SERVER||=t.APP_GTM_TAG_SERVER,M.APP_GTM_SCRIPT||=t.APP_GTM_SCRIPT,M.APP_GTM_LOAD_ON_ACCEPT=M.APP_GTM_LOAD_ON_ACCEPT,M.APP_CHROMECAST_APPLICATION_ID=M.APP_CHROMECAST_APPLICATION_ID};var yt=(t=>(t.ContinueWatching="continue_watching",t.Favorites="favorites",t))(yt||{});const Su=["favorites","continue_watching"],ss={JWP:"JWP",CLEENG:"CLEENG"},Ae={AVOD:"AVOD",AUTHVOD:"AUTHVOD",SVOD:"SVOD"},Zt={Min:.05,Max:.95},ju=25,Cu=500,Qc="test_I4OFGUUCEVB5TI222AS3N2Y2LY6PJM3K",Xc="live_BQDOFBYTGZB3XKF62GBYSLPUJ4YW2TPL",Pu=15*6e4,Ve={series:"series",episode:"episode",liveChannel:"livechannel",liveEvent:"liveevent",page:"page",hub:"hub"},Eu={live:"live"},Ga={hero:"hero",featured:"featured"},Hr="M4qoGvUk",nn="app-config",jn="config-file-override",gs=60*1e3*20,_s=60*1e3*20,ku=["1:1","2:1","2:3","4:3","5:3","16:9","9:13","9:16"],aa=48,Iu={canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!1,canRenewSubscription:!1,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!1,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:aa},oa={jwp:"jwp",viewNexa:"viewnexa"},Ft={playlist:"playlist",content_list:"content_list",media:"media"},Nu={dash:'application/dash+xml"'},K=new Hc({defaultScope:"Singleton"});function W(t,e=!0){const s=K.getAll(t)[0];if(e&&!s)throw new Error(`Service / Controller '${String(t)}' not found`);return s}function Au(t){return K.getAll(t)}function Nt(t,e,s=!0){if(!e){if(s)throw new Error(`Service not found '${String(t)}' with name '${e}'`);return}let r;try{return r=K.getAll(t,{name:e})[0],r}catch(a){if(a instanceof Error&&a.message.includes("No matching bindings found")){if(s)throw new Error(`Service not found '${String(t)}' with name '${e}'`);return}console.error("Error caught while initializing service",a)}}function J(t,e){if(!t)throw new Error(e)}function nr(t,e){if(!t)throw new Error(`${e} feature is not enabled`)}const Fs=Symbol("INTEGRATION_TYPE"),ia=Symbol("DETERMINE_INTEGRATION_TYPE"),un=Symbol("GET_CUSTOMER_IP"),Zc=Symbol("API_ACCESS_BRIDGE_URL"),el=Symbol("BROADCAST_CHANNEL");function Tu(t,e=200){let s;function r(...a){s&&clearTimeout(s),s=setTimeout(()=>t(...a),e)}return r.cancel=()=>clearTimeout(s),r}function Lu(t,e){let s,r;function a(...o){const i=r?Date.now()-r:e;i>=e?(t.apply(this,o),r=Date.now()):s||(s=setTimeout(()=>{r&&Date.now()-r>=e&&(t.apply(this,o),r=Date.now()),s=void 0},e-i))}return a.cancel=()=>clearTimeout(s),a}const $u=t=>t.replace(/\\u[\dA-F]{4}/gi,e=>String.fromCharCode(parseInt(e.replace(/\\u/g,""),16)));function Ou(t){if(t.indexOf("#")===0&&(t=t.slice(1)),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length===6)return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}}function Cn(t){const e=Ou(t);return e?e.r*.299+e.g*.587+e.b*.114>186?"#000000":"#FFFFFF":""}const Mu=!1,Du=!1,Bt=(t,e)=>t.contentType?.toLowerCase()===e.toLowerCase(),ns=t=>["true","1","yes","on"].includes(String(t)?.toLowerCase()),Ru=t=>["false","0","no","off"].includes(String(t)?.toLowerCase());const Fu=t=>!!t;var Ut=(t=>(t.LIVE="LIVE",t.VOD="VOD",t.SCHEDULED="SCHEDULED",t))(Ut||{});const ca=t=>!!t&&Bt(t,Ve.liveEvent),tl=t=>t.mediaStatus==="SCHEDULED"||t.mediaStatus==="LIVE",Bu=t=>{const e=t["VCH.EventState"],{scheduledStart:s,scheduledEnd:r}=t,a=new Date;if((e==="LIVE_PUBLISHED"||s&&s<a)&&r&&r>a)return"LIVE";if(!e)return"VOD";switch(e){case"PRE_LIVE":case"LIVE_UNPUBLISHED":return"SCHEDULED";case"LIVE_PUBLISHED":return"LIVE";case"INSTANT_VOD":case"VOD_PUBLIC":return"VOD"}},Uu=t=>t.mediaStatus==="LIVE"||t.mediaStatus==="VOD",sl="/m/:id/*",la="/p/:id/*",nl="/n/:id/*",Hu="/s/:id/*",Wu="/q/*",Vu="/o/about",zn="/u",qu=`${zn}/*`,cn="my-account",da="favorites",ua="payments",zu=`${zn}/${cn}`,Gu=`${zn}/${da}`,Ju=`${zn}/${ua}`;var Ye=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t[t.FATAL=4]="FATAL",t[t.SILENT=5]="SILENT",t))(Ye||{});class ha{}const Yu=t=>t instanceof Error?t:new Error(String(t)),hn=t=>(e,s,{error:r,...a}={})=>{Au(ha).forEach(i=>{i.log(t,e,s,a,r?Yu(r):void 0)})},gt=hn(Ye.DEBUG),rl=hn(Ye.INFO),ms=hn(Ye.WARN),Pe=hn(Ye.ERROR);hn(Ye.FATAL);const al=t=>t?t.seriesPlayListId||t.seriesPlaylistId||t.seriesId:void 0,ol=t=>typeof al(t)<"u",Ku=t=>Bt(t,Ve.series),il=t=>ol(t)||Ku(t),cl=t=>typeof t?.episodeNumber<"u"||Bt(t,Ve.episode),Qu=t=>{if(!t||!cl(t))return;const s=(t.tags?t.tags.split(","):[]).find(function(r){return/seriesid_([\w\d]+)/i.test(r)});if(s)return s.split("_")[1]},ll=t=>Bt(t,Ve.liveChannel),dl=t=>!!t.scheduledStart&&ca(t)||!!t.subtitle,ye=(t,e)=>{const[s,r=""]=t.split("?"),a=new URLSearchParams(r);Object.entries(e).forEach(([i,c])=>{if(c==null)return a.delete(i);const l=Array.isArray(c)?c.join(","):c;a.set(i,String(l))});const o=a.toString();return`${s}${o?`?${o}`:""}`},Gn=(t,e,s)=>{const r=t.split("/").map(a=>{if(a==="*")return e?Object.entries(e).filter(([l])=>!t.includes(l)).map(([l,d])=>d).join("/"):a;if(!a.startsWith(":")||!e)return a;const o=a.endsWith("?"),i=a.replace(":","").replace("?",""),c=e[i];return c||(o||ms("urlFormatting","Missing param in path creation",{path:t,paramName:i}),"")}).join("/");return s?ye(r,s):r},Jn=(t,e="-")=>t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-/g,e),ue=({id:t,title:e,playlistId:s,play:r=!1,episodeId:a})=>Gn(sl,{id:t,title:e?Jn(e):void 0},{r:s,play:r?"1":null,e:a}),Xu=(t,e)=>Gn(la,{id:t,title:e?Jn(e):void 0}),Zu=(t,e)=>Gn(nl,{id:t,title:e?Jn(e):void 0}),ul=({type:t,contentId:e,label:s})=>{switch(t){case Ft.content_list:return Zu(e,s);case Ft.media:return ue({id:e,title:s});case Ft.playlist:return Xu(e,s);default:return""}},Ts=(t,e,s=!1)=>Gn(la,{id:t},{channel:e,play:s?"1":null}),hs=({seriesId:t,episodeId:e,play:s,playlistId:r})=>ye(`/s/${t}`,{r,e,play:s?"1":null}),hl=(t,e,s)=>{const r=Qu(t),a=al(t);return hs({seriesId:a||r||"",play:e,playlistId:s,episodeId:r&&t.mediaid})};class ml extends Error{code;message;constructor(e="",s){super(e),this.name="ApiError",this.message=e,this.code=s}}const at=async t=>{const e=await t.json();if(!t.ok){const s=`Request '${t.url}' failed with ${t.status}`,r=e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:void 0;throw new ml(r||s,t.status||500)}return e},pl=t=>Ru(t?.requiresSubscription)||ns(t?.free),Yn=(t,e,s,r)=>{const a=r?.mediaOffers;return!(pl(r)||Bt(r,Ve.hub)||t===Ae.AVOD&&!a||t===Ae.AUTHVOD&&e&&!a||t===Ae.SVOD&&s&&!a?.some(o=>o.premier))},eh=(t,e)=>e?e.replace(/\s/g,"").split(",").reduce((s,r)=>r.indexOf(`${t}:`)===0||r.indexOf(`!${t}:`)===0?[...s,{offerId:r.slice(r.indexOf(":")+1),premier:r[0]==="!"}]:s,[]):null,ys=(t,e)=>{const s=Rd(e);return Dd(s)},H=ys("ConfigStore",()=>({loaded:!1,config:{id:"",siteName:"",description:"",player:"",siteId:"",assets:{},content:[],menu:[],integrations:{cleeng:{useSandbox:!0},jwp:{clientId:null,assetId:null,useSandbox:!0}},styling:{}},settings:{additionalAllowedConfigSources:[],playerId:Hr},supportedLanguages:[],accessModel:Ae.AVOD,integrationType:null}));var Ja,Ya;const Ka=20;let xe=(Ja=le(),Ja(Ya=class{generateAlternateImageURL=({mediaId:e,label:s,playlistLabel:r})=>{const a=`/v2/media/${e}/images/${r||s}.webp`;return ye(`${M.APP_API_BASE_URL}${a}`,{poster_fallback:1,fallback:r?s:null})};parseDate=(e,s)=>{const r=e[s];if(r&&!Br(new Date(r))){Pe("ApiService",`Invalid "${s}" date provided for the "${e.title}" media item`,{error:new Error("Invalid date")});return}return r?Fd(r):void 0};getTranslatedFields=(e,s)=>{if(!s)return e;const r=M.APP_DEFAULT_LANGUAGE,a={...e};if(s!==r)for(const[o,i]of Object.entries(a))e[`${o}-${s}`]&&(a[o]=e[`${o}-${s}`]);return a};transformContentList=(e,s)=>{const{list:r,id:a,...o}=e,i={...o,feedid:a,playlist:[]};return i.playlist=r.map(c=>{const{custom_params:l,media_id:d,description:u,tags:h,...p}=c,g={feedid:e.id,mediaid:d,tags:h.join(","),description:u||"",sources:[],images:[],image:"",link:"",pubdate:0,...p,...l};return this.transformMediaItem({item:g,playlist:i,language:s})}),i};transformPlaylist=(e,s,r)=>(e.playlist=e.playlist.map(a=>this.transformMediaItem({item:a,playlist:e,language:r})),s&&(e.playlist=e.playlist.filter(a=>a.mediaid!==s)),e);transformMediaItem=({item:e,playlist:s,language:r})=>{const a=H.getState().config,o=Object.keys(a?.integrations)[0],i=s?.imageLabel,c=e.mediaid,l=this.getTranslatedFields(e,r),d={...e,...l,cardImage:this.generateAlternateImageURL({mediaId:c,label:"card",playlistLabel:i}),channelLogoImage:this.generateAlternateImageURL({mediaId:c,label:"channel_logo",playlistLabel:i}),backgroundImage:this.generateAlternateImageURL({mediaId:c,label:"background"}),mediaOffers:e.productIds?eh(o,e.productIds):void 0,scheduledStart:this.parseDate(e,"VCH.ScheduledStart"),scheduledEnd:this.parseDate(e,"VCH.ScheduledEnd")};return d.mediaStatus=Bu(d),d};transformEpisodes=(e,s,r)=>{const{episodes:a,page:o,page_limit:i,total:c}=e;return{episodes:a.filter(l=>l.media_item).map(l=>({...this.transformMediaItem({item:l.media_item,language:s}),seasonNumber:r?.toString()||l.season_number?.toString()||"",episodeNumber:String(l.episode_number)})),pagination:{page:o,page_limit:i,total:c}}};getMediaByWatchlist=async({playlistId:e,mediaIds:s,token:r,language:a})=>{if(!s?.length)return[];const o=`/apps/watchlists/${e}`,i=ye(`${M.APP_API_BASE_URL}${o}`,{token:r,media_ids:s}),c=await fetch(i),l=await at(c);if(!l)throw new Error(`The data was not found using the watchlist ${e}`);return(l.playlist||[]).map(d=>this.transformMediaItem({item:d,language:a}))};getMediaById=async({id:e,token:s,drmPolicyId:r,language:a})=>{const o=r?`/v2/media/${e}/drm/${r}`:`/v2/media/${e}`,i=ye(`${M.APP_API_BASE_URL}${o}`,{token:s}),c=await fetch(i),d=(await at(c)).playlist[0];if(!d)throw new Error("MediaItem not found");return this.transformMediaItem({item:d,language:a})};getMediaByIdWithPassport=async({id:e,siteId:s,planId:r,passport:a,language:o})=>{const i=`/v2/sites/${s}/media/${e}/playback.json`,c=ye(`${M.APP_API_BASE_URL}${i}`,{passport:a,plan_id:r}),l=await fetch(c),u=(await at(l)).playlist[0];if(!u)throw new Error("MediaItem not found");return this.transformMediaItem({item:u,language:o})};getSeries=async(e,s={})=>{if(!e)throw new Error("Series ID is required");const r=`/apps/series/${e}`,a=ye(`${M.APP_API_BASE_URL}${r}`,s),o=await fetch(a);return await at(o)};getSeriesByMediaIds=async e=>{const r=`${M.APP_API_BASE_URL}/apps/series?media_ids=${e.join(",")}`,a=await fetch(r);return await at(a)};getEpisodes=async({seriesId:e,pageOffset:s,pageLimit:r=Ka,afterId:a,language:o})=>{if(!e)throw new Error("Series ID is required");const i=`/apps/series/${e}/episodes`,c=ye(`${M.APP_API_BASE_URL}${i}`,{page_offset:s,page_limit:r,after_id:a}),l=await fetch(c),d=await at(l);return this.transformEpisodes(d,o)};getSeasonWithEpisodes=async({seriesId:e,seasonNumber:s,pageOffset:r,pageLimit:a=Ka,language:o})=>{if(!e)throw new Error("Series ID is required");const i=`/apps/series/${e}/seasons/${s}/episodes`,c=ye(`${M.APP_API_BASE_URL}${i}`,{page_offset:r,page_limit:a}),l=await fetch(c),d=await at(l);return this.transformEpisodes(d,o,s)};getAdSchedule=async e=>{if(!e)throw new Error("Ad Schedule ID is required");const s=M.APP_API_BASE_URL+`/v2/advertising/schedules/${e}.json`,r=await fetch(s,{credentials:"omit"});return await at(r)};getPlaylistById=async(e,s={},r=M.APP_DEFAULT_LANGUAGE)=>{if(!e)return;const a=`/v2/playlists/${e}`,o=ye(`${M.APP_API_BASE_URL}${a}`,s),i=await fetch(o),c=await at(i);return this.transformPlaylist(c,s.related_media_id,r)};getContentList=async({id:e,siteId:s,language:r})=>{if(!e||!s)throw new Error("List ID and Site ID are required");const a=`/v2/sites/${s}/content_lists/${e}`,o=ye(`${M.APP_API_BASE_URL}${a}`,{}),i=await fetch(o),c=await at(i);return this.transformContentList(c,r)};getContentSearch=async({siteId:e,params:s})=>{const r=`/v2/sites/${e}/app_content/media/search`,a=ye(`${M.APP_API_BASE_URL}${r}`,{search_query:s.searchTerm}),o=await fetch(a),i=await at(o);return this.transformPlaylist(i)}})||Ya);class de{}class lt{features;constructor(e){this.features=e}}var Qa,Xa,Za,eo,to,so,Ze;const th=on(te().shape({mediaid:R(),progress:Wc()})).nullable();let Wr=(Qa=le(),Xa=function(t,e){return Z(Fs)(t,void 0,0)},Za=function(t,e){return Z(xe)(t,void 0,1)},eo=function(t,e){return Z(de)(t,void 0,2)},to=Reflect.metadata("design:type",Function),so=Reflect.metadata("design:paramtypes",[String,typeof xe>"u"?Object:xe,typeof de>"u"?Object:de]),Qa(Ze=Xa(Ze=Za(Ze=eo(Ze=to(Ze=so(Ze=class{PERSIST_KEY_WATCH_HISTORY="history";hasErrors=!1;apiService;storageService;accountService;constructor(e,s,r){this.apiService=s,this.storageService=r,this.accountService=Nt(lt,e,!1)}getWatchHistoryItems=async(e,s,r)=>{const a=await this.apiService.getMediaByWatchlist({playlistId:e,mediaIds:s,language:r});return Object.fromEntries((a||[]).map(i=>[i.mediaid,i]))};getWatchHistorySeriesItems=async(e,s,r)=>{const a=await this.apiService.getSeriesByMediaIds(s),o=Object.keys(a||{}).map(d=>a?.[d]?.[0]?.series_id).filter(Boolean),i=[...new Set(o)],c=await this.apiService.getMediaByWatchlist({playlistId:e,mediaIds:i,language:r});return Object.keys(a||{}).reduce((d,u)=>{const h=a?.[u]?.[0]?.series_id;return h&&(d[u]=c?.find(p=>p.mediaid===h)),d},{})};validateWatchHistory(e){try{if(e&&th.validateSync(e))return e}catch(s){this.hasErrors=!0,Pe("WatchHistoryService","Failed to validate watch history",{error:s})}return[]}async getWatchHistoryFromAccount(e){const s=await this.accountService?.getWatchHistory({user:e});return this.validateWatchHistory(s)}async getWatchHistoryFromStorage(){const e=await this.storageService.getItem(this.PERSIST_KEY_WATCH_HISTORY,!0);return this.validateWatchHistory(e)}getWatchHistory=async(e,s,r)=>{const a=e?await this.getWatchHistoryFromAccount(e):await this.getWatchHistoryFromStorage(),o=a.map(({mediaid:i})=>i);if(!o.length)return[];try{const i=await this.getWatchHistoryItems(s,o,r),c=await this.getWatchHistorySeriesItems(s,o,r);return a.map(l=>{const d=c?.[l.mediaid],u=i[l.mediaid];if(u)return this.createWatchHistoryItem(d||u,l.mediaid,d?.mediaid,l.progress)}).filter(l=>!!l)}catch(i){Pe("WatchHistoryService","Failed to get watch history items",{error:i})}return[]};serializeWatchHistory=e=>e.map(({mediaid:s,progress:r})=>({mediaid:s,progress:r}));persistWatchHistory=async(e,s)=>{if(this.hasErrors)return gt("WatchHistoryService","persist prevented due to an encountered problem while validating the stored watch history");s?await this.accountService?.updateWatchHistory({history:this.serializeWatchHistory(e),user:s}):await this.storageService.setItem(this.PERSIST_KEY_WATCH_HISTORY,JSON.stringify(this.serializeWatchHistory(e)))};createWatchHistoryItem=(e,s,r,a)=>({mediaid:s,seriesId:r,title:e.title,tags:e.tags,duration:e.duration,progress:a,playlistItem:e});getMaxWatchHistoryCount=()=>this.accountService?.features?.watchListSizeLimit||aa;saveItem=async(e,s,r,a)=>{if(!r)return;const o=this.createWatchHistoryItem(s||e,e.mediaid,s?.mediaid,r),i=a.filter(({mediaid:c,seriesId:l})=>c!==o.mediaid&&(!l||l!==o.seriesId));return i.unshift(o),i.splice(this.getMaxWatchHistoryCount()),i}})||Ze)||Ze)||Ze)||Ze)||Ze)||Ze);class fl{}var no,ro;let gl=(no=le(),no(ro=class extends fl{host;getToken=async(e,s={})=>await(await fetch(e,{method:"POST",body:JSON.stringify(s)})).json();setHost=e=>{this.host=e};getMediaToken=async(e,s,r,a={},o,i)=>{const c=e.integrations.jwp?.clientId?"jwp":e.integrations.cleeng?.id?"cleeng":"",l=await this.getToken(this.host,{provider:c,credentials:{token:r||""},asset:{id:s,drmPolicyId:o,params:a,accessType:i}});if(!l.entitled)throw new Error("Unauthorized");return l.token}})||ro);var ao,oo,io,co,Vt;const rr="inplayer_token",sh="inplayer_iot",nh={json:"application/json",form:"application/x-www-form-urlencoded"};let ke=(ao=le(),oo=function(t,e){return Z(de)(t,void 0,0)},io=Reflect.metadata("design:type",Function),co=Reflect.metadata("design:paramtypes",[typeof de>"u"?Object:de]),ao(Vt=oo(Vt=io(Vt=co(Vt=class{storageService;useSandboxEnv=!0;constructor(e){this.storageService=e}setup=e=>{this.useSandboxEnv=e};getBaseUrl=()=>this.useSandboxEnv?"https://staging-sims.jwplayer.com":"https://sims.jwplayer.com";setToken=(e,s="",r)=>this.storageService.setItem(rr,JSON.stringify({token:e,refreshToken:s,expires:r}),!1);getToken=async()=>{const e=await this.storageService.getItem(rr,!0,!1);return e||{token:"",refreshToken:"",expires:0}};removeToken=async()=>{await Promise.all([this.storageService.removeItem(rr,!1),this.storageService.removeItem(sh,!1)])};isAuthenticated=async()=>{const e=await this.getToken();return!!e.token&&e.expires>Date.now()/1e3};performRequest=async(e="/",s="GET",r,{contentType:a="form",responseType:o="json",withAuthentication:i=!1,keepalive:c,includeFullResponse:l=!1}={},d)=>{const u={"Content-Type":nh[a]};if(i){const y=await this.getToken();y.token&&(u.Authorization=`Bearer ${y.token}`)}const h=new URLSearchParams;r&&Object.entries(r).forEach(([y,v])=>{(v||v===0)&&(typeof v=="object"?Object.entries(v).forEach(([_,b])=>{h.append(`${y}[${_}]`,b.toString())}):h.append(y,v.toString()))});const p=`${e.startsWith("http")?e:`${this.getBaseUrl()}${e}`}${d?`?${new URLSearchParams(d).toString()}`:""}`,g=await fetch(p,{headers:u,keepalive:c,method:s,body:r&&h.toString()}),f=await g[o]?.();if(!g.ok)throw{response:{data:f}};return l?{...g,data:f}:f};get=(e,s,r)=>this.performRequest(e,"GET",void 0,s,r);patch=(e,s,r)=>this.performRequest(e,"PATCH",s,r);put=(e,s,r)=>this.performRequest(e,"PUT",s,r);post=(e,s,r)=>this.performRequest(e,"POST",s,r);remove=(e,s,r)=>this.performRequest(e,"DELETE",r,s);static isCommonError=e=>typeof e=="object"&&e!==null&&"response"in e&&typeof e.response?.data?.code=="number"&&typeof e.response?.data?.message=="string"})||Vt)||Vt)||Vt)||Vt);var lo,uo,ho,mo,qt;let ma=(lo=le(),uo=function(t,e){return Z(ke)(t,void 0,0)},ho=Reflect.metadata("design:type",Function),mo=Reflect.metadata("design:paramtypes",[typeof ke>"u"?Object:ke]),lo(qt=uo(qt=ho(qt=mo(qt=class extends fl{apiService;constructor(e){super(),this.apiService=e}getMediaToken=async(e,s)=>{if(!e.id)throw new Error("ID missing from config");try{return(await this.apiService.get("/v2/items/jw-media/token",{withAuthentication:!0},{app_config_id:e.id,media_id:s})).token}catch{throw new Error("Unauthorized")}};getEntitledPlans=async({siteId:e})=>{try{return await this.apiService.get(`/v3/sites/${e}/entitlements`,{withAuthentication:await this.apiService.isAuthenticated()})}catch{throw new Error("Failed to fetch entitled plans")}}})||qt)||qt)||qt)||qt);var po,fo,go,_o,yo,vo,et;const rh=on(te().shape({mediaid:R()})).nullable();let Vr=(po=le(),fo=function(t,e){return Z(Fs)(t,void 0,0)},go=function(t,e){return Z(xe)(t,void 0,1)},_o=function(t,e){return Z(de)(t,void 0,2)},yo=Reflect.metadata("design:type",Function),vo=Reflect.metadata("design:paramtypes",[String,typeof xe>"u"?Object:xe,typeof de>"u"?Object:de]),po(et=fo(et=go(et=_o(et=yo(et=vo(et=class{PERSIST_KEY_FAVORITES="favorites";hasErrors=!1;apiService;storageService;accountService;constructor(e,s,r){this.apiService=s,this.storageService=r,this.accountService=Nt(lt,e,!1)}validateFavorites(e){try{if(e&&rh.validateSync(e))return e}catch(s){this.hasErrors=!0,Pe("FavoritesService","Failed to validate favorites",{error:s})}return[]}async getFavoritesFromAccount(e){const s=await this.accountService?.getFavorites({user:e});return this.validateFavorites(s)}async getFavoritesFromStorage(){const e=await this.storageService.getItem(this.PERSIST_KEY_FAVORITES,!0);return this.validateFavorites(e)}getFavorites=async(e,s,r)=>{const o=(e?await this.getFavoritesFromAccount(e):await this.getFavoritesFromStorage()).map(({mediaid:i})=>i);if(!o)return[];try{return(await this.apiService.getMediaByWatchlist({playlistId:s,mediaIds:o,language:r})||[]).map(c=>this.createFavorite(c))}catch(i){Pe("FavoriteService","Failed to get favorites",{error:i})}return[]};serializeFavorites=e=>e.map(({mediaid:s})=>({mediaid:s}));persistFavorites=async(e,s)=>{if(this.hasErrors)return gt("FavoritesService","persist prevented due to an encountered problem while validating the stored favorites");if(s)return this.accountService?.updateFavorites({favorites:this.serializeFavorites(e),user:s});await this.storageService.setItem(this.PERSIST_KEY_FAVORITES,JSON.stringify(this.serializeFavorites(e)))};getMaxFavoritesCount=()=>this.accountService?.features?.watchListSizeLimit||aa;createFavorite=e=>({mediaid:e.mediaid,title:e.title,tags:e.tags,duration:e.duration,playlistItem:e})})||et)||et)||et)||et)||et)||et);const ah=te({contentId:R().optional(),title:R().optional(),featured:Zr().optional(),backgroundColor:R().nullable().optional(),type:R().oneOf(["playlist","continue_watching","favorites","content_list"]).required(),custom:te().optional(),filterTags:R().optional()}).defined(),oh=te().shape({label:R().defined(),contentId:R().defined(),filterTags:R().optional(),type:R().oneOf(["playlist","content_list","media"]).optional(),custom:te().optional()}),ih=te({recommendationsPlaylist:R().nullable(),searchPlaylist:R().nullable(),continueWatchingList:R().nullable(),favoritesList:R().nullable()}),ch=te({id:R().nullable(),monthlyOffer:R().nullable(),yearlyOffer:R().nullable(),useSandbox:Zr().default(!0)}),lh=te({clientId:R().nullable(),assetId:Wc().nullable(),useSandbox:Zr().default(!0)}),dh=te({backgroundColor:R().nullable(),highlightColor:R().nullable(),headerBackground:R().nullable(),footerText:R().nullable()}),uh=te({id:R().optional(),siteName:R().optional(),description:R().defined(),analyticsToken:R().notRequired(),adConfig:R().notRequired(),adSchedule:R().notRequired(),adScheduleUrls:te({json:R().notRequired().nullable(),xml:R().notRequired().nullable()}).optional(),adDeliveryMethod:R().oneOf(["csai","ssai"]).optional(),siteId:R().defined(),assets:te({banner:R().notRequired()}),content:on().of(ah).defined(),menu:on().of(oh).defined(),styling:dh.notRequired(),features:ih.notRequired(),integrations:te({cleeng:ch.optional(),jwp:lh.optional()}),custom:te().notRequired(),contentProtection:te().shape({accessModel:R().oneOf(["free","freeauth","authvod","svod"]).defined(),drm:te({defaultPolicyId:R().defined()}).optional()}).optional()}).defined();class $s extends Error{payload;constructor(e,s){super(e),this.name="AppError",this.payload=s}}var xo,bo;let Mn=(xo=le(),xo(bo=class{CONFIG_HOST=M.APP_API_BASE_URL;DEFAULT_CONFIG={id:"",siteName:"",description:"",siteId:"",assets:{banner:"/images/logo.png"},content:[],menu:[],integrations:{},styling:{footerText:""},features:{}};enrichConfig=e=>{const{content:s,siteName:r}=e,a=s.map(o=>Object.assign({featured:!1},o));return{...e,siteName:r||me.t("common:default_site_name"),content:a}};getDefaultConfig=()=>this.DEFAULT_CONFIG;validateConfig=e=>uh.validate(e,{strict:!0});formatSourceLocation=e=>{if(e)return e.match(/^[a-z,\d]{8}$/)?`${this.CONFIG_HOST}/apps/configs/${e}.json`:e};loadConfig=async e=>{const s=Vc(),r={title:s.t("error:config_invalid"),description:s.t("error:check_your_config"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/configuration.md"};if(!e)throw new $s("No config location found",r);const a=await fetch(e,{headers:{Accept:"application/json"},method:"GET"}).catch(()=>{throw new $s("Failed to load the config",r)});if(!a.ok)throw new $s("Failed to load the config",r);const o=await a.json();if(!o)throw new Error("No config found");return this.enrichConfig(o)}})||bo);var wo,So,jo,Co,zt;let Dn=(wo=le(),So=function(t,e){return Z(de)(t,void 0,0)},jo=Reflect.metadata("design:type",Function),Co=Reflect.metadata("design:paramtypes",[typeof de>"u"?Object:de]),wo(zt=So(zt=jo(zt=Co(zt=class{storageService;constructor(e){this.storageService=e}async getConfigSource(e,s){if(!e)return"";const a=new URLSearchParams(s.split("?")[1]).get(nn);if(!e.UNSAFE_allowAnyConfigSource&&(e.additionalAllowedConfigSources?.length||0)<=0)return e.defaultConfigSource;if(a!==null){if(!a)return await this.storageService.removeItem(jn),e.defaultConfigSource;if(this.isValidConfigSource(a,e))return await this.storageService.setItem(jn,a),a;ms("SettingsService",`Invalid app-config query param: ${a}`)}const o=await this.storageService.getItem(jn,!1);if(o&&typeof o=="string"){if(this.isValidConfigSource(o,e))return o;ms("SettingsService","Invalid stored config: "+o),await this.storageService.removeItem(jn)}return e.defaultConfigSource}isValidConfigSource=(e,s)=>s?.UNSAFE_allowAnyConfigSource?!!e:s?.defaultConfigSource===e||s?.additionalAllowedConfigSources&&s?.additionalAllowedConfigSources.indexOf(e)>=0;initialize=async()=>{const e=await fetch("/.webapp.ini").then(a=>a.text()).then(a=>Bd.parse(a)).catch(a=>(gt("SettingsService","Failed to fetch or parse the ini settings",{error:a}),{})),s=Vc(),r={title:s.t("error:settings_invalid"),description:s.t("error:check_your_settings"),helpLink:"https://github.com/jwplayer/ott-web-app/blob/develop/docs/initialization-file.md"};if(!e)throw new $s("Unable to load .webapp.ini",r);if(e.defaultConfigSource||=M.APP_DEFAULT_CONFIG_SOURCE,e.playerId||=M.APP_PLAYER_ID||Hr,e.playerLicenseKey||=M.APP_PLAYER_LICENSE_KEY,e.apiAccessBridgeUrl||=M.APP_API_ACCESS_BRIDGE_URL,e.playerId===Hr&&!e.playerLicenseKey&&ms("SettingsService","Using Global OTT Player without setting player key. Some features, such as analytics, may not work correctly."),!e.defaultConfigSource&&(!e.additionalAllowedConfigSources||e.additionalAllowedConfigSources?.length===0)&&!e.UNSAFE_allowAnyConfigSource)throw new $s("No usable config sources",r);return e}})||zt)||zt)||zt)||zt);const B=ys("AccountStore",(t,e)=>({loading:!1,user:null,subscription:null,transactions:null,entitledPlan:null,activePayment:null,customerConsents:null,publisherConsents:null,publisherConsentsLoading:!1,pendingOffer:null,setLoading:s=>t({loading:s}),getAccountInfo:()=>{const s=e().user,r=e().customerConsents;if(!s?.id)throw new Error("user not logged in");return{customerId:s?.id,customer:s,customerConsents:r}}})),_t=ys("WatchHistoryStore",(t,e)=>({watchHistory:[],playlistItemsLoaded:!1,continueWatchingPlaylistId:yt.ContinueWatching,getItem:s=>e().watchHistory.find(({mediaid:r,progress:a})=>r===s.mediaid&&a>Zt.Min&&a<Zt.Max),getPlaylist:()=>({feedid:e().continueWatchingPlaylistId||yt.ContinueWatching,title:"Continue watching",playlist:e().watchHistory.filter(({playlistItem:s,progress:r})=>!!s&&r>Zt.Min&&r<Zt.Max).map(({playlistItem:s})=>s)}),getDictionaryWithEpisodes:()=>e().watchHistory.reduce((s,r)=>{const a=r.mediaid;return s[a]=r.progress,s},{}),getDictionaryWithSeries:()=>e().watchHistory.reduce((s,r)=>{const a=r.seriesId||r.mediaid;return s[a]=r.progress,s},{})}));var Po,Eo,ko,Ss;let Ms=(Po=le(),Eo=Reflect.metadata("design:type",Function),ko=Reflect.metadata("design:paramtypes",[typeof Wr>"u"?Object:Wr]),Po(Ss=Eo(Ss=ko(Ss=class{watchHistoryService;constructor(e){this.watchHistoryService=e}initialize=async e=>{await this.restoreWatchHistory(e)};restoreWatchHistory=async e=>{const{user:s}=B.getState(),r=H.getState().config.features?.continueWatchingList;if(!r)return;const a=await this.watchHistoryService.getWatchHistory(s,r,e);_t.setState({watchHistory:a.filter(o=>!!o?.mediaid),playlistItemsLoaded:!0,continueWatchingPlaylistId:r})};persistWatchHistory=async()=>{const{watchHistory:e}=_t.getState(),{user:s}=B.getState();await this.watchHistoryService.persistWatchHistory(e,s)};saveItem=async(e,s,r)=>{const{watchHistory:a}=_t.getState();if(!r)return;const o=await this.watchHistoryService.saveItem(e,s,r,a);o&&(_t.setState({watchHistory:o}),await this.persistWatchHistory())}})||Ss)||Ss)||Ss);class Bs{}class Us{}const ge=ys("CheckoutStore",t=>({requestedMediaOffers:[],mediaOffers:[],subscriptionOffers:[],switchSubscriptionOffers:[],selectedOffer:null,defaultOfferId:null,order:null,paymentMethods:null,setRequestedMediaOffers:e=>t({requestedMediaOffers:e}),setOrder:e=>t({order:e}),setPaymentMethods:e=>t({paymentMethods:e})}));class We extends Error{errors;constructor(e){super(Object.values(e).flat().join(";")),this.errors=e}}const hh=t=>{const e=t?.period;return e==="month"?"upgrade":e==="year"?"downgrade":"upgrade"},qr=t=>t?.find(e=>e.methodName==="card")?.id?.toString()||"";var Io,No,Ao,To,Lo,bt;let vt=(Io=le(),No=function(t,e){return Z(Fs)(t,void 0,0)},Ao=function(t,e){return Z(un)(t,void 0,1)},To=Reflect.metadata("design:type",Function),Lo=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),Io(bt=No(bt=Ao(bt=To(bt=Lo(bt=class{accountService;checkoutService;subscriptionService;getCustomerIP;constructor(e,s){this.getCustomerIP=s,this.accountService=Nt(lt,e,!1),this.checkoutService=Nt(Bs,e,!1),this.subscriptionService=Nt(Us,e,!1)}initialiseOffers=async()=>{J(this.accountService?.svodOfferIds,"AccountService#svodOfferIds not defined");const e=ge.getState().requestedMediaOffers,s=e?await this.getOffers({offerIds:e.map(({offerId:r})=>r)}):[];if(ge.setState({mediaOffers:s}),!ge.getState().subscriptionOffers.length&&this.accountService.svodOfferIds){const r=await this.getOffers({offerIds:this.accountService.svodOfferIds});ge.setState({subscriptionOffers:r})}if(!ge.getState().switchSubscriptionOffers.length)try{const r=await this.getSubscriptionSwitches(),a=r?await this.getOffers({offerIds:r}):[];ge.setState({switchSubscriptionOffers:a})}catch(r){Pe("Checkout","Cannot initialize offers",{error:r})}};getSubscriptionOfferIds=()=>this.accountService?.svodOfferIds||[];chooseOffer=async e=>{ge.setState({selectedOffer:e})};initialiseOrder=async e=>{J(this.checkoutService?.createOrder,"CheckoutService#createOrder not defined");const{getAccountInfo:s}=B.getState(),{customer:r}=s(),a=await this.getPaymentMethods(),o=parseInt(qr(a)),i={offer:e,customerId:r.id,country:r?.country||"",paymentMethodId:o},c=await this.checkoutService.createOrder(i);if(c?.errors?.length>0)throw ge.getState().setOrder(null),new Error(c?.errors[0]);ge.getState().setOrder(c.responseData?.order)};updateOrder=async(e,s,r)=>{J(this.checkoutService?.updateOrder,"CheckoutService#updateOrder is not available");try{const a=await this.checkoutService.updateOrder({order:e,paymentMethodId:s,couponCode:r});a.responseData.order&&ge.getState().setOrder(a.responseData?.order)}catch(a){if(a instanceof Error)if(a.message==="Order not found")ge.getState().setOrder(null);else{if(a.message==="Invalid coupon code")throw new We({couponCode:[me.t("account:checkout.coupon_not_valid")]});if(a.message==="Invalid coupon code for this offer")throw new We({couponCode:[me.t("account:checkout.coupon_not_valid_for_offer")]})}throw new We({form:[me.t("error:unknown_error")]})}};getPaymentMethods=async()=>{J(this.checkoutService?.getPaymentMethods,"CheckoutService#getPaymentMethods is not available");const{paymentMethods:e}=ge.getState();if(e)return e;const s=await this.checkoutService.getPaymentMethods();if(s.errors.length>0)throw new Error(s.errors[0]);return ge.getState().setPaymentMethods(s.responseData?.paymentMethods),s.responseData?.paymentMethods};paymentWithoutDetails=async({captchaValue:e}={})=>{J(this.checkoutService?.paymentWithoutDetails,"CheckoutService#paymentWithoutDetails is not available");const{order:s}=ge.getState();if(!s)throw new Error("No order created");const r=await this.checkoutService.paymentWithoutDetails({orderId:s.id,captchaValue:e});if(r.errors.length>0)throw new Error(r.errors[0]);if(r.responseData.rejectedReason)throw new Error(r.responseData.rejectedReason);return r.responseData};directPostCardPayment=async({cardPaymentPayload:e,referrer:s,returnUrl:r})=>{J(this.checkoutService?.directPostCardPayment,"CheckoutService#directPostCardPayment is not available");const{order:a}=ge.getState();if(!a)throw new Error("No order created");return await this.checkoutService.directPostCardPayment(e,a,s,r)};createAdyenPaymentSession=async(e,s=!0)=>{const{order:r}=ge.getState(),a=r?.id;if(s&&!a)throw new Error("There is no order to pay for");J(this.checkoutService?.createAdyenPaymentSession,"createAdyenPaymentSession is not available in checkout service");const o=await this.checkoutService.createAdyenPaymentSession({orderId:a,returnUrl:e});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData};initialAdyenPayment=async(e,s,r)=>{const{order:a}=ge.getState();if(!a)throw new Error("No order created");J(this.checkoutService?.initialAdyenPayment,"initialAdyenPayment is not available in checkout service");const o=await this.checkoutService.initialAdyenPayment({orderId:a.id,returnUrl:s,paymentMethod:e,customerIP:await this.getCustomerIP(),captchaValue:r});if(o.errors.length>0)throw new Error(o.errors[0]);return o.responseData};finalizeAdyenPayment=async(e,s,r)=>{if(!s)throw new Error("No order created");J(this.checkoutService?.finalizeAdyenPayment,"finalizeAdyenPayment is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPayment({orderId:s,details:e,paymentData:r});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData};finalizeStripePpvPayment=e=>this.checkoutService?.finalizeStripePpvPayment?.({paymentIntent:e});paypalPayment=async({successUrl:e,waitingUrl:s,cancelUrl:r,errorUrl:a,couponCode:o="",captchaValue:i})=>{const{order:c}=ge.getState();if(!c)throw new Error("No order created");J(this.checkoutService?.paymentWithPayPal,"CheckoutService#paymentWithPayPal is not available");const l=await this.checkoutService.paymentWithPayPal({order:c,successUrl:e,waitingUrl:s,cancelUrl:r,errorUrl:a,couponCode:o,captchaValue:i});if(l.errors.length>0)throw new Error(l.errors[0]);return{redirectUrl:l.responseData.redirectUrl}};getSubscriptionSwitches=async()=>{const{getAccountInfo:e}=B.getState(),{customerId:s}=e(),{subscription:r}=B.getState();if(!r||!this.checkoutService?.getSubscriptionSwitches)return null;J(this.checkoutService.getOffer,"getOffer is not available in checkout service");const a=await this.checkoutService.getSubscriptionSwitches({customerId:s,offerId:r.offerId});return a.responseData.available.length?a.responseData.available.map(({toOfferId:o})=>o):null};switchSubscription=async()=>{const e=ge.getState().selectedOffer,s=B.getState().subscription,{getAccountInfo:r}=B.getState(),{customerId:a}=r();if(!e||!s)throw new Error("No offer selected");J(this.checkoutService?.switchSubscription,"switchSubscription is not available in checkout service");const o=hh(s),i={toOfferId:e.offerId,customerId:a,offerId:s.offerId,switchDirection:o};await this.checkoutService.switchSubscription(i)};changeSubscription=async({accessFeeId:e,subscriptionId:s})=>{J(this.subscriptionService?.changeSubscription,"changeSubscription is not available in subscription service");const{responseData:r}=await this.subscriptionService.changeSubscription({accessFeeId:e,subscriptionId:s});return r};updatePayPalPaymentMethod=async(e,s,r,a,o,i)=>{J(this.checkoutService?.updatePaymentMethodWithPayPal,"updatePaymentMethodWithPayPal is not available in checkout service"),J(this.checkoutService?.deletePaymentMethod,"deletePaymentMethod is not available in checkout service");const c=await this.checkoutService.updatePaymentMethodWithPayPal({paymentMethodId:o,successUrl:e,waitingUrl:s,cancelUrl:r,errorUrl:a});if(c.errors.length>0)throw new Error(c.errors[0]);return i&&await this.checkoutService.deletePaymentMethod({paymentDetailsId:i}),c.responseData};addAdyenPaymentDetails=async(e,s,r)=>{J(this.checkoutService?.addAdyenPaymentDetails,"addAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.addAdyenPaymentDetails({paymentMethodId:s,returnUrl:r,paymentMethod:e,customerIP:await this.getCustomerIP()});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData};finalizeAdyenPaymentDetails=async(e,s,r)=>{J(this.checkoutService?.finalizeAdyenPaymentDetails,"finalizeAdyenPaymentDetails is not available in checkout service");const a=await this.checkoutService.finalizeAdyenPaymentDetails({paymentMethodId:s,details:e,paymentData:r});if(a.errors.length>0)throw new Error(a.errors[0]);return a.responseData};getOffers=e=>(J(this.checkoutService?.getOffers,"CheckoutService#getOffers is not available"),this.checkoutService.getOffers(e));getEntitlements=e=>(J(this.checkoutService?.getEntitlements,"CheckoutService#getEntitlements is not available"),this.checkoutService.getEntitlements(e))})||bt)||bt)||bt)||bt)||bt);const pt=ys("FavoritesState",(t,e)=>({favorites:[],warning:null,favoritesPlaylistId:yt.Favorites,setWarning:s=>t({warning:s}),clearWarning:()=>t({warning:null}),hasItem:s=>e().favorites.some(r=>r.mediaid===s.mediaid),getPlaylist:()=>({feedid:e().favoritesPlaylistId||yt.Favorites,title:"Favorites",playlist:e().favorites.map(({playlistItem:s})=>s)})}));var $o,Oo,Mo,js;let fs=($o=le(),Oo=Reflect.metadata("design:type",Function),Mo=Reflect.metadata("design:paramtypes",[typeof Vr>"u"?Object:Vr]),$o(js=Oo(js=Mo(js=class{favoritesService;constructor(e){this.favoritesService=e}initialize=async e=>{await this.restoreFavorites(e)};restoreFavorites=async e=>{const{user:s}=B.getState(),r=H.getState().config.features?.favoritesList;if(!r)return;const a=await this.favoritesService.getFavorites(s,r,e);pt.setState({favorites:a,favoritesPlaylistId:r})};persistFavorites=async()=>{const{favorites:e}=pt.getState(),{user:s}=B.getState();await this.favoritesService.persistFavorites(e,s)};saveItem=async e=>{const{favorites:s}=pt.getState();if(!s.some(({mediaid:r})=>r===e.mediaid)){const r=[this.favoritesService.createFavorite(e)].concat(s);pt.setState({favorites:r}),await this.persistFavorites()}};removeItem=async e=>{const{favorites:s}=pt.getState(),r=s.filter(({mediaid:a})=>a!==e.mediaid);pt.setState({favorites:r}),await this.persistFavorites()};toggleFavorite=async e=>{const{favorites:s,hasItem:r,setWarning:a}=pt.getState();if(!e)return;if(r(e)){await this.removeItem(e);return}if(s.length>this.favoritesService.getMaxFavoritesCount()){a(me.t("video:favorites_warning",{maxCount:this.favoritesService.getMaxFavoritesCount()}));return}await this.saveItem(e)};clear=async()=>{pt.setState({favorites:[]}),await this.persistFavorites()}})||js)||js)||js);var Do,Ro,Fo,Bo,Gt;let Rn=(Do=le(),Ro=function(t,e){return Z(Zc)(t,void 0,0)},Fo=Reflect.metadata("design:type",Function),Bo=Reflect.metadata("design:paramtypes",[String]),Do(Gt=Ro(Gt=Fo(Gt=Bo(Gt=class{apiAccessBridgeUrl;constructor(e){this.apiAccessBridgeUrl=e}generateAccessTokens=async(e,s)=>{const r=`${this.apiAccessBridgeUrl}/v2/sites/${e}/access/generate`,a=await fetch(r,{method:"PUT",headers:{Authorization:s?`Bearer ${s}`:""}});return a.ok?await a.json():(Pe("AccessService","Failed to generateAccessTokens",{status:a.status,error:a.json()}),null)};refreshAccessTokens=async(e,s)=>{const r=`${this.apiAccessBridgeUrl}/v2/sites/${e}/access/refresh`,a=await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:s})});return a.ok?await a.json():(Pe("AccessService","Failed to refreshAccessTokens",{status:a.status,error:a.json()}),null)}})||Gt)||Gt)||Gt)||Gt);const Fn=ys("AccessStore",()=>({passport:null}));var Uo,Ho,Wo,Vo,qo,zo,Go,Be;const ar="access_tokens";let ps=(Uo=le(),Ho=function(t,e){return Z(Fs)(t,void 0,0)},Wo=function(t,e){return Z(xe)(t,void 0,1)},Vo=function(t,e){return Z(de)(t,void 0,2)},qo=function(t,e){return Z(Rn)(t,void 0,3)},zo=Reflect.metadata("design:type",Function),Go=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof xe>"u"?Object:xe,typeof de>"u"?Object:de,typeof Rn>"u"?Object:Rn]),Uo(Be=Ho(Be=Wo(Be=Vo(Be=qo(Be=zo(Be=Go(Be=class{apiService;accessService;accountService;storageService;siteId="";constructor(e,s,r,a){this.apiService=s,this.accessService=a,this.storageService=r,this.accountService=Nt(lt,e,!1)}initialize=async()=>{const{config:e,accessModel:s}=H.getState();this.siteId=e.siteId,s!=="AVOD"&&this.generateOrRefreshAccessTokens()};getMediaById=async(e,s)=>{const{entitledPlan:r}=B.getState();if(!(!this.siteId||!r))try{const a=await this.generateOrRefreshAccessTokens();if(!a?.passport)throw new Error("Failed to get / generate access tokens and retrieve media.");return await this.apiService.getMediaByIdWithPassport({id:e,siteId:this.siteId,planId:r.id,passport:a.passport,language:s})}catch(a){if(a instanceof ml&&a.code===403){const o=await this.refreshAccessTokens();if(o?.passport)return await this.apiService.getMediaByIdWithPassport({id:e,siteId:this.siteId,planId:r.id,passport:o.passport,language:s});throw new Error("Failed to refresh access tokens and retrieve media.")}throw a}};generateOrRefreshAccessTokens=async()=>{const e=await this.getAccessTokens(),s=e&&Date.now()>e.expires;return e||await this.generateAccessTokens(),s?await this.refreshAccessTokens():e};generateAccessTokens=async()=>{if(!this.siteId)return null;const e=await this.accountService?.getAuthData(),s=await this.accessService.generateAccessTokens(this.siteId,e?.jwt);return s?(await this.setAccessTokens(s),s):null};refreshAccessTokens=async()=>{const e=await this.getAccessTokens();if(!e)return null;const s=await this.accessService.refreshAccessTokens(this.siteId,e.refresh_token);return s?(await this.setAccessTokens(s),s):null};setAccessTokens=async e=>{Fn.setState({passport:e.passport});const s=new Date(Date.now()+3600*1e3).getTime();return await this.storageService.setItem(ar,JSON.stringify({...e,expires:s}),!0)};getAccessTokens=async()=>{const e=await this.storageService.getItem(ar,!0,!0);return e&&Fn.setState({passport:e.passport}),e};removeAccessTokens=async()=>(Fn.setState({passport:null}),await this.storageService.removeItem(ar))})||Be)||Be)||Be)||Be)||Be)||Be)||Be);var Jo,Yo,Ko,Qo,Jt;let ie=(Jo=le(),Yo=function(t,e){return Z(Fs)(t,void 0,0)},Ko=Reflect.metadata("design:type",Function),Qo=Reflect.metadata("design:paramtypes",[typeof IntegrationType>"u"?Object:IntegrationType,typeof ps>"u"?Object:ps,typeof fs>"u"?Object:fs,typeof Ms>"u"?Object:Ms]),Jo(Jt=Yo(Jt=Ko(Jt=Qo(Jt=class{checkoutService;accountService;subscriptionService;entitlementService;accessController;favoritesController;watchHistoryController;features;refreshEntitlements;constructor(e,s,r,a){this.checkoutService=Nt(Bs,e,!1),this.accountService=Nt(lt,e,!1),this.subscriptionService=Nt(Us,e,!1),this.entitlementService=W(ma),this.accessController=s,this.favoritesController=r,this.watchHistoryController=a,this.features=e&&this.accountService?this.accountService.features:Iu}loadUserData=async()=>{try{await this.getAuthData()&&await this.getAccount()}catch(e){Pe("AccountController","Failed to get user",{error:e}),e instanceof Error&&e.message.includes("Invalid JWT token")&&await this.logout()}};initialize=async(e,s)=>{if(this.refreshEntitlements=s,B.setState({loading:!0}),this.accountService){const r=H.getState().config;await this.accountService.initialize(r,e,this.logout),H.setState({accessModel:this.accountService.accessModel}),await this.loadUserData()}await this.getEntitledPlans(),B.setState({loading:!1})};getSandbox(){return!!this.accountService?.sandbox}updateUser=async e=>{J(this.accountService?.updateCustomer,"AccountService#updateCustomer is not available"),B.setState({loading:!0});const{user:s}=B.getState(),{canUpdateEmail:r,canSupportEmptyFullName:a}=this.getFeatures();if(Object.prototype.hasOwnProperty.call(e,"email")&&!r)throw new Error("Email update not supported");if(!s)throw new Error("User not logged in");const o=this.validateInputLength(e);if(o.length)return{errors:o,responseData:{}};let i=e;a||(i={...e,email:s.email});const c=await this.accountService.updateCustomer({...i,id:s.id.toString()});if(!c)throw new Error("Unknown error");return B.setState({user:c}),{errors:[],responseData:c}};getAccount=async()=>{const{config:e}=H.getState();try{const s=await this.accountService?.getUser({config:e});s&&await this.afterLogin(s.user,s.customerConsents),B.setState({loading:!1})}catch{B.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1})}};login=async(e,s,r)=>{J(this.accountService?.login,"AccountService#login is not available"),B.setState({loading:!0});try{const a=await this.accountService.login({email:e,password:s,referrer:r});if(a){await this.accessController?.generateAccessTokens(),await this.afterLogin(a.user,a.customerConsents);return}}catch(a){if(a instanceof Error&&a.message.toLowerCase().includes("invalid param email"))throw new We({email:[me.t("account:login.wrong_email")]})}finally{B.setState({loading:!1})}throw new We({form:[me.t("account:login.wrong_combination")]})};logout=async()=>{await this.accountService?.logout(),await this.accessController?.removeAccessTokens(),await this.clearLoginState(),await this.refreshEntitlements?.()};register=async(e,s,r,a,o)=>{J(this.accountService?.register,"AccountService#register is not available");try{const i=await this.accountService.register({email:e,password:s,consents:a,referrer:r,captchaValue:o});if(i){const{user:c,customerConsents:l}=i;await this.afterLogin(c,l,!0);return}}catch(i){if(i instanceof Error){const c=i.message.toLowerCase();if(c.includes("customer already exists")||c.includes("account already exists"))throw new We({form:[me.t("account:registration.user_exists")]});if(c.includes("please enter a valid e-mail address"))throw new We({email:[me.t("account:registration.field_is_not_valid_email")]});if(c.includes("invalid param password"))throw new We({password:[me.t("account:registration.invalid_password")]})}}throw new We({form:[me.t("account:registration.failed_to_create")]})};updateConsents=async e=>{const{getAccountInfo:s}=B.getState(),{customer:r}=s();B.setState({loading:!0});try{const a=await this.accountService?.updateCustomerConsents({customer:r,consents:e});return a?(B.setState({customerConsents:a}),{responseData:a,errors:[]}):{responseData:[],errors:[]}}finally{B.setState({loading:!1})}};getCustomerConsents=async()=>{J(this.accountService?.getCustomerConsents,"AccountService#getCustomerConsents is not available");const{getAccountInfo:e}=B.getState(),{customer:s}=e(),r=await this.accountService.getCustomerConsents({customer:s});return r&&B.setState({customerConsents:r}),r};getPublisherConsents=async()=>{J(this.accountService?.getPublisherConsents,"AccountService#getPublisherConsents is not available");const{config:e}=H.getState();B.setState({publisherConsentsLoading:!0});const s=await this.accountService.getPublisherConsents(e);B.setState({publisherConsents:s,publisherConsentsLoading:!1})};getCaptureStatus=async()=>{J(this.accountService?.getCaptureStatus,"AccountService#getCaptureStatus is not available");const{getAccountInfo:e}=B.getState(),{customer:s}=e();return this.accountService.getCaptureStatus({customer:s})};updateCaptureAnswers=async e=>{J(this.accountService?.updateCaptureAnswers,"AccountService#updateCaptureAnswers is not available");const{getAccountInfo:s}=B.getState(),{customer:r,customerConsents:a}=s(),o=await this.accountService.updateCaptureAnswers({customer:r,...e});return B.setState({user:o,customerConsents:a}),o};resetPassword=async(e,s)=>{J(this.accountService?.resetPassword,"AccountService#resetPassword is not available"),await this.accountService.resetPassword({customerEmail:e,resetUrl:s})};changePasswordWithOldPassword=async(e,s,r)=>{J(this.accountService?.changePasswordWithOldPassword,"AccountService#changePasswordWithOldPassword is not available"),await this.accountService.changePasswordWithOldPassword({oldPassword:e,newPassword:s,newPasswordConfirmation:r})};changePasswordWithToken=async(e,s,r,a)=>{J(this.accountService?.changePasswordWithResetToken,"AccountService#changePasswordWithResetToken is not available"),await this.accountService.changePasswordWithResetToken({customerEmail:e,newPassword:s,resetPasswordToken:r,newPasswordConfirmation:a})};updateSubscription=async e=>{J(this.subscriptionService?.updateSubscription,"SubscriptionService#updateSubscription is not available");const{getAccountInfo:s}=B.getState(),{customerId:r}=s(),{subscription:a}=B.getState();if(!a)throw new Error("user has no active subscription");const o=await this.subscriptionService.updateSubscription({customerId:r,offerId:a.offerId,status:e,unsubscribeUrl:a.unsubscribeUrl});if(o.errors.length>0)throw new Error(o.errors[0]);return await this.reloadSubscriptions({retry:10}),o?.responseData};updateCardDetails=async({cardName:e,cardNumber:s,cvc:r,expMonth:a,expYear:o,currency:i})=>{J(this.subscriptionService?.updateCardDetails,"SubscriptionService#updateCardDetails is not available");const{getAccountInfo:c}=B.getState(),{customerId:l}=c(),d=await this.subscriptionService.updateCardDetails({cardName:e,cardNumber:s,cvc:r,expMonth:a,expYear:o,currency:i}),u=await this.subscriptionService.getActivePayment({customerId:l})||null;return B.setState({loading:!1,activePayment:u}),d};checkEntitlements=async e=>{if(J(this.checkoutService?.getEntitlements,"CheckoutService#getEntitlements is not available"),!e)return!1;const{responseData:s}=await this.checkoutService.getEntitlements({offerId:e});return!!s?.accessGranted};getEntitledPlans=async()=>{const{config:e,settings:s}=H.getState(),r=e.siteId;if(!!!s?.apiAccessBridgeUrl)return null;const o=await this.entitlementService.getEntitledPlans({siteId:r});if(o?.plans?.length){const i=o.plans.find(c=>c.metadata.access_model==="svod")||o.plans[0];return B.setState({entitledPlan:i}),i}return null};reloadSubscriptions=async({delay:e,retry:s}={delay:0,retry:0})=>{J(this.subscriptionService?.getActiveSubscription,"SubscriptionService#getActiveSubscription is not available"),J(this.subscriptionService?.getAllTransactions,"SubscriptionService#getAllTransactions is not available"),J(this.subscriptionService?.getActivePayment,"SubscriptionService#getActivePayment is not available"),B.setState({loading:!0});const{getAccountInfo:r}=B.getState(),{customerId:a}=r(),{accessModel:o}=H.getState();if(e&&e>0)return new Promise(u=>{setTimeout(()=>{this.reloadSubscriptions({retry:s}).finally(u)},e)});if(o!=="SVOD")return await this.refreshEntitlements?.(),B.setState({loading:!1});const[i,c,l]=await Promise.all([this.subscriptionService.getActiveSubscription({customerId:a}),this.subscriptionService.getAllTransactions({customerId:a}),this.subscriptionService.getActivePayment({customerId:a})]);let d=null;if(!i&&s&&s>0)return await this.reloadSubscriptions({delay:1500,retry:s-1});try{if(i?.pendingSwitchId){J(this.checkoutService?.getOffer,"getOffer is not available in checkout service"),J(this.checkoutService?.getSubscriptionSwitch,"getSubscriptionSwitch is not available in checkout service");const u=await this.checkoutService.getSubscriptionSwitch({switchId:i.pendingSwitchId});d=(await this.checkoutService.getOffer({offerId:u.responseData.toOfferId})).responseData}}catch(u){Pe("AccountController","Failed to fetch the pending offer",{error:u})}await this.refreshEntitlements?.(),B.setState({subscription:i,loading:!1,pendingOffer:d,transactions:c,activePayment:l})};exportAccountData=async()=>{const{canExportAccountData:e}=this.getFeatures();return J(this.accountService?.exportAccountData,"exportAccountData is not available in account service"),nr(e,"Export account"),this.accountService.exportAccountData(void 0)};getSocialLoginUrls=e=>{const{hasSocialURLs:s}=this.getFeatures();return J(this.accountService?.getSocialUrls,"getSocialUrls is not available in account service"),nr(s,"Social logins"),this.accountService.getSocialUrls({redirectUrl:e})};deleteAccountData=async e=>{const{canDeleteAccount:s}=this.getFeatures();J(this.accountService?.deleteAccount,"deleteAccount is not available in account service"),nr(s,"Delete account");try{await this.accountService.deleteAccount({password:e})}catch(r){throw(r instanceof Error?r.message.toLowerCase():"").includes("invalid credentials")?new We({form:[me.t("user:account.delete_account.invalid_credentials")]}):new We({form:[me.t("user:account.delete_account.error")]})}};getReceipt=async e=>{J(this.subscriptionService?.fetchReceipt,"fetchReceipt is not available in subscription service");const{responseData:s}=await this.subscriptionService.fetchReceipt({transactionId:e});return s};getAuthData=async()=>this.accountService?.getAuthData()||null;subscribeToNotifications=async({uuid:e,onMessage:s})=>(J(this.accountService?.subscribeToNotifications,"AccountService#subscribeToNotifications is not available"),this.accountService.subscribeToNotifications({uuid:e,onMessage:s}));getFeatures(){return this.features}async afterLogin(e,s,r=!1){B.setState({user:e,customerConsents:s}),await Promise.allSettled([this.reloadSubscriptions(),this.getPublisherConsents(),r?this.favoritesController.persistFavorites():this.favoritesController.restoreFavorites(),r?this.watchHistoryController.persistWatchHistory():this.watchHistoryController.restoreWatchHistory()]),B.setState({loading:!1})}validateInputLength=e=>{const s=[];return Number(e?.firstName?.length)>50&&s.push(me.t("account:validation.first_name")),Number(e?.lastName?.length)>50&&s.push(me.t("account:validation.last_name")),s};clearLoginState=async()=>{B.setState({user:null,subscription:null,transactions:null,activePayment:null,customerConsents:null,publisherConsents:null,loading:!1}),await this.favoritesController.restoreFavorites(),await this.watchHistoryController.restoreWatchHistory()}})||Jt)||Jt)||Jt)||Jt);var Xo,Zo,ei,ti,si,ni,tt;let Kn=(Xo=le(),Zo=function(t,e){return Z(Mn)(t,void 0,0)},ei=function(t,e){return Z(Dn)(t,void 0,1)},ti=function(t,e){return Z(de)(t,void 0,2)},si=Reflect.metadata("design:type",Function),ni=Reflect.metadata("design:paramtypes",[typeof Mn>"u"?Object:Mn,typeof Dn>"u"?Object:Dn,typeof de>"u"?Object:de]),Xo(tt=Zo(tt=ei(tt=ti(tt=si(tt=ni(tt=class{configService;settingsService;storageService;constructor(e,s,r){this.configService=e,this.settingsService=s,this.storageService=r}loadAndValidateConfig=async e=>{const s=this.configService.formatSourceLocation(e),r=this.configService.getDefaultConfig();s||H.setState({config:r});let a=await this.configService.loadConfig(s);return a.id=e||"",a.assets=a.assets||{},a.assets.banner||(a.assets.banner=r.assets.banner),H.setState(o=>Ha({},o,{config:{assets:{banner:a.assets.banner}}})),a=await this.configService.validateConfig(a),a=Ha({},r,a),a};initializeApp=async(e,s,r)=>{gt("AppController","Initializing app",{url:e});const a=await this.settingsService.initialize(),o=await this.settingsService.getConfigSource(a,e),i=await this.loadAndValidateConfig(o),c=this.calculateIntegrationType(i);return H.setState({config:i,loaded:!0,integrationType:c}),this.storageService.initialize("jwapp"),H.setState({settings:a}),c&&await W(ie).initialize(e,r),a?.apiAccessBridgeUrl&&await W(ps).initialize(),i.features?.continueWatchingList&&i.content.some(l=>l.type===yt.ContinueWatching)&&await W(Ms).initialize(s),i.features?.favoritesList&&i.content.some(l=>l.type===yt.Favorites)&&await W(fs).initialize(s),{config:i,settings:a,configSource:o}};calculateIntegrationType=e=>{const r=K.getAll(ia).reduce((a,o)=>{const i=o(e);return i?[...a,i]:a},[]);if(r.length>1)throw new Error(`Failed to initialize app, more than 1 integrations are enabled: ${r.join(", ")}`);return r[0]||null};getIntegrationType=()=>{const e=H.getState();if(!e.loaded)throw new Error("A call to `AppController#getIntegrationType()` was made before loading the config");return e.integrationType};getApiAccessBridgeUrl=()=>{const e=H.getState();if(!e.loaded)throw new Error("A call to `AppController#getApiAccessBridgeUrl()` was made before loading the config");return e.settings?.apiAccessBridgeUrl||void 0}})||tt)||tt)||tt)||tt)||tt)||tt);class mn{}var ri,ai;const mh=t=>t.status==="fulfilled"?!0:(Pe("EpgController","An error occurred resolving a promise: ",{error:t.reason}),!1);let _l=(ri=le(),ri(ai=class{generateDemoPrograms(e){const s=new Date,r=new Date(e[0]?.startTime),a=new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate())),o=Ud(s,a);return e.map((i,c)=>({...i,id:`${i.id}_${c}`,startTime:Wa(new Date(i.startTime),o).toJSON(),endTime:Wa(new Date(i.endTime),o).toJSON()}))}parseSchedule=async(e,s)=>{const r=!!s.scheduleDemo||!1,a=this.getEpgService(s);if(!Array.isArray(e))return[];const i=(await Promise.allSettled(e.map(c=>a?.transformProgram(c).catch(l=>{gt("EpgController","Failed to transform a program",{error:l,program:c})})))).filter(mh).map(c=>c.value).filter(c=>!!c);return r?this.generateDemoPrograms(i):i};getSchedule=async e=>{const r=await this.getEpgService(e)?.fetchSchedule(e),a=await this.parseSchedule(r,e),o=e.catchupHours&&parseInt(e.catchupHours);return{id:e.mediaid,title:e.title,description:e.description,catchupHours:o||8,channelLogoImage:e.channelLogoImage,backgroundImage:e.backgroundImage,programs:a}};getEpgService=e=>{const s=e?.scheduleType?.toLocaleLowerCase()||oa.jwp,r=Nt(mn,s,!1);return r||ms("EpgController",`No epg service was added for the ${s} schedule type`),r};getSchedules=async e=>Promise.all(e.map(s=>this.getSchedule(s)))})||ai);var oi,ii,ci,li,di,ui,st;let yl=(oi=le(),ii=function(t,e){return Z(ie)(t,void 0,0)},ci=function(t,e){return Z(ps)(t,void 0,1)},li=function(t,e){return Z(xe)(t,void 0,2)},di=Reflect.metadata("design:type",Function),ui=Reflect.metadata("design:paramtypes",[typeof ie>"u"?Object:ie,typeof ps>"u"?Object:ps,typeof xe>"u"?Object:xe]),oi(st=ii(st=ci(st=li(st=di(st=ui(st=class{accountController;accessController;apiService;constructor(e,s,r){this.accountController=e,this.accessController=s,this.apiService=r}validateGeoRestriction=async e=>{const s=e?.sources.find(r=>r.file.indexOf(".m3u8")!==-1);if(s&&(await fetch(s.file,{method:"HEAD"})).status===403)throw new Error("access blocked")};getEntitlementService=()=>{const{config:{custom:e,contentProtection:s,integrations:{jwp:r}}}=H.getState(),a=typeof e?.entitlementHost=="string"?e.entitlementHost:void 0,o=s?.drm?.defaultPolicyId||e?.drmPolicyId,i=ns(e?.urlSigning);if(a&&i){const c=W(gl);return c.setHost(a),c}if(r&&(o||i))return W(ma)};getSignedMedia=async(e,s,r,a)=>{const{config:o,settings:i,accessModel:c}=H.getState(),{custom:l,contentProtection:d}=o,u=!!i?.apiAccessBridgeUrl,h=d?.drm?.defaultPolicyId??l?.drmPolicyId,p=a?"public":c.toLowerCase();let g;if(u)g=await this.accessController.getMediaById(e,s);else{const f=await this.accountController.getAuthData(),v=await this.getEntitlementService()?.getMediaToken(o,e,f?.jwt,r,h,p);g=await this.apiService.getMediaById({id:e,token:v,drmPolicyId:h,language:s})}return await this.validateGeoRestriction(g),g}})||st)||st)||st)||st)||st)||st);var hi,mi;const ph=te().shape({"episode-num":te().shape({"#text":R().required()}),title:te().shape({"#text":R().required()}),desc:te().shape({"#text":R()}),icon:te().shape({src:R()}),start:R().required(),stop:R().required()}),pi=t=>Hd(t,"yyyyMdHms xxxx",new Date).toISOString();let fh=(hi=le(),hi(mi=class extends mn{transformProgram=async e=>{const s=await ph.validate(e);return{id:s["episode-num"]["#text"],title:s.title["#text"],startTime:pi(s.start),endTime:pi(s.stop),description:s?.desc?.["#text"],cardImage:s?.icon?.src,backgroundImage:s?.icon?.src}};fetchSchedule=async e=>{const{XMLParser:s}=await ra(async()=>{const{XMLParser:o}=await import("./vendor-CM9hMnv_.js").then(i=>i.f);return{XMLParser:o}},__vite__mapDeps([0,1,2])),r=e.scheduleUrl;if(!r){ms("ViewNexaEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:e});return}const a={ignoreAttributes:!1,attributeNamePrefix:""};try{const o=await fetch(r).then(l=>l.text());return new s(a).parse(o)?.tv?.programme||[]}catch(o){o instanceof Error&&Pe("ViewNexaEpgService",`Fetch failed for View Nexa EPG schedule: '${r}'`,{error:o})}}})||mi);var fi,gi;const gh="API-KEY",_h=te().shape({id:R().required(),title:R().required(),startTime:R().required().test(t=>t?Br(new Date(t)):!1),endTime:R().required().test(t=>t?Br(new Date(t)):!1),chapterPointCustomProperties:on().of(te().shape({key:R().required(),value:R().test("required-but-empty","value is required",t=>typeof t=="string")}))});let yh=(fi=le(),fi(gi=class extends mn{transformProgram=async e=>{const s=await _h.validate(e),r=s.chapterPointCustomProperties?.find(a=>a.key==="image")?.value||void 0;return{id:s.id,title:s.title,startTime:s.startTime,endTime:s.endTime,cardImage:r,backgroundImage:r,description:s.chapterPointCustomProperties?.find(a=>a.key==="description")?.value||void 0}};fetchSchedule=async e=>{if(!e.scheduleUrl){ms("JWEpgService","Tried requesting a schedule for an item with missing `scheduleUrl`",{item:e});return}const s=new Headers;e.scheduleToken&&s.set(gh,e.scheduleToken);try{const r=await fetch(e.scheduleUrl,{headers:s});return await at(r)}catch(r){r instanceof Error&&Pe("JWEpgService",`Fetch failed for EPG schedule: '${e.scheduleUrl}'`,{error:r})}}})||gi);const vh=t=>t.get(Kn).getApiAccessBridgeUrl();class xh{queue=[];getLength(){return this.queue.length}async enqueue(){return new Promise((e,s)=>{this.queue.push({resolve:e,reject:s})})}async resolve(e){const s=this.queue.map(({resolve:r})=>r(e));this.queue=[],await Promise.allSettled(s)}async reject(e){const s=this.queue.map(({reject:r})=>r(e));this.queue=[],await Promise.allSettled(s)}}var _i,yi,vi,xi,bi,wi,Si,Ue;const or="auth",bh=te().shape({accessToken:R().required(),refreshToken:R().required()}),wh=t=>bh.isValidSync(t),ji=t=>{try{const e=qc(t);if(typeof e.exp=="number")return e.exp*1e3}catch{}return-1};let At=(_i=le(),yi=function(t,e){return Z(de)(t,void 0,0)},vi=function(t,e){return Z(un)(t,void 0,1)},xi=function(t,e){return Z(el)(t,void 0,2)},bi=function(t,e){return Wd()(t,void 0,2)},wi=Reflect.metadata("design:type",Function),Si=Reflect.metadata("design:paramtypes",[typeof de>"u"?Object:de,typeof GetCustomerIP>"u"?Object:GetCustomerIP,typeof BroadcastChannel>"u"?Object:BroadcastChannel]),_i(Ue=yi(Ue=vi(Ue=xi(Ue=bi(Ue=wi(Ue=Si(Ue=class{storageService;getCustomerIP;channel;queue=new xh;isRefreshing=!1;expiration=-1;sandbox=!1;tokens=null;constructor(e,s,r){this.storageService=e,this.getCustomerIP=s,this.channel=r,this.channel?.addEventListener("message",this.handleBroadcastMessage)}async persistInStorage(e){e?await this.storageService.setItem(or,JSON.stringify(e)):await this.storageService.removeItem(or)}logoutCallback;getNewTokens=async({refreshToken:e})=>{try{const{responseData:s}=await this.post("/auths/refresh_token",JSON.stringify({refreshToken:e}));return{accessToken:s.jwt,refreshToken:s.refreshToken}}catch(s){throw s instanceof Error&&(gt("CleengService","Failed to refresh accessToken",{error:s}),(s.message.includes("Refresh token is expired or does not exist")||s.message.includes("Missing or invalid parameter"))&&(this.logoutCallback||gt("CleengService","logoutCallback is not set"),await this.logoutCallback?.())),s}};handleBroadcastMessage=async e=>{this.isRefreshing=e.action==="refreshing",e.tokens&&await this.setTokens(e.tokens),e.action==="resolved"?await this.queue.resolve():e.action==="rejected"&&await this.queue.reject()};sendBroadcastMessage=(e,s)=>{if(!this.channel)return;const r={action:e,tokens:s};this.channel.postMessage(r)};getBaseUrl=()=>this.sandbox?"https://mediastore-sandbox.cleeng.com":"https://mediastore.cleeng.com";performRequest=async(e="/",s="GET",r,a={})=>{try{const o=a.authenticate?await this.getAccessTokenOrThrow():void 0;return await(await fetch(`${this.getBaseUrl()}${e}`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""},keepalive:a.keepalive,method:s,body:r})).json()}catch(o){return{errors:Array.of(o instanceof Error?o.message:String(o))}}};initialize=async(e,s)=>{this.sandbox=e,this.logoutCallback=s,await this.restoreTokensFromStorage(),await this.maybeRefreshAccessToken()};setTokens=async e=>{this.tokens=e,this.expiration=ji(e.accessToken),await this.persistInStorage(this.tokens)};clearTokens=async()=>{this.tokens=null,await this.persistInStorage(null)};restoreTokensFromStorage=async()=>{const e=await this.storageService.getItem(or,!1);let s;if(typeof e!="string")return;try{if(s=JSON.parse(e),!wh(s))return}catch{return}const r=ji(s.accessToken);r>this.expiration&&(this.tokens=s,this.expiration=r)};accessTokenIsExpired=()=>this.tokens?this.expiration>-1&&Date.now()-this.expiration>0:!1;hasTokens=()=>!!this.tokens;refreshTokens=async e=>{this.sendBroadcastMessage("refreshing"),this.isRefreshing=!0;try{const s=await this.getNewTokens(e);if(s){await this.setTokens(s),this.isRefreshing=!1,this.sendBroadcastMessage("resolved",s),await this.queue.resolve();return}}catch(s){gt("CleengService","Failed to refresh tokens",{error:s})}await this.clearTokens(),this.isRefreshing=!1,this.sendBroadcastMessage("rejected"),await this.queue.reject()};maybeRefreshAccessToken=async()=>{try{if(this.isRefreshing)return gt("CleengService","Token is already refreshing, waiting in queue..."),await this.queue.enqueue();if(!this.accessTokenIsExpired()||!this.tokens)return;await this.refreshTokens(this.tokens)}catch(e){Pe("CleengService","Error caught while refreshing the access token",{error:e})}};getAccessToken=async()=>(await this.maybeRefreshAccessToken(),await this.restoreTokensFromStorage(),this.tokens?.accessToken);getAccessTokenOrThrow=async()=>{const e=await this.getAccessToken();if(!e)throw new Error("Access token is missing");return e};getLocales=async()=>{const e=await this.getCustomerIP();return this.get(`/locales${e?"?customerIP="+e:""}`)};get=(e,s)=>this.performRequest(e,"GET",void 0,s);patch=(e,s,r)=>this.performRequest(e,"PATCH",s,r);put=(e,s,r)=>this.performRequest(e,"PUT",s,r);post=(e,s,r)=>this.performRequest(e,"POST",s,r);remove=(e,s)=>this.performRequest(e,"DELETE",void 0,s)})||Ue)||Ue)||Ue)||Ue)||Ue)||Ue)||Ue);const Ci=t=>({id:t.id,email:t.email,country:t.country,firstName:t.firstName,lastName:t.lastName,fullName:`${t.firstName} ${t.lastName}`,metadata:t.externalData||{}}),Sh=t=>({type:"checkbox",name:t.name,label:t.label,defaultValue:"",required:t.required,placeholder:t.placeholder,options:{},enabledByDefault:!1,version:t.version});var Pi,Ei,ki,Ii,Ni,wt;let jh=(Pi=le(),Ei=function(t,e){return Z(At)(t,void 0,0)},ki=function(t,e){return Z(un)(t,void 0,1)},Ii=Reflect.metadata("design:type",Function),Ni=Reflect.metadata("design:paramtypes",[typeof At>"u"?Object:At,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),Pi(wt=Ei(wt=ki(wt=Ii(wt=Ni(wt=class extends lt{cleengService;getCustomerIP;publisherId="";externalData={};accessModel=Ae.AUTHVOD;svodOfferIds=[];sandbox=!1;constructor(e,s){super({canUpdateEmail:!0,canSupportEmptyFullName:!0,canChangePasswordWithOldPassword:!1,canRenewSubscription:!0,canExportAccountData:!1,canDeleteAccount:!1,canUpdatePaymentMethod:!0,canShowReceipts:!1,hasSocialURLs:!1,hasNotifications:!1,watchListSizeLimit:48}),this.cleengService=e,this.getCustomerIP=s}handleErrors=e=>{if(e.length>0)throw new Error(e[0])};getCustomerIdFromAuthData=e=>qc(e.jwt).customerId;getCustomer=async({customerId:e})=>{const{responseData:s,errors:r}=await this.cleengService.get(`/customers/${e}`,{authenticate:!0});return this.handleErrors(r),this.externalData=s.externalData||{},Ci(s)};getLocales=async()=>this.cleengService.getLocales();initialize=async(e,s,r)=>{const a=e?.integrations?.cleeng;if(!a?.id)throw new Error("Failed to initialize Cleeng integration. The publisherId is missing.");this.publisherId=a.id,this.accessModel=a.monthlyOffer||a.yearlyOffer?Ae.SVOD:Ae.AUTHVOD,this.svodOfferIds=[a?.monthlyOffer,a?.yearlyOffer].filter(Boolean).map(String),this.sandbox=!!a.useSandbox,await this.cleengService.initialize(this.sandbox,r)};getAuthData=async()=>this.cleengService.tokens?(await this.cleengService.maybeRefreshAccessToken(),{jwt:this.cleengService.tokens.accessToken,refreshToken:this.cleengService.tokens.refreshToken}):null;getCustomerConsents=async e=>{const{customer:s}=e,r=await this.cleengService.get(`/customers/${s?.id}/consents`,{authenticate:!0});return this.handleErrors(r.errors),r?.responseData?.consents||[]};updateCustomerConsents=async e=>{const{customer:s}=e,r={id:s.id,consents:e.consents},a=await this.cleengService.put(`/customers/${s?.id}/consents`,JSON.stringify(r),{authenticate:!0});return this.handleErrors(a.errors),await this.getCustomerConsents(e)};login=async({email:e,password:s})=>{const r={email:e,password:s,publisherId:this.publisherId,customerIP:await this.getCustomerIP()},{responseData:a,errors:o}=await this.cleengService.post("/auths",JSON.stringify(r));this.handleErrors(o),await this.cleengService.setTokens({accessToken:a.jwt,refreshToken:a.refreshToken});const{user:i,customerConsents:c}=await this.getUser();return{user:i,auth:a,customerConsents:c}};register=async({email:e,password:s,consents:r,captchaValue:a})=>{const o=await this.getLocales();this.handleErrors(o.errors);const i={email:e,password:s,locale:o.responseData.locale,country:o.responseData.country,currency:o.responseData.currency,publisherId:this.publisherId,customerIP:await this.getCustomerIP(),captchaValue:a},{responseData:c,errors:l}=await this.cleengService.post("/customers",JSON.stringify(i));this.handleErrors(l),await this.cleengService.setTokens({accessToken:c.jwt,refreshToken:c.refreshToken});const{user:d}=await this.getUser(),u=await this.updateCustomerConsents({consents:r,customer:d}).catch(()=>[]);return{user:d,auth:c,customerConsents:u}};logout=async()=>{await this.cleengService.clearTokens()};getUser=async()=>{const e=await this.getAuthData();if(!e)throw new Error("Not logged in");const s=this.getCustomerIdFromAuthData(e),r=await this.getCustomer({customerId:s}),a=await this.getCustomerConsents({customer:r});return{user:r,customerConsents:a}};getPublisherConsents=async()=>{const e=await this.cleengService.get(`/publishers/${this.publisherId}/consents`);return this.handleErrors(e.errors),(e.responseData?.consents||[]).map(Sh)};getCaptureStatus=async({customer:e})=>{const s=await this.cleengService.get(`/customers/${e?.id}/capture/status`,{authenticate:!0});return this.handleErrors(s.errors),s.responseData};updateCaptureAnswers=async({customer:e,...s})=>{const r={customerId:e.id,...s},a=await this.cleengService.put(`/customers/${e.id}/capture`,JSON.stringify(r),{authenticate:!0});return this.handleErrors(a.errors),this.getCustomer({customerId:e.id})};resetPassword=async e=>{const s=await this.cleengService.put("/customers/passwords",JSON.stringify({...e,publisherId:this.publisherId}));this.handleErrors(s.errors)};changePasswordWithResetToken=async e=>{const s=await this.cleengService.patch("/customers/passwords",JSON.stringify({...e,publisherId:this.publisherId}));this.handleErrors(s.errors)};changePasswordWithOldPassword=async()=>{};updateCustomer=async e=>{const{id:s,metadata:r,fullName:a,...o}=e,i={id:s,...o},{responseData:c,errors:l}=await this.cleengService.patch(`/customers/${s}`,JSON.stringify(i),{authenticate:!0,keepalive:!0});return this.handleErrors(l),this.externalData=c.externalData||{},Ci(c)};updateWatchHistory=async({user:e,history:s})=>{const r={id:e.id,externalData:{...this.externalData,history:s}},{errors:a,responseData:o}=await this.cleengService.patch(`/customers/${e.id}`,JSON.stringify(r),{authenticate:!0,keepalive:!0});this.handleErrors(a),this.externalData=o.externalData||{}};updateFavorites=async({user:e,favorites:s})=>{const r={id:e.id,externalData:{...this.externalData,favorites:s}},{errors:a,responseData:o}=await this.cleengService.patch(`/customers/${e.id}`,JSON.stringify(r),{authenticate:!0,keepalive:!0});this.handleErrors(a),this.externalData=o.externalData||{}};getWatchHistory=async()=>this.externalData.history||[];getFavorites=async()=>this.externalData.favorites||[];subscribeToNotifications=async()=>!1;getSocialUrls;exportAccountData;deleteAccount})||wt)||wt)||wt)||wt)||wt);var Ai,Ti,Li,$i,Oi,St;let Ch=(Ai=le(),Ti=function(t,e){return Z(At)(t,void 0,0)},Li=function(t,e){return Z(un)(t,void 0,1)},$i=Reflect.metadata("design:type",Function),Oi=Reflect.metadata("design:paramtypes",[typeof At>"u"?Object:At,typeof GetCustomerIP>"u"?Object:GetCustomerIP]),Ai(St=Ti(St=Li(St=$i(St=Oi(St=class extends Bs{cleengService;getCustomerIP;constructor(e,s){super(),this.cleengService=e,this.getCustomerIP=s}getOffers=async e=>await Promise.all(e.offerIds.map(async s=>{const r=await this.getOffer({offerId:String(s)});if(r.errors.length>0)throw new Error(r.errors[0]);return r.responseData}));getOffer=async e=>{const s=await this.getCustomerIP();return this.cleengService.get(`/offers/${e.offerId}${s?"?customerIP="+s:""}`)};createOrder=async e=>{const s=await this.cleengService.getLocales();if(s.errors.length>0)throw new Error(s.errors[0]);const r=s.responseData.ipAddress,a={offerId:e.offer.offerId,customerId:e.customerId,country:e.country,currency:s?.responseData?.currency||"EUR",customerIP:r,paymentMethodId:e.paymentMethodId};return this.cleengService.post("/orders",JSON.stringify(a),{authenticate:!0})};getOrder=async({orderId:e})=>this.cleengService.get(`/orders/${e}`,{authenticate:!0});updateOrder=async({order:e,...s})=>{const r=await this.cleengService.patch(`/orders/${e.id}`,JSON.stringify(s),{authenticate:!0});if(r.errors.length){if(r.errors[0].includes(`Order with ${e.id} not found`))throw new Error("Order not found");if(r.errors[0].includes(`Coupon ${s.couponCode} not found`))throw new Error("Invalid coupon code");if(r.errors[0].includes(`Coupon ${s.couponCode} cannot be applied on this offer`))throw new Error("Invalid coupon code for this offer")}return r};getPaymentMethods=async()=>this.cleengService.get("/payment-methods",{authenticate:!0});paymentWithoutDetails=async e=>this.cleengService.post("/payments",JSON.stringify(e),{authenticate:!0});paymentWithPayPal=async e=>{const{order:s,successUrl:r,cancelUrl:a,errorUrl:o,captchaValue:i}=e,c={orderId:s.id,successUrl:r,cancelUrl:a,errorUrl:o,captchaValue:i};return this.cleengService.post("/connectors/paypal/v1/tokens",JSON.stringify(c),{authenticate:!0})};getSubscriptionSwitches=async e=>this.cleengService.get(`/customers/${e.customerId}/subscription_switches/${e.offerId}/availability`,{authenticate:!0});getSubscriptionSwitch=async e=>this.cleengService.get(`/subscription_switches/${e.switchId}`,{authenticate:!0});switchSubscription=async e=>this.cleengService.post(`/customers/${e.customerId}/subscription_switches/${e.offerId}`,JSON.stringify({toOfferId:e.toOfferId,switchDirection:e.switchDirection}),{authenticate:!0});getEntitlements=async e=>this.cleengService.get(`/entitlements/${e.offerId}`,{authenticate:!0});createAdyenPaymentSession=async e=>await this.cleengService.post("/connectors/adyen/sessions",JSON.stringify(e),{authenticate:!0});initialAdyenPayment=async e=>this.cleengService.post("/connectors/adyen/initial-payment",JSON.stringify({...e,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0});finalizeAdyenPayment=async e=>this.cleengService.post("/connectors/adyen/initial-payment/finalize",JSON.stringify(e),{authenticate:!0});finalizeStripePpvPayment;updatePaymentMethodWithPayPal=async e=>this.cleengService.post("/connectors/paypal/v1/payment_details/tokens",JSON.stringify(e),{authenticate:!0});deletePaymentMethod=async e=>this.cleengService.remove(`/payment_details/${e.paymentDetailsId}`,{authenticate:!0});addAdyenPaymentDetails=async e=>this.cleengService.post("/connectors/adyen/payment-details",JSON.stringify({...e,attemptAuthentication:this.cleengService.sandbox?"always":void 0}),{authenticate:!0});finalizeAdyenPaymentDetails=async e=>this.cleengService.post("/connectors/adyen/payment-details/finalize",JSON.stringify(e),{authenticate:!0});directPostCardPayment=async()=>!1})||St)||St)||St)||St)||St);var Mi,Di,Ri,Fi,Yt;let Ph=(Mi=le(),Di=function(t,e){return Z(At)(t,void 0,0)},Ri=Reflect.metadata("design:type",Function),Fi=Reflect.metadata("design:paramtypes",[typeof At>"u"?Object:At]),Mi(Yt=Di(Yt=Ri(Yt=Fi(Yt=class extends Us{cleengService;constructor(e){super(),this.cleengService=e}getActiveSubscription=async({customerId:e})=>{const s=await this.getSubscriptions({customerId:e});return s.errors.length>0?null:s.responseData.items.find(r=>r.status==="active"||r.status==="cancelled")||null};getAllTransactions=async({customerId:e})=>{const s=await this.getTransactions({customerId:e});return s.errors.length>0?null:s.responseData.items};getActivePayment=async({customerId:e})=>{const s=await this.getPaymentDetails({customerId:e});return s.errors.length>0?null:s.responseData.paymentDetails.find(r=>r.active)||null};getSubscriptions=async e=>this.cleengService.get(`/customers/${e.customerId}/subscriptions`,{authenticate:!0});updateSubscription=async e=>this.cleengService.patch(`/customers/${e.customerId}/subscriptions`,JSON.stringify(e),{authenticate:!0});getPaymentDetails=async e=>this.cleengService.get(`/customers/${e.customerId}/payment_details`,{authenticate:!0});getTransactions=async({customerId:e,limit:s,offset:r})=>this.cleengService.get(ye(`/customers/${e}/transactions`,{limit:s,offset:r}),{authenticate:!0});fetchReceipt=async({transactionId:e})=>this.cleengService.get(`/receipt/${e}`,{authenticate:!0});updateCardDetails;changeSubscription})||Yt)||Yt)||Yt)||Yt);const Eh=(t,e)=>t.menu.find(a=>a.contentId===e)?.filterTags?.split(",").filter(Boolean)||[],kh=(t,e)=>e===""?t:{...t,playlist:t.playlist.filter(({tags:s})=>s?s.split(",").includes(e):!1)},vl=(t=15)=>({title:"",playlist:new Array(t).fill({}).map((e,s)=>({description:"",duration:0,feedid:"",image:"",images:[],cardImage:"",backgroundImage:"",channelLogoImage:"",link:"",genre:"",mediaid:`placeholder_${s}`,pubdate:0,rating:"",sources:[],tags:"",title:"",tracks:[]}))}),Ih=(t=[],e=[])=>!t||!e?{}:t?.reduce((r,a)=>{const o=e?.find(i=>i.name===a.name);if(o){const i=a.isCustomRegisterField?o.value??"":o.state==="accepted";r[a.name]=i}return r},{}),Nh=(t=[],e=[])=>{if(!t||!e)return{};const s={};return t?.forEach(r=>{e?.find(a=>a.name===r.name&&a.state==="accepted")&&(s[r.name]=!0)}),s},Ah=t=>{const e={};return t&&t?.forEach(s=>{e[s.name]=s.type==="checkbox"?s.enabledByDefault===!0:s.defaultValue??""}),e},Bn=(t,e)=>{const s=[];return!t||!e||t.forEach(r=>{s.push({name:r.name,version:r.version,state:e[r.name]?"accepted":"declined",value:e[r.name]??""})}),s},Th=(t,e)=>{const s=[],r=[];return!t||!e?{customerConsents:s,consentsErrors:r}:(t.forEach(a=>{a.required&&!e[a.name]&&r.push(a.name),s.push({name:a.name,version:a.version,state:e[a.name]?"accepted":"declined",value:e[a.name]??""})}),{customerConsents:s,consentsErrors:r})},Lh=t=>t.value!=="",$h=({name:t,value:e=""},s,r)=>{const a=t==="us_state"?r.find(({name:i,value:c})=>i==="country"&&c==="us")?e==="n/a"?"":e:"n/a":(e===!0||e===!1)&&t!=="terms"?e?"on":"off":e;return[t,a]},zr=t=>Object.fromEntries(t.filter(Lh).map($h)),Bi=t=>Array.isArray(t)||typeof t=="object"&&t!==null?JSON.parse(JSON.stringify(t)):t,xl=t=>{if(typeof t=="string"&&ku.includes(t))return t},bl=t=>{if(!t)return 0;const e=t.split(":");return e.length===2?Math.floor(parseInt(e[1])/parseInt(e[0])):0};var Ui,Hi,Wi,Vi,qi,jt;const Oh="https://inplayer.com/legal/terms";let Mh=(Ui=le(),Hi=function(t,e){return Z(de)(t,void 0,0)},Wi=function(t,e){return Z(ke)(t,void 0,1)},Vi=Reflect.metadata("design:type",Function),qi=Reflect.metadata("design:paramtypes",[typeof de>"u"?Object:de,typeof ke>"u"?Object:ke]),Ui(jt=Hi(jt=Wi(jt=Vi(jt=qi(jt=class extends lt{storageService;apiService;clientId="";accessModel=Ae.AUTHVOD;assetId=null;svodOfferIds=[];sandbox=!1;constructor(e,s){super({canUpdateEmail:!1,canSupportEmptyFullName:!1,canChangePasswordWithOldPassword:!0,canRenewSubscription:!1,canExportAccountData:!0,canUpdatePaymentMethod:!1,canShowReceipts:!0,canDeleteAccount:!0,hasNotifications:!0,hasSocialURLs:!0,watchListSizeLimit:48}),this.storageService=e,this.apiService=s}parseJson=(e,s={})=>{try{return JSON.parse(e)}catch{return s}};formatFavorite=e=>({mediaid:e.media_id});formatHistoryItem=e=>({mediaid:e.media_id,progress:e.progress});formatAccount=e=>{const{id:s,uuid:r,email:a,full_name:o,metadata:i,created_at:c}=e,l=new Date(c*1e3).toLocaleString(),d=i?.first_name,u=i?.surname;return{id:s.toString(),uuid:r,email:a,fullName:o,firstName:d,lastName:u,metadata:i,regDate:l,country:"",lastUserIp:""}};formatAuth(e){const{access_token:s}=e;return{jwt:s,refreshToken:""}}initialize=async(e,s,r)=>{const a=e.integrations?.jwp;if(!a?.clientId)throw new Error("Failed to initialize JWP integration. The clientId is missing.");this.sandbox=!!a.useSandbox;const o=this.sandbox?"development":"production";Js.setConfig(o),this.apiService.setup(this.sandbox),a.clientId&&(this.clientId=a.clientId),a.assetId&&(this.accessModel=Ae.SVOD,this.assetId=a.assetId,this.svodOfferIds=a.assetId?[String(a.assetId)]:[]);const i=new URLSearchParams(s.split("#")[1]),c=i.get("token"),l=i.get("refresh_token"),d=i.get("expires");!c||!l||!d||this.apiService.setToken(c,l,parseInt(d))};getAuthData=async()=>{if(await this.apiService.isAuthenticated()){const e=await this.apiService.getToken();return{jwt:e.token,refreshToken:e.refreshToken}}return null};getPublisherConsents=async()=>{try{const e=await this.apiService.get(`/accounts/register-fields/${this.clientId}`),s=e?.collection.find(({name:a})=>a==="terms"),r=e?.collection.filter(a=>!["email_confirmation","first_name","surname"].includes(a.name)&&![s].includes(a)).map(a=>({type:a.type,isCustomRegisterField:!0,name:a.name,label:a.label,placeholder:a.placeholder,required:a.required,options:a.options,defaultValue:"",version:"1",...a.type==="checkbox"?{enabledByDefault:a.default_value==="true"}:{defaultValue:a.default_value}}));return s?[this.getTermsConsent(s),...r]:r}catch{throw new Error("Failed to fetch publisher consents.")}};getCustomerConsents=async e=>{try{if(!e?.customer)return{consents:[]};const{customer:s}=e;return this.parseJson(s.metadata?.consents,[])}catch{throw new Error("Unable to fetch Customer consents.")}};updateCustomerConsents=async e=>{try{const{customer:s,consents:r}=e,a=this.formatUpdateAccount(s),o={...a,metadata:{...a.metadata,...zr(r),consents:JSON.stringify(r)}},i=await this.apiService.put("/accounts",o,{withAuthentication:!0});return this.parseJson(i?.metadata?.consents,[])}catch{throw new Error("Unable to update Customer consents")}};updateCaptureAnswers=async({customer:e,...s})=>this.updateCustomer({...e,...s});changePasswordWithOldPassword=async e=>{const{oldPassword:s,newPassword:r,newPasswordConfirmation:a}=e;try{await this.apiService.post("/accounts/change-password",{old_password:s,password:r,password_confirmation:a},{withAuthentication:!0})}catch(o){throw ke.isCommonError(o)?new Error(o.response.data.message):new Error("Failed to change password")}};resetPassword=async({customerEmail:e})=>{try{await this.apiService.post("/accounts/forgot-password",{email:e,merchant_uuid:this.clientId,branding_id:0})}catch{throw new Error("Failed to reset password.")}};login=async({email:e,password:s,referrer:r})=>{try{const a=await this.apiService.post("/v2/accounts/authenticate",{client_id:this.clientId||"",grant_type:"password",referrer:r,username:e,password:s});this.apiService.setToken(a.access_token,"",a.expires);const o=this.formatAccount(a.account);return{auth:this.formatAuth(a),user:o,customerConsents:this.parseJson(o?.metadata?.consents,[])}}catch{throw new Error("Failed to authenticate user.")}};register=async({email:e,password:s,referrer:r,consents:a})=>{try{const o=await this.apiService.post("/accounts",{full_name:e,username:e,password:s,password_confirmation:s,client_id:this.clientId||"",type:"consumer",referrer:r,grant_type:"password",metadata:{first_name:" ",surname:" ",...zr(a),consents:JSON.stringify(a)}});this.apiService.setToken(o.access_token,"",o.expires);const i=this.formatAccount(o.account);return{auth:this.formatAuth(o),user:i,customerConsents:this.parseJson(i?.metadata?.consents,[])}}catch(o){throw ke.isCommonError(o)?new Error(o.response.data.message):new Error("Failed to create account.")}};logout=async()=>{try{Js.Notifications.isSubscribed()&&Js.Notifications.unsubscribe(),await this.apiService.isAuthenticated()&&(await this.apiService.get("/accounts/logout",{withAuthentication:!0}),await this.apiService.removeToken())}catch{throw new Error("Failed to sign out.")}};getUser=async()=>{try{const e=await this.apiService.get("/accounts",{withAuthentication:!0}),s=this.formatAccount(e);return{user:s,customerConsents:this.parseJson(s?.metadata?.consents,[])}}catch{throw new Error("Failed to fetch user data.")}};updateCustomer=async e=>{try{const s=await this.apiService.put("/accounts",this.formatUpdateAccount(e),{withAuthentication:!0});return this.formatAccount(s)}catch{throw new Error("Failed to update user data.")}};formatUpdateAccount=e=>{const s=e.firstName?.trim()||"",r=e.lastName?.trim()||"",a=`${s} ${r}`.trim()||e.email,o={...e.metadata,first_name:s,surname:r};return{full_name:a,metadata:o}};getCaptureStatus=async({customer:{firstName:e,lastName:s}})=>{const r=e?.trim()||"",a=s?.trim()||"";return{isCaptureEnabled:!0,shouldCaptureBeDisplayed:!r||!a,settings:[{answer:{firstName:r||null,lastName:a||null},enabled:!0,key:"firstNameLastName",required:!0}]}};changePasswordWithResetToken=async e=>{const{resetPasswordToken:s="",newPassword:r,newPasswordConfirmation:a=""}=e;try{await this.apiService.put(`/accounts/forgot-password/${s}`,{password:r,password_confirmation:a,branding_id:0})}catch(o){throw ke.isCommonError(o)?new Error(o.response.data.message):new Error("Failed to change password.")}};getTermsConsent=({label:e})=>{const s=`<a href="${e||Oh}" target="_blank">${me.t("account:registration.terms_and_conditions")}</a>`;return{type:"checkbox",isCustomRegisterField:!0,required:!0,name:"terms",defaultValue:"",label:e?me.t("account:registration.terms_consent",{termsLink:s}):me.t("account:registration.terms_consent_jwplayer",{termsLink:s}),enabledByDefault:!1,placeholder:"",options:{},version:"1"}};updateWatchHistory=async({history:e})=>{const s=await this.getWatchHistory(),r=s.map(a=>a.mediaid)||[];await Promise.allSettled(e.map(({mediaid:a,progress:o})=>{if(!r.includes(a)||s.some(i=>i.mediaid==a&&i.progress!=o))return this.apiService.patch("/v2/accounts/media/watch-history",{media_id:a,progress:o},{withAuthentication:!0})}))};updateFavorites=async({favorites:e})=>{const r=(await this.getFavorites()).map(o=>o.mediaid)||[],a=e.map(o=>o.mediaid);await Promise.allSettled(a.map(o=>r.includes(o)?Promise.resolve():this.apiService.post("/v2/accounts/media/favorites",{media_id:o},{withAuthentication:!0}))),await Promise.allSettled(r.map(o=>a.includes(o)?Promise.resolve():this.apiService.remove(`/v2/accounts/media/favorites/${o}`,{withAuthentication:!0})))};getFavorites=async()=>(await this.apiService.get("/v2/accounts/media/favorites",{withAuthentication:!0}))?.collection?.map(this.formatFavorite)||[];getWatchHistory=async()=>(await this.apiService.get("/v2/accounts/media/watch-history",{withAuthentication:!0},{filter:"currently_watching"}))?.collection?.map(this.formatHistoryItem)||[];subscribeToNotifications=async({uuid:e,onMessage:s})=>{try{return Js.Notifications.isSubscribed()||Js.subscribe(e,{onMessage:s,onOpen:()=>!0}),!0}catch{return!1}};exportAccountData=async()=>{try{return await this.apiService.post("/accounts/export",{password:void 0,branding_id:0},{withAuthentication:!0})}catch{throw new Error("Failed to export account data")}};deleteAccount=async({password:e})=>{try{return await this.apiService.remove("/accounts/erase",{withAuthentication:!0},{password:e,branding_id:0})}catch(s){throw ke.isCommonError(s)?new Error(s.response.data.message||"Failed to delete account"):new Error("Failed to delete account")}};getSocialUrls=async({redirectUrl:e})=>{const s=this.storageService.base64Encode(JSON.stringify({client_id:this.clientId||"",redirect:e})),r=await this.apiService.get("/accounts/social",{includeFullResponse:!0},{state:s});if(r.status!==200)throw new Error("Failed to fetch social urls");return r.data.social_urls}})||jt)||jt)||jt)||jt)||jt);const pa=(t,{minutesAbbreviation:e})=>t?`${Math.ceil(t/60)} ${e}`:"",wl=(t,{hoursAbbreviation:e,minutesAbbreviation:s})=>{if(!t)return"";const r=Math.floor(t/3600),a=Math.round((t-r*3600)/60),o=r?`${r}${e}`:"",i=a?`${a}${s}`:"";return[o,i].filter(Boolean).join(" ")},ot=(t,e,s)=>new Intl.NumberFormat(s||"en-US",{style:"currency",currency:e}).format(t),Qn=(t,e)=>!t&&!e?"":t&&t!=="0"?`S${t}:E${e}`:`E${e}`,Dh=(t,e,s)=>e?s?`${Wn(e,t,"  ")} - ${Sl(s,t)}`:Wn(e,t,"  "):"",kt=(t,e)=>new Intl.DateTimeFormat(e,{day:"numeric",month:"long",year:"numeric"}).format(t),Sl=(t,e)=>new Intl.DateTimeFormat(e,{hour:"numeric",minute:"numeric"}).format(t),Wn=(t,e,s=" ")=>`${kt(t,e)}${s}${Sl(t,e)}`,Rh=t=>ot(t.customerPriceInclTax,t.customerCurrency,t.customerCountry),fa=t=>t.offerId?.[0]==="S";var zi,Gi,Ji,Yi,Kt;let Fh=(zi=le(),Gi=function(t,e){return Z(ke)(t,void 0,0)},Ji=Reflect.metadata("design:type",Function),Yi=Reflect.metadata("design:paramtypes",[typeof ke>"u"?Object:ke]),zi(Kt=Gi(Kt=Ji(Kt=Yi(Kt=class extends Bs{cardPaymentProvider="stripe";apiService;constructor(e){super(),this.apiService=e}formatPaymentMethod=(e,s)=>({id:e.id,methodName:e.method_name.toLocaleLowerCase(),provider:s,logoUrl:""});formatEntitlements=(e=0,s=!1)=>({errors:[],responseData:{accessGranted:s,expiresAt:e}});formatOfferId(e){return["ppv","ppv_custom"].includes(e.access_type.name)?`C${e.item_id}_${e.id}`:`S${e.item_id}_${e.id}`}parseOfferId(e){return typeof e=="string"?e.startsWith("C")||e.startsWith("S")?parseInt(e.slice(1).split("_")[0]):parseInt(e):e}formatOffer=e=>({id:e.id,offerId:this.formatOfferId(e),offerCurrency:e.currency,customerPriceInclTax:e.amount,customerCurrency:e.currency,offerTitle:e.description,active:!0,period:e.access_type.period==="month"&&e.access_type.quantity===12?"year":e.access_type.period,planSwitchEnabled:e.item.plan_switch_enabled??!1,freeDays:e.trial_period?.quantity||0});formatOrder=e=>({id:e.offer.id,customerId:e.customerId,offerId:e.offer.offerId,totalPrice:e.offer.customerPriceInclTax,priceBreakdown:{offerPrice:e.offer.customerPriceInclTax,discountAmount:e.offer.customerPriceInclTax,discountedPrice:e.offer.customerPriceInclTax,paymentMethodFee:0,taxValue:0},taxRate:0,currency:e.offer.offerCurrency||"EUR",requiredPaymentDetails:!0});createOrder=async e=>({errors:[],responseData:{message:"",order:this.formatOrder(e),success:!0}});getOffers=async e=>(await Promise.all(e.offerIds.map(async r=>{try{return(await this.apiService.get(`/v2/items/${this.parseOfferId(r)}/access-fees`))?.map(o=>this.formatOffer(o))}catch{throw new Error("Failed to get offers")}}))).flat();getPaymentMethods=async()=>{try{const e=await this.apiService.get("/payments/methods",{withAuthentication:!0}),s=[];return e.forEach(r=>{["card","paypal"].includes(r.method_name.toLowerCase())&&s.push(this.formatPaymentMethod(r,this.cardPaymentProvider))}),{errors:[],responseData:{message:"",paymentMethods:s,status:1}}}catch{throw new Error("Failed to get payment methods")}};paymentWithPayPal=async e=>{try{const s=await this.apiService.post("/external-payments",{origin:e.waitingUrl,access_fee:e.order.id,payment_method:2,voucher_code:e.couponCode},{withAuthentication:!0});return s?.id?{errors:["Already have an active access"],responseData:{redirectUrl:e.errorUrl}}:{errors:[],responseData:{redirectUrl:s.endpoint}}}catch{throw new Error("Failed to generate PayPal payment url")}};iFrameCardPayment=async()=>({errors:[],responseData:{}});paymentWithoutDetails=async()=>({errors:[],responseData:{}});updateOrder=async({order:e,couponCode:s})=>{try{const r=await this.apiService.post("/vouchers/discount",{voucher_code:`${s}`,access_fee_id:e.id},{withAuthentication:!0}),a=e.totalPrice-r.amount,o={...e,totalPrice:r.amount,priceBreakdown:{...e.priceBreakdown,discountAmount:a,discountedPrice:a},discount:{applied:!0,type:"coupon",periods:r.discount_duration}};return{errors:[],responseData:{message:"successfully updated",order:o,success:!0}}}catch(r){throw ke.isCommonError(r)&&r.response.data.message==="Voucher not found"?new Error("Invalid coupon code"):new Error("An unknown error occurred")}};getEntitlements=async({offerId:e})=>{try{const s=await this.apiService.get(`/items/${this.parseOfferId(e)}/access`,{withAuthentication:!0});return this.formatEntitlements(s.expires_at,!0)}catch{return this.formatEntitlements()}};directPostCardPayment=async(e,s,r,a)=>{const o={number:e.cardNumber.replace(/\s/g,""),card_name:e.cardholderName,exp_month:e.cardExpMonth||"",exp_year:e.cardExpYear||"",cvv:e.cardCVC,access_fee:s.id,payment_method:1,voucher_code:e.couponCode,referrer:r,return_url:a};try{return fa(s)?await this.apiService.post("/subscriptions",o,{withAuthentication:!0}):await this.apiService.post("/payments",o,{withAuthentication:!0}),!0}catch{throw new Error("Failed to make payment")}};finalizeStripePpvPayment=async({paymentIntent:e})=>{try{await this.apiService.post("/payments",{pi_id:e},{withAuthentication:!0})}catch{throw new Error("Failed to confirm payment")}};getSubscriptionSwitches=void 0;getOrder=void 0;switchSubscription=void 0;getSubscriptionSwitch=void 0;createAdyenPaymentSession=void 0;initialAdyenPayment=void 0;finalizeAdyenPayment=void 0;updatePaymentMethodWithPayPal=void 0;deletePaymentMethod=void 0;addAdyenPaymentDetails=void 0;finalizeAdyenPaymentDetails=void 0;getOffer=void 0})||Kt)||Kt)||Kt)||Kt);var Ki,Qi,Xi,Zi,ec,tc,nt;let Bh=(Ki=le(),Qi=function(t,e){return Vd("JWP")(t,void 0,0)},Xi=function(t,e){return Z(lt)(t,void 0,0)},Zi=function(t,e){return Z(ke)(t,void 0,1)},ec=Reflect.metadata("design:type",Function),tc=Reflect.metadata("design:paramtypes",[typeof lt>"u"?Object:lt,typeof ke>"u"?Object:ke]),Ki(nt=Qi(nt=Xi(nt=Zi(nt=ec(nt=tc(nt=class extends Us{accountService;apiService;constructor(e,s){super(),this.accountService=e,this.apiService=s}formatCardDetails=e=>{const{number:s,exp_month:r,exp_year:a,card_name:o,card_type:i,account_id:c,currency:l}=e,d=`0${r}`.slice(-2);return{id:0,paymentMethodId:0,paymentGateway:"card",paymentMethod:"card",customerId:c.toString(),paymentMethodSpecificParams:{holderName:o,variant:i,lastCardFourDigits:String(s),cardExpirationDate:`${d}/${a}`},active:!0,currency:l}};formatTransaction=e=>{const s=e?.charged_amount?.toString()||"0";return{transactionId:e.transaction_token||me.t("user:payment.access_granted"),transactionDate:e.created_at,trxToken:e.trx_token,offerId:e.item_id?.toString()||me.t("user:payment.no_transaction"),offerType:e.item_type||"",offerTitle:e?.item_title||"",offerPeriod:"",transactionPriceExclTax:s,transactionCurrency:e.currency_iso||"EUR",discountedOfferPrice:s,offerCurrency:e.currency_iso||"EUR",offerPriceExclTax:s,applicableTax:"0",transactionPriceInclTax:s,customerId:e.consumer_id?.toString(),customerEmail:"",customerLocale:"",customerCountry:"en",customerIpCountry:"",customerCurrency:"",paymentMethod:e.payment_method_name||me.t("user:payment.access_granted")}};formatActiveSubscription=(e,s)=>{let r="";switch(e.action_type){case"free-trial":r="active_trial";break;case"recurrent":r="active";break;case"canceled":r="cancelled";break;case"incomplete_expired":case"ended":r="expired";break;default:r="terminated"}return{subscriptionId:e.subscription_id,offerId:e.item_id?.toString(),accessFeeId:`S${e.access_fee_id}`,status:r,expiresAt:s,nextPaymentAt:e.next_rebill_date,nextPaymentPrice:e.subscription_price,nextPaymentCurrency:e.currency,paymentGateway:"stripe",paymentMethod:e.payment_method_name,offerTitle:e.item_title,period:e.access_type?.period,totalPrice:e.charged_amount,unsubscribeUrl:e.unsubscribe_url,pendingSwitchId:null}};formatGrantedSubscription=e=>({subscriptionId:"",offerId:e.item.id.toString(),status:"active",expiresAt:e.expires_at,nextPaymentAt:e.expires_at,nextPaymentPrice:0,nextPaymentCurrency:"EUR",paymentGateway:"none",paymentMethod:me.t("user:payment.access_granted"),offerTitle:e.item.title,period:"granted",totalPrice:0,unsubscribeUrl:"",pendingSwitchId:null});getActiveSubscription=async()=>{const e=this.accountService.assetId;if(e===null)throw new Error("Couldn't fetch active subscription, there is no assetId configured");try{const s=await this.apiService.get(`/items/${e}/access`,{withAuthentication:!0});if(s){const a=(await this.apiService.get("/subscriptions",{withAuthentication:!0,contentType:"json"},{limit:15,page:0})).collection.find(o=>o.item_id===e);return a?this.formatActiveSubscription(a,s?.expires_at):this.formatGrantedSubscription(s)}return null}catch(s){if(ke.isCommonError(s)&&s.response.data.code===402)return null;throw new Error("Unable to fetch customer subscriptions.")}};getAllTransactions=async()=>{try{return(await this.apiService.get("/v2/accounting/payment-history",{withAuthentication:!0,contentType:"json"}))?.collection?.map(s=>this.formatTransaction(s))}catch{throw new Error("Failed to get transactions")}};getActivePayment=async()=>{try{const e=await this.apiService.get("/v2/payments/cards/default",{withAuthentication:!0,contentType:"json"}),s=[];for(const r in e?.cards)s.push(this.formatCardDetails({...e.cards?.[r],currency:r}));return s.find(r=>r.active)||null}catch{return null}};getSubscriptions=async()=>({errors:[],responseData:{items:[]}});updateSubscription=async({offerId:e,unsubscribeUrl:s})=>{if(!s)throw new Error("Missing unsubscribe url");try{return await this.apiService.get(s,{withAuthentication:!0,contentType:"json"}),{errors:[],responseData:{offerId:e,status:"cancelled",expiresAt:0}}}catch{throw new Error("Failed to update subscription")}};changeSubscription=async({accessFeeId:e,subscriptionId:s})=>{try{const r=await this.apiService.post("/v2/subscriptions/stripe:switch",{inplayer_token:s,access_fee_id:e},{withAuthentication:!0});return{errors:[],responseData:{message:r.message}}}catch{throw new Error("Failed to change subscription")}};updateCardDetails=async({cardName:e,cardNumber:s,cvc:r,expMonth:a,expYear:o,currency:i})=>{try{const c=await this.apiService.put("/v2/payments/cards/default",{number:s,card_name:e,cvv:r,exp_month:a,exp_year:o,currency_iso:i},{withAuthentication:!0});return{errors:[],responseData:c}}catch{throw new Error("Failed to update card details")}};fetchReceipt=async({transactionId:e})=>{try{const s=await this.apiService.get(`/v2/accounting/transactions/${e}/receipt`,{withAuthentication:!0,contentType:"json",responseType:"blob"});return{errors:[],responseData:s}}catch{throw new Error("Failed to get billing receipt")}};getPaymentDetails=void 0;getTransactions=void 0})||nt)||nt)||nt)||nt)||nt)||nt);const Uh=t=>t.get(Kn).getIntegrationType(),Hh=t=>t.integrations?.cleeng?.id?ss.CLEENG:null,Wh=t=>t.integrations?.jwp?.clientId?ss.JWP:null;K.bind(Mn).toSelf();K.bind(Wr).toSelf();K.bind(Vr).toSelf();K.bind(gl).toSelf();K.bind(xe).toSelf();K.bind(Dn).toSelf();K.bind(Rn).toSelf();K.bind(Kn).toSelf();K.bind(Ms).toSelf();K.bind(fs).toSelf();K.bind(_l).toSelf();K.bind(yl).toSelf();K.bind(ie).toSelf();K.bind(vt).toSelf();K.bind(ps).toSelf();K.bind(mn).to(yh).whenNamed(oa.jwp);K.bind(mn).to(fh).whenNamed(oa.viewNexa);K.bind(Fs).toDynamicValue(Uh);K.bind(Zc).toDynamicValue(vh);K.bind(ia).toConstantValue(Hh);K.bind(At).toSelf();K.bind(lt).to(jh).whenNamed(ss.CLEENG);K.bind(Bs).to(Ch).whenNamed(ss.CLEENG);K.bind(Us).to(Ph).whenNamed(ss.CLEENG);K.bind(ia).toConstantValue(Wh);K.bind(ke).toSelf();K.bind(ma).toSelf();K.bind(lt).to(Mh).whenNamed(ss.JWP);K.bind(Bs).to(Fh).whenNamed(ss.JWP);K.bind(Us).to(Bh).whenNamed(ss.JWP);class Vh extends ha{constructor(e){super(),this.logLevel=e}log(e,s,r,a,o){if(!(e<this.logLevel)){switch(e){case Ye.ERROR:case Ye.FATAL:console.error(`${Ye[e]} [${s}] ${r}`);break;case Ye.WARN:console.warn(`${Ye[e]} [${s}] ${r}`);break;default:console.log(`${Ye[e]} [${s}] ${r}`)}o&&console.error(o),a&&Object.keys(a).length>0&&console.log(a)}}}var sc,nc;let qh=(sc=le(),sc(nc=class extends de{prefix="jwapp";initialize(e){this.prefix=e}getStorageKey(e,s=!0){return s?`${this.prefix}.${e}`:e}async getItem(e,s,r=!0){try{const a=window.localStorage.getItem(r?this.getStorageKey(e):e);return a&&s?JSON.parse(a):a}catch(a){Pe("LocalStorageService","Failed to parse localStorage entry",{error:a})}}async setItem(e,s,r=!0){try{window.localStorage.setItem(r?this.getStorageKey(e):e,s)}catch(a){Pe("LocalStorageService","Failed to store localStorage entry",{error:a})}}async removeItem(e,s=!0){try{window.localStorage.removeItem(this.getStorageKey(e,s))}catch(r){Pe("LocalStorageService","Failed to remove localStorage entry",{error:r})}}base64Encode(e){return window.btoa(e)}base64Decode(e){return window.atob(e)}})||nc);const zh=async()=>{K.bind(de).to(qh),K.bind(el).toConstantValue(new qd("jwp-refresh-token-channel")),K.bind(un).toConstantValue(async()=>void 0),K.bind(ha).toDynamicValue(()=>new Vh(Ye.ERROR))},jl=()=>{let t=!1;document.addEventListener("keydown",e=>{e.key==="Tab"&&!t&&(t=!0,document.body.classList.add("is-tabbing"))}),document.addEventListener("mousedown",()=>{t&&(t=!1,document.body.classList.remove("is-tabbing"))})};wu({APP_VERSION:"4.30.0",APP_API_BASE_URL:"https://cdn.jwplayer.com",APP_PLAYER_ID:"M4qoGvUk",APP_DEFAULT_CONFIG_SOURCE:void 0,APP_PLAYER_LICENSE_KEY:void 0,APP_CONSENT_COOKIE_NAME:void 0,APP_CONSENT_COOKIE_POLICY_URL:void 0,APP_FOOTER_TEXT:"\\u00a9 JW Player | [jwpconnatix.com](https://jwpconnatix.com) | v4.30.0",APP_PUBLIC_URL:window.location.origin,APP_GTM_TAG_ID:void 0,APP_GTM_TAG_SERVER:void 0,APP_GTM_SCRIPT:""});jl();async function Gh(){await zh(),jl();const{default:t}=await ra(async()=>{const{default:s}=await Promise.resolve().then(()=>UC);return{default:s}},void 0),e=document.getElementById("root");e?$d.createRoot(e).render(n.jsx(t,{})):console.info("Application - rootElement not found")}Gh();const Jh=bu({immediate:!0,onNeedRefresh:()=>Jh(!0)}),Cl=new Gd({defaultOptions:{queries:{staleTime:60*60*1e3,refetchOnWindowFocus:!1,retryOnMount:!1}}});function Yh({children:t}){return n.jsx(zd,{client:Cl,children:t})}const Kh="_errorPage_rlhdo_1",Qh="_box_rlhdo_17",Xh="_title_rlhdo_22",Zh="_message_rlhdo_29",em="_main_rlhdo_33",tm="_image_rlhdo_58",Cs={errorPage:Kh,box:Qh,title:Xh,message:Zh,main:em,image:tm},Ke=({title:t,message:e,learnMoreLabel:s,...r})=>{const{t:a}=I("error");return n.jsx(Pl,{title:t||a("generic_error_heading"),message:e||a("generic_error_description"),learnMoreLabel:s||a("learn_more"),...r})},Pl=({title:t,children:e,message:s,learnMoreLabel:r,error:a,helpLink:o})=>{const i=H(l=>l.config?.assets?.banner);return n.jsx("div",{className:Cs.errorPage,children:n.jsxs("div",{className:Cs.box,children:[n.jsx("img",{className:Cs.image,src:i||"/images/logo.png",alt:""}),n.jsx("h1",{className:Cs.title,"aria-live":"polite",children:t||"An error occurred"}),n.jsxs("div",{className:Cs.main,children:[n.jsx("p",{className:Cs.message,children:s||"Try refreshing this page or come back later."}),e,Du]})]})})},sm="_buffer_rrxgr_1",nm="_small_rrxgr_20",rm="_large_rrxgr_30",ir={buffer:sm,small:nm,large:rm},vs=({size:t="medium",className:e=""})=>n.jsxs("div",{className:L(ir.buffer,e,{[ir.small]:t==="small",[ir.large]:t==="large"}),children:[n.jsx("div",{}),n.jsx("div",{}),n.jsx("div",{}),n.jsx("div",{})]}),am="_loadingOverlay_96qzh_1",om="_fixed_96qzh_7",im="_transparent_96qzh_17",cm="_inline_96qzh_21",Pn={loadingOverlay:am,fixed:om,transparent:im,inline:cm},ve=({transparentBackground:t=!1,inline:e=!1})=>{const s=L(Pn.loadingOverlay,{[Pn.transparent]:t,[Pn.fixed]:!e,[Pn.inline]:e});return n.jsx("div",{className:s,children:n.jsx(vs,{size:"medium"})})},lm="_formFeedback_17d9k_1",dm="_info_17d9k_11",um="_error_17d9k_16",hm="_warning_17d9k_21",mm="_success_17d9k_26",Ys={formFeedback:lm,info:dm,error:um,warning:hm,success:mm},pm={info:"polite",success:"assertive",warning:"polite",error:"assertive"},Ie=({children:t,variant:e="error",visible:s=!0})=>{const r=L(Ys.formFeedback,{[Ys.error]:e==="error",[Ys.warning]:e==="warning",[Ys.success]:e==="success",[Ys.info]:e==="info",hidden:!s}),a=pm[e];return n.jsx("div",{"aria-live":a,className:r,children:t})},El=m.createContext(void 0),Fe=()=>{const t=m.useContext(El);if(!t)throw new Error("Announcer context is not defined");return t.announce},fm=({children:t})=>{const[e,s]=m.useState(null),r=m.useCallback((a,o,i=Jd(10))=>{s({message:a,variant:o}),setTimeout(()=>{s(null)},i)},[]);return n.jsxs(El.Provider,{value:{announce:r},children:[e&&Od.createPortal(n.jsx(Ie,{variant:e.variant,visible:!1,children:e.message}),document.body),t]})};function w0(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}const gm=(t,e)=>e.reduce((s,r)=>{const a=t.find(({code:o})=>o===r);if(a)return[...s,a];throw new Error(`Missing defined language for code: ${r}`)},[]),_m=["account","common","cookiebanner","country","demo","epg","error","menu","search","us_state","user","video"],ym=[{code:"en",displayName:"English"},{code:"es",displayName:"Espaol"},{code:"nl",displayName:"Nederlands"},{code:"fr",displayName:"Franais"},{code:"de",displayName:"Deutsch"}],vm=async()=>{const t="en,es,nl,fr,de".split(",")||[],e="en",s=gm(ym,t);if(H.setState({supportedLanguages:s}),!s.some(({code:r})=>r===e))throw new Error(`The default language is not enabled: ${e}`);await me.use(Yd).use(Kd).use(Qd).init({supportedLngs:s.map(({code:r})=>r),fallbackLng:e,returnEmptyString:!1,ns:_m,defaultNS:"common",fallbackNS:"common",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"jwapp.language"},react:{useSuspense:!1}})},xm=!!(typeof window<"u"&&window.document&&window.document.createElement);let En;function bm(t){if((!En&&En!==0||t)&&xm){const e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),En=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return En}const ga=()=>document.scrollingElement||document.body,wm=t=>new Promise(e=>{const s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=t,s.onload=()=>e(),s.onerror=r=>{throw console.info("Error loading external script",r),new Error("Error loading external script")},document.body.appendChild(s)}),Sm=t=>{if(!t)return;const e=document.createElement("script");e.type="text/javascript",e.textContent=t,document.head.appendChild(e)},rc=(t,e,s)=>{const r=new Date;r.setDate(r.getDate()+s),document.cookie=`${t}=${e};expires=${r.toUTCString()};path=/`},jm=t=>{const e=new RegExp("(^| )"+t+"=([^;]+)").exec(document.cookie);return e?e[2]:null},Cm=t=>{document.cookie=`${t}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/`};function kl(){const t=M.APP_CONSENT_COOKIE_NAME||"cookies.consent",[e,s]=m.useState(!1),[r,a]=m.useState(()=>{const l=jm(t);return l===null?null:l==="true"?"accepted":"declined"}),o=m.useCallback(()=>{rc(t,"true",365),a("accepted")},[t]),i=m.useCallback(()=>{rc(t,"false",365),a("declined")},[t]),c=m.useCallback(()=>{Cm(t),a(null)},[t]);return m.useEffect(()=>{M.APP_GTM_LOAD_ON_ACCEPT&&r==="accepted"&&!e&&M.APP_GTM_SCRIPT&&(Sm(M.APP_GTM_SCRIPT),s(!0))},[r,e]),{isActive:!!M.APP_GTM_TAG_ID,isGTMLoaded:e,consent:r,reset:c,accept:o,decline:i}}const ac=new Hc({defaultScope:"Singleton",autobind:!0}),rs=(t,e)=>s=>{if(ac.isBound(t)){const a=ac.get(t);return n.jsx(a,{...s})}return n.jsx(e,{...s})},Pm="_button_15pe7_1",Em="_disabled_15pe7_21",km="_small_15pe7_33",Im="_large_15pe7_36",Nm="_primary_15pe7_46",Am="_outlined_15pe7_53",Tm="_active_15pe7_56",Lm="_text_15pe7_62",$m="_danger_15pe7_77",Om="_fullWidth_15pe7_87",Mm="_startIcon_15pe7_101",Dm="_hidden_15pe7_119",Rm="_centerAbsolute_15pe7_123",mt={button:Pm,disabled:Em,small:km,large:Im,default:"_default_15pe7_39",primary:Nm,outlined:Am,active:Tm,text:Lm,danger:$m,delete:"_delete_15pe7_82",fullWidth:Om,startIcon:Mm,hidden:Dm,centerAbsolute:Rm},Fm=Symbol("BUTTON"),Bm=({label:t,children:e,color:s="default",startIcon:r,fullWidth:a=!1,active:o=!1,variant:i="outlined",size:c="medium",disabled:l,busy:d,type:u="button",to:h,onClick:p,className:g,activeClassname:f="",...y})=>{const v=b=>L(mt.button,g,mt[s],mt[i],{[mt.active]:b,[f]:b,[mt.fullWidth]:a,[mt.large]:c==="large",[mt.small]:c==="small",[mt.disabled]:l}),_=n.jsxs(n.Fragment,{children:[r&&n.jsx("div",{className:mt.startIcon,children:r}),n.jsx("span",{className:L({[mt.hidden]:d})||void 0,children:t}),e,d&&n.jsx(vs,{className:mt.centerAbsolute,size:"small"})]});return h?n.jsx(zc,{className:({isActive:b})=>v(b),to:h,...y,end:!0,children:_}):n.jsx("button",{className:v(o),onClick:l?void 0:p,type:u,"aria-disabled":l,...y,children:_})},D=rs(Fm,Bm),ee=t=>{const e=m.useRef(()=>{throw new Error("Callback called in render")});return m.useLayoutEffect(()=>{e.current=t},[t]),m.useCallback((...s)=>{if(typeof e.current=="function")return e.current(...s)},[])},Um=t=>t?.scrollTop,_a=({className:t,createStyle:e,open:s=!0,duration:r=250,delay:a=0,onOpenAnimationEnd:o,onCloseAnimationEnd:i,keepMounted:c=!1,children:l})=>{const d=m.useRef(null),[u,h]=m.useState("closed"),[p,g]=m.useState(!1),f=m.useRef(),y=m.useRef(),v=ee(()=>{g(!0),Um(d.current),f.current=window.setTimeout(()=>h("opening"),a),y.current=window.setTimeout(()=>{h("open"),o?.()},r+a)}),_=ee(()=>{p&&(f.current=window.setTimeout(()=>h("closing"),a),y.current=window.setTimeout(()=>{h("closed"),i?.()},r+a))});return m.useEffect(()=>(s?v():_(),()=>{clearTimeout(f.current),clearTimeout(y.current)}),[s,v,_]),!s&&u==="closed"&&!c?null:n.jsx("div",{style:e(u),className:t,ref:d,children:l})},Hm=({open:t=!0,duration:e=250,delay:s=0,onOpenAnimationEnd:r,onCloseAnimationEnd:a,children:o,className:i})=>{const l=`transform ${e/1e3}s ease-out`,d=u=>({transition:l,transform:u==="opening"||u==="open"?"scale(1)":"scale(0.7)"});return n.jsx(_a,{createStyle:u=>d(u),open:t,duration:e,delay:s,onOpenAnimationEnd:r,onCloseAnimationEnd:a,className:i,children:o})},Wm=()=>{document.body.style.marginRight=`${bm(!0)}px`,document.body.style.overflowY="hidden"},oc=()=>{Array.from(document.querySelectorAll("dialog")).filter(s=>s.open).length||(document.body.style.removeProperty("margin-right"),document.body.style.removeProperty("overflow-y"))};let Ks;const Vm=()=>{const t=m.useCallback(()=>{if(!Ks||document.activeElement!==document.body)return;Array.from(document.querySelectorAll("dialog")).filter(o=>o.open).length===0&&(Ks.focus(),Ks=void 0)},[]);m.useEffect(()=>()=>{oc(),t()},[t]);const e=m.useCallback(()=>{Ks||(Ks=document.activeElement),Wm()},[]),s=m.useCallback(()=>{t(),oc()},[t]);return{handleOpen:e,handleClose:s}},qm="_centered_evruy_15",zm="_close_evruy_21",kn={centered:qm,close:zm},pn=({open:t,onClose:e,children:s,className:r,centered:a,role:o,AnimationComponent:i=Hm,animationContainerClassName:c,...l})=>{const d=m.useRef(),u=m.useRef({downTarget:null,upTarget:null}),{handleOpen:h,handleClose:p}=Vm(),g=ee(()=>{const x=()=>{d.current?.classList.remove(kn.close),d.current?.removeEventListener("animationend",x)};d.current?.open&&(d.current.addEventListener("animationend",x),d.current.classList.add(kn.close))}),f=ee(()=>{h(),d.current?.showModal(),d.current?.classList.remove(kn.close)}),y=x=>{x.key==="Escape"&&d.current.contains(x.target)&&(x.preventDefault(),e?.())},v=x=>{d.current.contains(x.target)&&(e?.(),p())},_=()=>{d.current?.close()};m.useEffect(()=>{t?f():g()},[f,g,t]);const b=x=>{const{current:{downTarget:P,upTarget:w}}=u;P===w&&x.target===d.current&&(e?.(),p())};return Md.createPortal(n.jsx("dialog",{className:L(r,{[kn.centered]:a}),onKeyDown:y,onClose:v,onClick:b,onMouseDown:x=>{u.current.downTarget=x.target},onMouseUp:x=>{u.current.upTarget=x.target},ref:d,role:o,...l,children:n.jsx(i,{open:t,duration:300,className:c,onCloseAnimationEnd:_,children:s})}),document.querySelector("body"))},Xn=({open:t=!0,duration:e=250,delay:s=0,onOpenAnimationEnd:r,onCloseAnimationEnd:a,children:o,direction:i="top",style:c={}})=>{const l=e/1e3,d=`transform ${l}s ease, opacity ${l}s ease`,u={left:"translate(-15px, 0)",top:"translate(0, -15px)",right:"translate(15px, 0)",bottom:"translate(0, 15px)"},h=p=>({transition:d,transform:p==="opening"||p==="open"?"translate(0, 0)":u[i],opacity:p==="opening"||p==="open"?1:0,zIndex:15,...c});return n.jsx(_a,{createStyle:p=>h(p),open:t,duration:e,delay:s,onOpenAnimationEnd:r,onCloseAnimationEnd:a,children:o})},Gm="_overlay_e2w5p_1",Jm="_banner_e2w5p_11",Ym="_buttonBar_e2w5p_28",cr={overlay:Gm,banner:Jm,buttonBar:Ym},Km=Symbol("COOKIE_WALL"),Qm=({onAccept:t,onDecline:e,onOpen:s,onClose:r})=>{const{t:a}=I("cookiebanner"),{isActive:o,consent:i,accept:c,decline:l}=kl();m.useEffect(()=>{o&&(i?r?.():s?.())},[i,o,s,r]);const d=()=>{c(),t?.()},u=()=>{l(),e?.()};if(!o||i!==null)return null;const h=(M.APP_CONSENT_COOKIE_POLICY_URL||"#").split("|").map(p=>n.jsx("a",{href:p},p));return n.jsx(pn,{open:!0,AnimationComponent:Xn,className:cr.overlay,role:"alertdialog","aria-labelledby":"cookie-banner-title","aria-describedby":"cookie-banner-description",children:n.jsxs("div",{className:cr.banner,children:[n.jsx("h1",{className:"hidden",id:"cookie-banner-title",children:a("title")}),n.jsx("p",{id:"cookie-banner-description",children:n.jsx(Gc,{t:a,components:h,i18nKey:"consent_text",defaults:"We use cookies to improve your experience. Do you accept the use of cookies?"})}),n.jsxs("div",{className:cr.buttonBar,children:[n.jsx(D,{label:a("accept"),onClick:d,color:"primary","data-testid":void 0}),n.jsx(D,{label:a("decline"),onClick:u,"data-testid":void 0})]})]})})},Xm=rs(Km,Qm),Il=(t,e={})=>ye(`${t.pathname}${t.search||""}`,e),q=(t,e,s)=>ye(`${t.pathname}${t.search||""}`,{u:e,...s}),It=(t,e)=>ye(window.location.href,{u:t,...e});function Le(t){const[e]=Ds();return e.get(t)}const Zm=(t,e=1,s)=>{const r=m.useRef(),[a,o]=m.useState(t);return m.useEffect(()=>{if(window.clearTimeout(r.current),a===0){s&&s();return}return r.current=window.setTimeout(()=>{o(i=>i-e)},e*1e3),()=>{window.clearTimeout(r.current)}},[s,a,e]),a},ep="_welcome_v7d1f_1",tp={welcome:ep},sp=({onCloseButtonClick:t,onCountdownCompleted:e,siteName:s})=>{const{t:r}=I("account"),a=Zm(10,1,e);return n.jsxs("div",{className:tp.welcome,children:[n.jsx("h2",{children:r("checkout.welcome_title",{siteName:s})}),n.jsx("p",{children:r("checkout.welcome_description",{siteName:s})}),n.jsx(D,{variant:"contained",color:"primary",label:r("checkout.start_watching",{countdown:a}),onClick:t,size:"large",fullWidth:!0})]})},np="_title_82pz9_1",rp="_message_82pz9_6",ic={title:np,message:rp},cc=({type:t,message:e,onCloseButtonClick:s})=>{const{t:r}=I("account");return n.jsxs("div",{children:[n.jsx("h2",{className:ic.title,children:r(t==="cancelled"?"checkout.payment_cancelled":"checkout.payment_error")}),n.jsx("p",{className:ic.message,children:t==="cancelled"?r("checkout.payment_cancelled_message"):e}),n.jsx("div",{children:n.jsx(D,{label:r("checkout.close"),onClick:s,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},Zn=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),m.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),ap="_iconButton_12yfl_1",op={iconButton:ap},Re=({children:t,onClick:e,className:s,...r})=>n.jsx("button",{className:L(op.iconButton,s),type:"button",onClick:e,...r,children:t}),ip="_icon_1me4h_1",cp={icon:ip},V=({icon:t,className:e})=>n.jsx(t,{className:L(cp.icon,e),"aria-hidden":"true"}),lp="_modalCloseButton_1qofm_1",dp="_hidden_1qofm_15",lc={modalCloseButton:lp,hidden:dp},Nl=({onClick:t,visible:e=!0})=>{const{t:s}=I("common");return n.jsx(Re,{onClick:t,"aria-label":s("close_modal"),className:L(lc.modalCloseButton,{[lc.hidden]:!e}),children:n.jsx(V,{icon:Zn})})},up="_dialog_1ha9n_1",hp="_small_1ha9n_16",mp="_large_1ha9n_20",dc={dialog:up,small:hp,large:mp},ya=({open:t,onClose:e,children:s,size:r="small",role:a,...o})=>n.jsx(pn,{open:t,onClose:e,AnimationComponent:Xn,role:a,centered:!0,children:n.jsxs("div",{className:L(dc.dialog,dc[r]),"data-testid":void 0,...o,children:[s,n.jsx(Nl,{onClick:e})]})});function Lt({initialValues:t,validationSchema:e,validateOnBlur:s=!1,onSubmit:r,onSubmitSuccess:a,onSubmitError:o}){const{t:i}=I("error"),[c,l]=m.useState(Object.fromEntries(Object.keys(t).map(C=>[C,!1]))),[d,u]=m.useState(t),[h,p]=m.useState(!1),[g,f]=m.useState({}),[y,v]=m.useState(!1),_=m.useCallback(()=>{u(t),f({}),v(!1),p(!1),l(Object.fromEntries(Object.keys(t).map(C=>[C,!1])))},[t]),b=(C,E)=>{if(e)try{e.validateSyncAt(C,E),f(A=>({...A,[C]:null}))}catch(A){if(A instanceof Va){const T=A.errors[0];f($=>({...$,[C]:T})),v(!0)}}},x=m.useCallback((C,E)=>{u(A=>({...A,[C]:E}))},[]),P=C=>{const E=C.target.name,A=C.target instanceof HTMLInputElement&&C.target.type==="checkbox"?C.target.checked:C.target.value,T={...d,[E]:A};u(T),l($=>({...$,[E]:A})),g[E]&&b(E,T)},w=C=>{!s||!c[C.target.name]||b(C.target.name,d)},j=C=>{try{return C.validateSync(d,{abortEarly:!1}),!0}catch(E){if(E instanceof Va){const A={};for(let T=0;T<E.inner.length;T++){const $=E.inner[T].path,U=E.inner[T].errors[0];$&&U&&!A[$]&&(A[$]=U)}E.inner.every(T=>T.type==="required")?A.form=i("validation_form_error.required"):A.form=i("validation_form_error.other"),f(A)}}return!1};return{values:d,errors:g,validationSchemaError:y,handleChange:P,handleBlur:w,handleSubmit:async C=>{if(C.preventDefault(),!(!r||h)){if(f({}),v(!1),e&&!j(e)){v(!0);return}p(!0);try{await r(d,{setValue:x,setErrors:f,setSubmitting:p,setValidationSchemaError:v,validate:j}),a?.(d)}catch(E){const A={};E instanceof We?Object.entries(E.errors).forEach(([T,$])=>{T&&$&&!A[T]&&(A[T]=$.join(","))}):E instanceof Error?A.form=E.message:A.form=i("unknown_error"),f(A),o?.({error:E,resetValue:T=>x(T,"")})}p(!1)}},submitting:h,setValue:x,setErrors:f,setSubmitting:p,setValidationSchemaError:v,reset:_}}const va=(t=!1)=>{const[e,s]=m.useState(t);return[e,a=>s(o=>typeof a<"u"?a:!o)]},xa=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"})),ba=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"})),uc=(t,e)=>{const s=Math.random()*1e4;return[t,Math.round(s),e].filter(Boolean).join("_").replace(/[\s.]+/g,"_").toLowerCase()},dt=(t,e,s)=>{const[r,a]=m.useState(s||uc(t,e));return m.useEffect(()=>{a(s||uc(t,e))},[s,t,e]),r},pp="_helperText_87c91_1",fp="_error_87c91_6",hc={helperText:pp,error:fp},gp=({children:t,className:e,error:s,id:r})=>{const a=dt("helper_text",void 0,r);return t?n.jsx("div",{id:a,className:L(hc.helperText,{[hc.error]:s},e),children:t}):null},_p="_formField_130lt_1",yp="_label_130lt_6",mc={formField:_p,label:yp},fn=({className:t,renderInput:e,required:s,label:r,error:a,helperText:o,testId:i,editing:c=!0,name:l})=>{const d=L(mc.formField,t),u=dt("text-field",l),h=dt("helper_text",l);return n.jsxs("div",{className:d,"data-testid":i,children:[!!r&&n.jsxs("label",{htmlFor:u,className:mc.label,children:[r,s&&c?n.jsx("span",{"aria-hidden":"true",children:"*"}):null]}),e({helperTextId:h,id:u}),c&&n.jsx(gp,{id:h,error:a,children:o})]})},vp="_container_165fu_1",xp="_error_165fu_10",bp="_disabled_165fu_13",wp="_leftControl_165fu_16",Sp="_input_165fu_16",jp="_rightControl_165fu_19",Cp="_control_165fu_31",Qt={container:vp,error:xp,disabled:bp,leftControl:wp,input:Sp,rightControl:jp,control:Cp},Pp=(t,e)=>!!e,Ep=({required:t,className:e,disabled:s,editing:r=!0,value:a,id:o,name:i,multiline:c,error:l,helperTextId:d,type:u,textAreaRef:h,inputRef:p,leftControl:g,rightControl:f,...y})=>{const v=u||"text",_=L(Qt.container,{[Qt.error]:l,[Qt.disabled]:s,[Qt.leftControl]:!!g,[Qt.rightControl]:!!f},e),b={"aria-required":!!t,"aria-invalid":!!(t&&l&&a!==""),"aria-describedby":d},x={id:o,name:i,value:a,disabled:s,rows:c?3:void 0,className:Qt.input,readOnly:!r,required:t,...b,...y},P=Pp(x,c)?n.jsx("textarea",{...x,ref:h}):n.jsx("input",{...x,type:v,ref:p});return r?n.jsxs("div",{className:_,children:[g?n.jsx("div",{className:Qt.control,children:g}):null,P,f?n.jsx("div",{className:Qt.control,children:f}):null]}):P},kp="_textField_cksfq_1",Ip={textField:kp},ae=({className:t,helperText:e,label:s,error:r,required:a,editing:o=!0,testId:i,name:c,...l})=>n.jsx(fn,{className:L(Ip.textField,t),error:r,helperText:e,label:s,required:a,editing:o,testId:i,name:c,renderInput:d=>n.jsx(Ep,{editing:o,error:r,name:c,required:a,...d,...l})}),Np="_passwordStrength_1od1i_1",Ap="_passwordStrengthFill_1od1i_9",Tp="_label_1od1i_13",Lp="_passwordStrengthBar_1od1i_38",In={passwordStrength:Np,passwordStrengthFill:Ap,label:Tp,passwordStrengthBar:Lp},$p=/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,Op=({password:t})=>{const{t:e}=I("account"),r=(o=>{let i=0;return o.match($p)&&(o.match(/[A-Z]+/)&&(i+=1),o.match(/(\d.*\d)/)&&(i+=1),o.match(/[!,@#$%^&*?_~]/)&&(i+=1),o.match(/([!,@#$%^&*?_~].*[!,@#$%^&*?_~])/)&&(i+=1)),i})(t),a=[e("registration.password_strength.invalid"),e("registration.password_strength.weak"),e("registration.password_strength.fair"),e("registration.password_strength.strong"),e("registration.password_strength.very_strong")];return r?n.jsxs("div",{className:In.passwordStrength,"data-strength":r,children:[n.jsx("div",{className:In.passwordStrengthBar,children:n.jsx("div",{className:In.passwordStrengthFill})}),n.jsx("span",{className:"hidden",children:e("registration.password_strength_prefix")})," ",n.jsx("span",{className:In.label,children:a[r]})]}):null},an=({value:t,showToggleView:e=!0,helperText:s,showHelperText:r=!0,...a})=>{const{t:o}=I("account"),[i,c]=va();return n.jsx(ae,{...a,helperText:s??(r?n.jsxs(he.Fragment,{children:[n.jsx(Op,{password:t||""}),o("reset.password_helper_text")]}):null),type:i?"text":"password",rightControl:e?n.jsx(Re,{"aria-label":o("reset.view_password"),onClick:()=>c(),"aria-pressed":i,children:n.jsx(V,{icon:i?xa:ba})}):null,required:!0})},Mp="_heading_1ungm_1",Dp="_paragraph_1ungm_7",Rp="_disclaimer_1ungm_11",Fp="_buttons_1ungm_25",Bp="_stacked_1ungm_34",Up="_warningBox_1ungm_40",Xt={heading:Mp,paragraph:Dp,disclaimer:Rp,buttons:Fp,stacked:Bp,warningBox:Up},Hp=()=>{const t=W(ie),{t:e}=I("user"),s=Fe(),r=Le("u"),[a,o]=m.useState(""),i=se(),c=re(),{handleSubmit:l,handleChange:d,values:u,errors:h,setErrors:p,reset:g}=Lt({initialValues:{password:""},validationSchema:te().shape({password:R().required(e("login.field_required"))}),onSubmit:v=>{o(v.password),i(q(c,"delete-account-confirmation"),{replace:!0})}}),f=it(t.deleteAccountData,{onSuccess:async()=>{i("/"),await t.logout(),s(e("account.delete_account.success"),"success")},onError:v=>{v instanceof We&&(p(v.errors),i(q(c,"delete-account"),{replace:!0})),o("")}});m.useEffect(()=>{r==="delete-account-confirmation"&&!a&&i(q(c,"delete-account"),{replace:!0})},[c,r,i,a,f,g]);const y=m.useCallback(()=>{i(q(c,null),{replace:!0})},[c,i]);return a?n.jsxs("div",{children:[n.jsx("h2",{className:Xt.heading,children:e("account.delete_account.title")}),n.jsxs("div",{className:Xt.disclaimer,children:[n.jsx("p",{children:e("account.delete_account.modal.text_data_erasure")}),n.jsx("p",{children:e("account.delete_account.modal.text_revoked_access")}),n.jsx("div",{className:Xt.warningBox,children:n.jsx("p",{children:e("account.delete_account.modal.warning")})}),n.jsxs("p",{children:[e("account.delete_account.modal.text_cant_be_undone")," ",n.jsx("br",{}),e("account.delete_account.modal.text_contacts")]})]}),n.jsxs("div",{className:Xt.buttons,children:[n.jsx(D,{disabled:f.isLoading,variant:"text",label:e("account.cancel"),onClick:y}),n.jsx(D,{disabled:f.isLoading,variant:"delete",label:e("account.delete_account.title"),onClick:()=>{f.mutate(a)}})]})]}):n.jsxs("form",{onSubmit:l,children:[n.jsx("h2",{className:Xt.heading,children:e("account.delete_account.title")}),n.jsx("p",{className:Xt.paragraph,children:e("account.delete_account.modal.description")}),h.form&&n.jsx(Ie,{variant:"error",children:h.form}),n.jsx(an,{value:u.password,onChange:d,label:e("account.password"),placeholder:e("account.delete_account.modal.placeholder"),error:!!h.password||!!h.form,helperText:h.password,name:"password",showHelperText:!1}),n.jsxs("div",{className:L(Xt.buttons,Xt.stacked),children:[n.jsx(D,{type:"submit",color:"primary",label:e("account.continue"),fullWidth:!0}),n.jsx(D,{type:"button",onClick:y,variant:"text",label:e("account.cancel"),fullWidth:!0})]})]})},Wp="_container_lkpac_1",Vp="_title_lkpac_7",Al={container:Wp,title:Vp},qp=({onError:t})=>{const e=W(ie),s=W(vt),{t:r}=I("account"),a=Fe(),o=se(),i=re(),{accessModel:c}=H(({accessModel:y})=>({accessModel:y})),[l]=Ds(),d=l.get("redirectResult"),u=l.get("orderId"),[h,p]=m.useState(),g=m.useMemo(()=>q(i,c===Ae.SVOD?"welcome":null),[c,i]),f=ee(async y=>{const v=u?parseInt(u,10):void 0;try{await s.finalizeAdyenPayment({redirectResult:decodeURI(y)},v),await e.reloadSubscriptions({retry:10}),a(r("checkout.payment_success"),"success"),o(g)}catch(_){_ instanceof Error&&(p(_.message),t())}});return m.useEffect(()=>{d&&f(d)},[f,d]),n.jsx(n.Fragment,{children:h&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:Al.title,children:h}),n.jsx(D,{label:r("checkout.go_back_to_checkout"),variant:"contained",color:"primary",size:"large",onClick:()=>o(q(i,"checkout")),fullWidth:!0})]})})},zp=()=>{const t=W(vt),[e,s]=Ds(),r=m.useCallback(async a=>{try{await t.finalizeStripePpvPayment(a),s({u:"waiting-for-payment"})}finally{}},[]);return m.useEffect(()=>{const a=e.get("payment_intent");a&&r(a)},[]),null},pc=({type:t})=>{const[e,s]=m.useState(!0);return n.jsxs("div",{className:Al.container,children:[m.useMemo(()=>{switch(t){case"adyen":return n.jsx(qp,{onError:()=>s(!1)});case"stripe":return n.jsx(zp,{});default:return null}},[t]),e&&n.jsx("div",{children:n.jsx(vs,{})})]})},Gp=()=>{const t=W(ie),e=W(vt),s=m.useRef(),[r,a]=m.useState(null),{t:o}=I("user"),i=e.getSubscriptionOfferIds(),c=m.useCallback(({interval:l=3e3,iterations:d=5,offerId:u=i?.[0],callback:h})=>{if(!u){h?.({hasAccess:!1,offerId:""});return}s.current=window.setInterval(async()=>{await t.checkEntitlements(u)?(window.clearInterval(s.current),await t.reloadSubscriptions(),h?.({hasAccess:!0,offerId:u||""})):--d===0&&(window.clearInterval(s.current),a(o("payment.longer_than_usual")),h?.({hasAccess:!1,offerId:u||""}))},l)},[i,o,t]);return m.useEffect(()=>()=>{window.clearInterval(s.current)},[]),{intervalCheckAccess:c,errorMessage:r}},Jp="_center_153q1_1",Yp={center:Jp},Kp=()=>{const{t}=I("account"),e=Le("offerId")||void 0,s=re(),r=se(),a=Fe(),{intervalCheckAccess:o,errorMessage:i}=Gp();return m.useEffect(()=>{o({interval:3e3,iterations:5,offerId:e,callback:({hasAccess:c,offerId:l})=>{c&&(a(t("checkout.payment_success"),"success"),l.startsWith("C")||l.startsWith("P")?r(q(s,null)):r(q(s,"welcome")))}})},[]),n.jsx("div",{className:Yp.center,children:i?n.jsx("h2",{children:i}):n.jsxs(n.Fragment,{children:[n.jsx(vs,{}),n.jsx("h2",{children:t("checkout.waiting_for_payment")})]})})},Qp="_title_1edbn_1",Xp="_message_1edbn_8",fc={title:Qp,message:Xp},lr=({type:t,onCloseButtonClick:e})=>{const{t:s}=I("account"),r=Fe(),a=s(`checkout.upgrade_${t}`),o=s(`checkout.upgrade_${t}_message`);return m.useEffect(()=>{const i={error:"error",success:"succes",pending:"info"}[t];r(o,i)},[r,o,t]),n.jsxs("div",{children:[n.jsx("h2",{className:fc.title,children:a}),n.jsx("p",{className:fc.message,children:o}),n.jsx("div",{children:n.jsx(D,{label:s("checkout.close"),onClick:e,color:"primary",variant:"contained",size:"large",fullWidth:!0})})]})},Zp="_formFeedback_173nk_1",ef="_formContainer_173nk_5",tf="_passwordButtonsContainer_173nk_13",sf="_heading_173nk_30",nf="_paragraph_173nk_40",rf="_button_173nk_21",cs={formFeedback:Zp,formContainer:ef,passwordButtonsContainer:tf,heading:sf,paragraph:nf,button:rf},af=()=>{const t=W(ie),{t:e}=I("user"),s=B(d=>d.user?.email),[r,a]=m.useState(),o=se(),i=re(),c=m.useCallback(()=>{o(q(i,null),{replace:!0})},[i,o]),l=async()=>{try{s&&(await t.resetPassword(s,""),o(q(i,"add-password")))}catch{a(e("account.add_password_error"))}};return n.jsxs("div",{className:cs.formContainer,children:[r&&n.jsx("div",{className:cs.formFeedback,children:n.jsx(Ie,{variant:"error",children:r})}),n.jsx("h2",{className:cs.heading,children:e("account.delete_account_password_warning.title")}),n.jsx("p",{className:cs.paragraph,children:e("account.delete_account_password_warning.text")}),n.jsxs("div",{className:cs.passwordButtonsContainer,children:[n.jsx(D,{type:"submit",onClick:l,className:cs.button,color:"primary",fullWidth:!0,label:e("account.proceed_to_adding_a_password")}),n.jsx(D,{type:"button",onClick:c,className:cs.button,variant:"text",fullWidth:!0,label:e("account.cancel")})]})]})},Tl=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})),wa=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M7.37083 12.6026c-.70164 0-1.28549-.0571-1.72496-.1142l-1.34375 6.9595H.179688L3.83225.516163C5.08988.201006 7.07827 0 8.97801 0c1.75279 0 3.79949.286619 5.23309 1.28917 1.3172.88839 2.1354 2.23464 2.1354 4.0958 0 2.4344-1.1386 4.26703-2.6901 5.44083-1.6084 1.2333-3.8881 1.7768-6.28557 1.7768zm1.72496-9.30834c-.78902 0-1.34375.05832-1.69457.14393L6.28924 9.13832c.43821.08561.90681.14269 1.60845.14269 2.54311 0 4.20851-1.60433 4.20851-3.52257 0-1.8624-1.3741-2.46418-3.01041-2.46418zm7.22271.21844c.523.18487 1.0195.4169 1.4552.72213 1.3158.88715 2.1353 2.23339 2.1365 4.09456 0 2.43441-1.1398 4.26701-2.69 5.44201-1.6084 1.2321-3.8869 1.7756-6.2856 1.7756-.7016 0-1.28676-.0571-1.72497-.1154l-1.34501 6.9595H3.74219l.31915-1.6577h1.30702l1.34502-6.9582c.4382.057 1.02206.1141 1.72496.1141 2.39746 0 4.67586-.5447 6.28556-1.7755 1.549-1.1738 2.6888-3.00769 2.6888-5.44209 0-1.29909-.4053-2.34258-1.0942-3.15901z"})),of="_title_1tanv_1",cf="_success_1tanv_8",lf="_paymentMethodsInputs_1tanv_12",df="_paymentMethod_1tanv_12",uf="_paymentMethodLabel_1tanv_22",hf="_radio_1tanv_30",Mt={title:of,success:cf,paymentMethodsInputs:lf,paymentMethod:df,paymentMethodLabel:uf,radio:hf},mf=({paymentMethodId:t,paymentMethods:e,onCloseButtonClick:s,onPaymentMethodChange:r,renderPaymentMethod:a,submitting:o,updateSuccess:i})=>{const{t:c}=I("account"),l=Fe(),d=e?.find(h=>h.methodName==="card"),u=e?.find(h=>h.methodName==="paypal");return m.useEffect(()=>{i&&l(c("checkout.payment_success"),"success")},[i,l,c]),n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:Mt.title,children:c("payment.update_payment_details")}),i?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:Mt.success,children:c("payment.update_payment_success")}),n.jsx(D,{label:c("payment.back_to_profile"),onClick:s,color:"primary",fullWidth:!0})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:Mt.paymentMethodsInputs,children:[d?n.jsxs("div",{className:Mt.paymentMethod,children:[n.jsx("input",{className:Mt.radio,type:"radio",name:"paymentMethod",value:d.id,id:"card",checked:t===d.id,onChange:r}),n.jsxs("label",{className:Mt.paymentMethodLabel,htmlFor:"card",children:[n.jsx(V,{icon:Tl}),c("payment.credit_card")]})]}):null,u?n.jsxs("div",{className:Mt.paymentMethod,children:[n.jsx("input",{className:Mt.radio,type:"radio",name:"paymentMethod",value:u.id,id:"paypal",checked:t===u.id,onChange:r}),n.jsxs("label",{className:Mt.paymentMethodLabel,htmlFor:"paypal",children:[n.jsx(V,{icon:wa})," ",c("payment.paypal")]})]}):null]}),n.jsx("div",{children:a?a():null}),o&&n.jsx(ve,{transparentBackground:!0,inline:!0})]})]})},pf="_payPal_17v1t_1",ff={payPal:pf},Ll=({onSubmit:t,error:e})=>{const{t:s}=I("account");return n.jsxs("div",{className:ff.payPal,children:[e?n.jsx(Ie,{variant:"error",children:e}):null,n.jsx("p",{children:s("checkout.paypal_instructions")}),n.jsx(D,{label:s("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:t,fullWidth:!0})]})},gf="_adyen_1wab6_1",_f="_container_1wab6_5",gc={adyen:gf,container:_f},$l=({configuration:t,error:e,type:s})=>{const{t:r}=I("account"),a=m.useRef(null),o=m.useRef();return m.useEffect(()=>!a.current||!t.session?void 0:((async()=>{const c=await Xd(t);a.current&&(o.current=c.create(s),o.current?.mount(a.current))})(),()=>{o.current?.unmount()}),[t,s]),n.jsxs("div",{className:gc.adyen,children:[e?n.jsx(Ie,{variant:"error",children:e}):null,n.jsx("div",{className:gc.container,ref:a}),n.jsx(D,{label:r("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:()=>{o.current?.submit()},fullWidth:!0})]})};function yf({setProcessing:t,type:e,setPaymentError:s,error:r,paymentMethodId:a}){const o=W(ie),i=W(vt),c=o.getSandbox(),{t:l}=I("account"),d=Fe(),u=se(),h=re(),[p,g]=m.useState(),f=Le("redirectResult"),y=!!f,v=q(h,"payment-method-success"),_=ee(async P=>{try{t(!0),await i.finalizeAdyenPaymentDetails({redirectResult:decodeURI(P)},a),await o.reloadSubscriptions({retry:10}),t(!1),d(l("checkout.payment_success"),"success"),u(v)}catch(w){t(!1),w instanceof Error&&(s(w.message),u(q(h,"payment-method"),{replace:!0}))}});m.useEffect(()=>{f&&_(f)},[_,f]),m.useEffect(()=>{if(y)return;(async()=>{t(!0);try{const w=await i.createAdyenPaymentSession(window.origin,!1);g(w)}catch(w){w instanceof Error&&s(w.message)}t(!1)})()},[t,s,y,u,h,i]);const b=m.useCallback(async(P,w)=>{if(P.isValid){try{t(!0),s(void 0);const j=It("payment-method",{paymentMethodId:`${a}`}),S=await i.addAdyenPaymentDetails(P.data.paymentMethod,a,j);"action"in S&&w(S.action),await o.reloadSubscriptions({retry:5}),u(v,{replace:!0})}catch(j){j instanceof Error&&s(j.message)}t(!1)}},[u,a,v,s,t,o,i]),x=m.useMemo(()=>({session:p,showPayButton:!1,environment:c?"test":"live",clientKey:c?Qc:Xc,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async P=>{try{t(!0),await i.finalizeAdyenPayment(P.data.details,a),u(v,{replace:!0})}catch(w){w instanceof Error&&(s(w.message),t(!1))}},onSubmit:(P,w)=>b(P,w.handleAction),onError:P=>s(P.message)}),[p,c,t,a,u,v,s,b,i]);return n.jsx($l,{configuration:x,type:e,error:r})}const vf=({onCloseButtonClick:t})=>{const e=W(vt),s=Le("u")==="payment-method-success",r=Le("paymentMethodId"),a=r?parseInt(r):void 0,i=B(_=>_.activePayment)?.id,[c,l]=m.useState(void 0),[d,u]=m.useState(a),h=ge(_=>_.paymentMethods),[p,g]=m.useState(!1);m.useEffect(()=>{e.getPaymentMethods()},[e]);const f=_=>{const b=parseInt(_.target.value);u(b),l(void 0)},y=async()=>{g(!0);try{l(void 0);const _=It("payment-method-success"),b=It("waiting-for-payment"),x=It("payment-cancelled"),P=It("payment-error"),w=await e.updatePayPalPaymentMethod(_,b,x,P,d,i);w&&(window.location.href=w.redirectUrl)}catch(_){_ instanceof Error&&l(_.message)}g(!1)},v=()=>{const _=h?.find(b=>b.id===d);return _?.methodName==="card"?n.jsx(yf,{paymentMethodId:_.id,setPaymentError:l,setProcessing:g,error:c,type:"card"}):_?.methodName==="paypal"?n.jsx(Ll,{onSubmit:y,error:c||null}):null};return h?n.jsx(mf,{onCloseButtonClick:t,paymentMethods:h,paymentMethodId:d,onPaymentMethodChange:f,renderPaymentMethod:v,updateSuccess:s,submitting:p}):n.jsx("div",{style:{height:300},children:n.jsx(ve,{inline:!0})})},xf="_title_11svw_1",bf="_cancelButton_11svw_7",_c={title:xf,cancelButton:bf},wf=({renderPaymentMethod:t,submitting:e,onCancel:s})=>{const{t:r}=I(["common","user"]);return n.jsxs("div",{children:[n.jsx("div",{className:_c.title,children:n.jsx("h1",{children:r("user:payment.add_card_details")})}),n.jsx("div",{children:t?t():null}),n.jsx(D,{onClick:s,className:_c.cancelButton,fullWidth:!0,label:r("common:confirmation_dialog.close")}),e&&n.jsx(ve,{transparentBackground:!0,inline:!0})]})},Ol=({value:t,onChange:e,error:s,...r})=>{const{t:a}=I("user"),o=i=>{const c=i.target.value.replace(/\D+/g,"");e&&(i.target.value=c.slice(0,4),e(i))};return n.jsx(ae,{label:a("payment.security_code"),"aria-label":a("payment.security_code"),...r,error:!!s,helperText:s||null,name:"cardCVC",className:"directPostSecurityCode",type:"text",value:t,onChange:o,pattern:"\\d*",placeholder:"###",autoComplete:"cc-csc",required:!0})},Ml=({value:t,onChange:e,error:s,...r})=>{const{t:a}=I("account"),o=i=>{let c=i.target.value.replace(/\D+/g,"");c.length===1?Number(c)>1&&(c="0"+c):c.length===2&&Number(c)>12&&(c="12"),c.length>=3?i.target.value=`${c.slice(0,2)}/${c.slice(2,4)}`:i.target.value=c,e&&e(i)};return n.jsx(ae,{label:a("payment.credit_card_expiry_date"),...r,name:"cardExpiry",className:"directPostExpiryDate",value:t,error:!!s,helperText:s||null,onChange:o,type:"text",pattern:"\\d*",placeholder:"MM/YY",autoComplete:"cc-exp",required:!0})},Sf="_cardTypeWrapper_lfmk2_1",jf={cardTypeWrapper:Sf},yc={visa:"/images/payments/visa.svg",mastercard:"/images/payments/mastercard.svg",maestro:"/images/payments/maestro.svg",amex:"/images/payments/amex.svg",discover:"/images/payments/discover.svg",diners:"/images/payments/diners.svg",dinersclub:"/images/payments/diners.svg",unionpay:"/images/payments/unionpay.svg",hiper:"/images/payments/hiper.svg"},Dl=({value:t,error:e,onChange:s,onBlur:r,...a})=>{const{t:o}=I("account"),[i,c]=m.useState(null),l=d=>{const u=ft.fns.cardType(d.target?.value),h=d.target?.value.replace(/\D+/g,"");let p;switch(c(yc?.[u]?n.jsx("div",{className:jf.cardTypeWrapper,children:n.jsx("img",{src:yc[u],alt:u,height:"25"})}):null),u){case"amex":p=`${h.slice(0,4)} ${h.slice(4,10)} ${h.slice(10,15)}`;break;case"dinersclub":p=`${h.slice(0,4)} ${h.slice(4,10)} ${h.slice(10,14)}`;break;default:p=`${h.slice(0,4)} ${h.slice(4,8)} ${h.slice(8,12)} ${h.slice(12,16)}`;break}s&&(d.target.value=p.trim(),s(d))};return n.jsx(ae,{value:t,name:"cardNumber",label:o("payment.credit_card_number"),className:"directPostCreditCardNumber",onChange:l,onBlur:r,error:!!e,helperText:e||null,pattern:"\\d*",...a,type:"text",placeholder:"1234 5678 9012 3456",rightControl:i,autoComplete:"cc-number",required:!0})},Cf="_paymentForm_g66uf_1",Pf="_columns_g66uf_6",vc={paymentForm:Cf,columns:Pf},Ef=({onCancel:t,setUpdatingCardDetails:e})=>{const s=W(ie),r=Fe(),{t:a}=I("account"),{mutate:o,isLoading:i}=it(s.updateCardDetails),{activePayment:c}=B(({activePayment:d})=>({activePayment:d}),Q),l=Lt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:te().shape({cardholderName:R().required(),cardNumber:R().required().test("card number validation",a("checkout.invalid_card_number"),d=>ft.fns.validateCardNumber(d)),cardExpiry:R().required().test("card expiry validation",a("checkout.invalid_card_expiry"),d=>ft.fns.validateCardExpiry(d)),cardCVC:R().required().test("cvc validation",a("checkout.invalid_cvc_number"),d=>{const u=ft.fns.cardType(l?.values?.cardNumber);return ft.fns.validateCardCVC(d,u)}),cardExpMonth:R().required(),cardExpYear:R().required()}),validateOnBlur:!0,onSubmit:async()=>{e(!0),o({cardName:l.values.cardholderName,cardNumber:l.values.cardNumber.replace(/\s+/g,""),cvc:parseInt(l.values.cardCVC),expMonth:parseInt(l.values.cardExpMonth),expYear:parseInt(l.values.cardExpYear),currency:c?.currency||""},{onSettled:()=>t(),onSuccess:()=>{r(a("checkout.card_details_updated"),"success")}})}});return m.useEffect(()=>{if(l.values.cardExpiry){const d=ft.fns.cardExpiryVal(l.values.cardExpiry);d.month&&l.setValue("cardExpMonth",d.month.toString()),d.year&&l.setValue("cardExpYear",d.year.toString())}},[l.values.cardExpiry]),n.jsxs("div",{className:vc.paymentForm,children:[n.jsx("div",{children:n.jsx(ae,{label:a("checkout.card_holder_name"),name:"cardholderName",value:l?.values?.cardholderName,onChange:l?.handleChange,onBlur:l?.handleBlur,placeholder:a("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),n.jsx("div",{children:n.jsx(Dl,{value:l?.values?.cardNumber?.toString(),error:l?.errors?.cardNumber,onBlur:l?.handleBlur,onChange:l?.handleChange})}),n.jsxs("div",{className:vc.columns,children:[n.jsx("div",{children:n.jsx(Ml,{value:l?.values?.cardExpiry,onBlur:l?.handleBlur,onChange:l?.handleChange,error:l?.errors?.cardExpiry})}),n.jsx("div",{children:n.jsx(Ol,{value:l?.values?.cardCVC,onBlur:l?.handleBlur,onChange:l?.handleChange,error:l?.errors?.cardCVC})})]}),n.jsx("div",{children:n.jsx(D,{disabled:i,label:a("checkout.save"),variant:"contained",onClick:l.handleSubmit,type:"submit",color:"primary",size:"large",fullWidth:!0})})]})},kf=()=>{const t=re(),e=se(),[s,r]=m.useState(!1),a=()=>{e(q(t,null),{replace:!1})},o=()=>n.jsx(Ef,{onCancel:a,setUpdatingCardDetails:r});return n.jsx(wf,{onCancel:a,renderPaymentMethod:o,submitting:s})},If="_title_n9dff_1",Nf="_button_n9dff_12",Af="_textField_n9dff_17",Tf="_paragraph_n9dff_21",Lf="_resendLink_n9dff_31",Qs={title:If,button:Nf,textField:Af,paragraph:Tf,resendLink:Lf},$f=({onSubmit:t,onChange:e,onBlur:s,showOldPasswordField:r,showResetTokenField:a,value:o,errors:i,submitting:c,validationError:l,email:d,onResendEmailClick:u})=>{const{t:h}=I(["account","user"]);return n.jsxs("form",{onSubmit:t,"data-testid":void 0,noValidate:!0,children:[i.form&&n.jsx(Ie,{variant:"error",visible:!l,children:i.form}),n.jsx("h2",{className:Qs.title,children:h(r&&a?"user:account.add_password":"reset.password_reset")}),r&&a&&n.jsxs("p",{className:Qs.paragraph,children:[h("user:account.add_password_modal_text",{email:d}),n.jsx("a",{className:Qs.resendLink,onClick:u,children:h("user:account.resend_mail")})]}),r&&!a&&n.jsx(an,{value:o.oldPassword,onChange:e,onBlur:s,label:h("reset.old_password"),placeholder:h("reset.old_password"),error:!!i.oldPassword,name:"oldPassword",showToggleView:!1,showHelperText:!1,autoComplete:"current-password",required:!0}),a&&n.jsx(ae,{className:Qs.textField,value:o.resetPasswordToken||"",onChange:e,onBlur:s,label:h("reset.reset_password_token"),placeholder:h("reset.reset_password_token"),name:"resetPasswordToken",type:"text",autoComplete:"",required:!0}),n.jsx(an,{value:o.password,onChange:e,onBlur:s,label:h("reset.new_password"),placeholder:h("reset.password"),error:!!i.password,name:"password",autoComplete:"new-password",required:!0}),n.jsx(an,{value:o.passwordConfirmation,onChange:e,onBlur:s,label:h("reset.repeat_new_password"),placeholder:h("reset.repeat_new_password"),error:!!i.passwordConfirmation,name:"passwordConfirmation",autoComplete:"new-password",showHelperText:!1,required:!0}),n.jsx(D,{type:"submit",className:Qs.button,fullWidth:!0,color:"primary",disabled:c,label:h("reset.confirm")}),c&&n.jsx(ve,{transparentBackground:!0,inline:!0})]})},xc=({type:t})=>{const e=W(ie),{t:s}=I("account"),r=Fe(),a=re(),o=se(),i=Le("resetPasswordToken"),c=Le("email"),l=B(g=>g.user?.email),d=B.getState().user,u=async(g,{setErrors:f,setSubmitting:y})=>{const{oldPassword:v,password:_,passwordConfirmation:b,resetPasswordToken:x}=g;if(_!==b)return f({form:s("reset.passwords_do_not_match")}),y(!1);const P=x||i;try{let w=a.pathname;if(P)await e.changePasswordWithToken(c||"",_,P,b);else{if(!d)return f({form:s("reset.invalid_link")}),y(!1);w="/",await e.changePasswordWithOldPassword(v||"",_,b),await e.logout()}r(s("reset.password_reset_success"),"success"),o(q({...a,pathname:w},"login"))}catch(w){w instanceof Error&&(w.message.includes("invalid param password")?f({password:s("reset.invalid_password")}):w.message.includes("resetPasswordToken is not valid")?f({form:s("reset.invalid_reset_link")}):w.message.includes("score does not match standards")?f({form:s("reset.password_strength")}):w.message.includes("old password does not match")?f({form:s("reset.old_password_does_not_match")}):w.message.includes("password could not be set")&&f({form:s("reset.invalid_token")}))}y(!1)},h=Lt({initialValues:{password:"",passwordConfirmation:""},validationSchema:te().shape({email:R(),oldPassword:R(),password:R().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,s("registration.invalid_password")).required(s("login.field_required",{field:s("login.password")})),passwordConfirmation:R().required(),resetPasswordToken:R()}),validateOnBlur:!0,onSubmit:u}),p=async()=>{try{l&&await e.resetPassword(l,"")}catch{h.setErrors({form:s("user:account.resend_mail_error")})}};return n.jsx($f,{value:h.values,submitting:h.submitting,onChange:h.handleChange,onBlur:h.handleBlur,errors:h.errors,onSubmit:h.handleSubmit,validationError:h.validationSchemaError,showOldPasswordField:!!(d&&!i),showResetTokenField:t==="add"||!d&&!i,email:c||l,onResendEmailClick:p})},Of="_title_9xp06_1",Mf="_infoBox_9xp06_7",Df="_price_9xp06_23",Rf="_confirmButton_9xp06_32",Xs={title:Of,infoBox:Mf,price:Df,confirmButton:Rf},Ff=({subscription:t,customer:e,error:s,submitting:r,onConfirm:a,onClose:o})=>{const{t:i,i18n:c}=I("account");return n.jsxs("div",{children:[s?n.jsx(Ie,{variant:"error",children:s}):null,n.jsx("h2",{className:Xs.title,children:i("renew_subscription.renew_your_subscription")}),n.jsx("p",{className:Xs.paragraph,children:i("renew_subscription.explanation")}),n.jsxs("div",{className:Xs.infoBox,children:[n.jsxs("p",{children:[n.jsx("strong",{children:t.offerTitle})," ",n.jsx("br",{}),i("renew_subscription.next_billing_date_on",{date:kt(new Date(t.expiresAt*1e3),c.language)})]}),n.jsxs("p",{className:Xs.price,children:[n.jsx("strong",{children:ot(t.nextPaymentPrice,t.nextPaymentCurrency,e.country)}),n.jsxs("small",{children:["/",i(`periods.${t.period}`)]})]})]}),n.jsx(D,{className:Xs.confirmButton,color:"primary",variant:"contained",label:i("renew_subscription.renew_subscription"),onClick:a,fullWidth:!0,disabled:r,type:"submit"}),n.jsx(D,{label:i("renew_subscription.no_thanks"),onClick:o,fullWidth:!0})]})},Bf="_title_1o843_1",bc={title:Bf},Uf=({onClose:t,customer:e,subscription:s})=>{const{t:r,i18n:a}=I("account"),o=kt(new Date(s.expiresAt*1e3),a.language),i=ot(s.nextPaymentPrice,s.nextPaymentCurrency,e.country);return n.jsxs("div",{children:[n.jsx("h2",{className:bc.title,children:r("subscription_renewed.title")}),n.jsx("p",{className:bc.paragraph,children:r("subscription_renewed.message",{date:o,price:i})}),n.jsx(D,{label:r("subscription_renewed.back_to_profile"),onClick:t,fullWidth:!0})]})},Hf=()=>{const t=W(ie),e=se(),s=re(),{t:r}=I("account"),a=Fe(),{subscription:o,user:i}=B(({subscription:y,user:v})=>({subscription:y,user:v}),Q),[c,l]=m.useState(!1),[d,u]=m.useState(!1),[h,p]=m.useState(null),g=async()=>{u(!0),p(null);try{await t.updateSubscription("active"),a(r("renew_subscription.success"),"success"),l(!0)}catch{p(r("renew_subscription.unknown_error_occurred"))}u(!1)},f=()=>{e(q(s,null),{replace:!0})};return!o||!i?null:n.jsxs(he.Fragment,{children:[c?n.jsx(Uf,{onClose:f,subscription:o,customer:i}):n.jsx(Ff,{subscription:o,customer:i,error:h,onConfirm:g,onClose:f,submitting:d}),d?n.jsx(ve,{inline:!0}):null]})},Wf="_title_feuiy_1",Vf="_confirmButton_feuiy_7",dr={title:Wf,confirmButton:Vf},qf=({onConfirm:t,onCancel:e,error:s,submitting:r})=>{const{t:a}=I("account");return n.jsxs("div",{children:[s?n.jsx(Ie,{variant:"error",children:s}):null,n.jsx("h2",{className:dr.title,children:a("cancel_subscription.title")}),n.jsx("p",{className:dr.paragraph,children:a("cancel_subscription.explanation")}),n.jsx(D,{className:dr.confirmButton,label:a("cancel_subscription.unsubscribe"),color:"primary",variant:"contained",onClick:t,fullWidth:!0,disabled:r,type:"submit"}),n.jsx(D,{label:a("cancel_subscription.no_thanks"),variant:"outlined",onClick:e,fullWidth:!0})]})},zf="_title_od1i3_1",ur={title:zf},Gf=({expiresDate:t,onClose:e})=>{const{t:s}=I("account");return n.jsxs("div",{className:ur.SubscriptionCancelled,children:[n.jsx("h2",{className:ur.title,children:s("subscription_cancelled.title")}),n.jsx("p",{className:ur.paragraph,children:s("subscription_cancelled.message",{date:t})}),n.jsx(D,{label:s("subscription_cancelled.return_to_profile"),variant:"outlined",onClick:e,fullWidth:!0})]})},Jf=()=>{const t=W(ie),{t:e,i18n:s}=I("account"),r=Fe(),a=se(),o=re(),i=B(v=>v.subscription),[c,l]=m.useState(!1),[d,u]=m.useState(!1),[h,p]=m.useState(null),g=i?.expiresAt?kt(new Date(i.expiresAt*1e3),s.language):"",f=async()=>{u(!0),p(null);try{await t.updateSubscription("cancelled"),g&&r(e("subscription_cancelled.message",{date:g}),"success"),l(!0)}catch{p(e("cancel_subscription.unknown_error_occurred"))}u(!1)},y=()=>{a(q(o,null),{replace:!0})};return i?n.jsxs(he.Fragment,{children:[c?n.jsx(Gf,{expiresDate:g,onClose:y}):n.jsx(qf,{onConfirm:f,onCancel:y,submitting:d,error:h}),d?n.jsx(ve,{transparentBackground:!0,inline:!0}):null]}):null},Yf="_title_173ks_1",Kf="_text_173ks_7",Qf="_button_173ks_12",hr={title:Yf,text:Kf,button:Qf},Xf=({onCancel:t,onReset:e,submitting:s})=>{const{t:r}=I("account");return n.jsxs("div",{children:[n.jsx("h1",{className:hr.title,children:r("reset.reset_password")}),n.jsx("p",{className:hr.text,children:r("reset.text")}),n.jsx(D,{onClick:e,className:hr.button,fullWidth:!0,color:"primary",label:r("reset.yes"),type:"submit",disabled:s}),n.jsx(D,{onClick:t,fullWidth:!0,label:r("reset.no")})]})},Zf="_title_17xro_1",eg="_text_17xro_7",tg="_button_17xro_12",mr={title:Zf,text:eg,button:tg},sg=({onSubmit:t,onChange:e,value:s,errors:r,submitting:a,onBlur:o})=>{const{t:i}=I("account");return n.jsxs("form",{onSubmit:t,"data-testid":void 0,noValidate:!0,children:[n.jsx("h2",{className:mr.title,children:i("reset.forgot_password")}),r.form?n.jsx(Ie,{variant:"error",children:r.form}):null,n.jsx("p",{className:mr.text,children:i("reset.forgot_text")}),n.jsx(ae,{value:s.email,onChange:e,onBlur:o,label:i("reset.email"),placeholder:i("reset.email"),error:!!r.email||!!r.form,helperText:r.email,name:"email",type:"email",autoComplete:"email",required:!0}),n.jsx(D,{type:"submit",className:mr.button,fullWidth:!0,color:"primary",disabled:a,label:i("reset.email_me")})]})},ng="_title_v7vet_1",rg="_text_v7vet_7",ag="_button_v7vet_12",og="_notSure_v7vet_16",ig="_link_v7vet_20",Ps={title:ng,text:rg,button:ag,notSure:og,link:ig},cg=({email:t,onBackToLogin:e,loggedIn:s})=>{const{t:r}=I("account"),a=re();return n.jsxs("div",{className:Ps.forgotPasswordForm,children:[n.jsx("h2",{className:Ps.title,children:r("reset.link_sent")}),n.jsx("p",{className:Ps.text,children:r("reset.link_sent_text",{email:t})}),n.jsx(D,{onClick:e,className:Ps.button,fullWidth:!0,color:"primary",label:r("reset.back_login")}),!s&&n.jsxs(he.Fragment,{children:[n.jsx("span",{className:Ps.notSure,children:r("reset.not_sure")}),n.jsx(dn,{className:Ps.link,to:q(a,"forgot-password"),children:r("reset.try_again")})]})]})},pr=({type:t})=>{const e=W(ie),{t:s}=I("account"),r=se(),a=re(),[o,i]=m.useState(!1),{canChangePasswordWithOldPassword:c}=e.getFeatures(),{customer:l}=B(({user:f})=>({customer:f}),Q),d=()=>{r(q(a,null))},u=async()=>{r({pathname:"/",search:"u=login"},{replace:!0}),l&&await e.logout()},h=async()=>{const f=`${M.APP_PUBLIC_URL}/?u=edit-password`;try{if(!l?.email){gt("ResetPassword","invalid param email");return}i(!0),await e.resetPassword(l.email,f),i(!1),r(q(a,"send-confirmation"))}catch(y){Pe("ResetPassword","Failed to reset password",{error:y})}},p=async(f,{setErrors:y,setSubmitting:v})=>{const _=`${M.APP_PUBLIC_URL}/?u=edit-password`;try{await e.resetPassword(f.email,_),r(q(a,c?"edit-password":"send-confirmation"))}catch(b){b instanceof Error&&(b.message.toLowerCase().includes("invalid param email")?y({email:s("reset.wrong_email")}):y({form:b.message}))}v(!1)},g=Lt({initialValues:{email:""},validationSchema:te().shape({email:R().email(s("login.field_is_not_valid_email")).required(s("login.field_required",{field:s("login.email")}))}),validateOnBlur:!0,onSubmit:p});return n.jsxs(he.Fragment,{children:[t==="reset"&&n.jsx(Xf,{submitting:o,onCancel:d,onReset:h}),t==="forgot"&&n.jsx(sg,{value:g.values,submitting:g.submitting,onChange:g.handleChange,errors:g.errors,onSubmit:g.handleSubmit,onBlur:g.handleBlur}),t==="confirmation"&&n.jsx(cg,{loggedIn:!!l,email:l?.email||g.values.email,onBackToLogin:u}),(g.submitting||o)&&n.jsx(ve,{transparentBackground:!0,inline:!0})]})},lg=({onUpdateOrderSuccess:t,onSubmitPaymentWithoutDetailsSuccess:e,onSubmitPaypalPaymentSuccess:s,onSubmitStripePaymentSuccess:r})=>{const a=W(ie),o=W(vt),{order:i,selectedOffer:c,paymentMethods:l,setOrder:d}=ge(({order:_,selectedOffer:b,paymentMethods:x,setOrder:P})=>({order:_,selectedOffer:b,paymentMethods:x,setOrder:P})),u=c&&fa(c)?"svod":"tvod",h=it({mutationKey:["initialiseOrder"],mutationFn:async({offer:_})=>!!_&&o.initialiseOrder(_)}),p=it({mutationKey:["updateOrder"],mutationFn:async({paymentMethodId:_,couponCode:b})=>{if(!(!i||!_))return await o.updateOrder(i,_,b)},onSuccess:t}),g=it({mutationKey:["submitPaymentWithoutDetails"],mutationFn:o.paymentWithoutDetails,onSuccess:async()=>{await a.reloadSubscriptions({retry:10}),e()}}),f=it({mutationKey:["submitPaymentPaypal"],mutationFn:o.paypalPayment,onSuccess:s}),y=it({mutationKey:["submitPaymentStripe"],mutationFn:o.directPostCardPayment,onSuccess:r});m.useEffect(()=>{c&&!i&&!h.isLoading&&!h.isError&&h.mutate({offer:c})},[c,i,h]),m.useEffect(()=>()=>d(null),[d]);const v=h.isLoading||p.isLoading||g.isLoading||f.isLoading||y.isLoading;return{selectedOffer:c,offerType:u,paymentMethods:l,order:i,isSubmitting:v,updateOrder:p,submitPaymentWithoutDetails:g,submitPaymentPaypal:f,submitPaymentStripe:y}},Rl=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})),dg="_dialogBackButton_1pa6f_1",ug={dialogBackButton:dg},Fl=({onClick:t})=>{const{t:e}=I();return n.jsx(Re,{onClick:t,className:ug.dialogBackButton,"aria-label":e("common:back"),children:n.jsx(V,{icon:Rl})})},hg="_captcha_en6i1_1",mg={captcha:hg},Bl=m.forwardRef(({siteKey:t,size:e},s)=>(m.useEffect(()=>{const r=new MutationObserver(()=>{const a=document.querySelector('iframe[src^="https://www.google.com/recaptcha"][src*="bframe"]');a?.parentNode?.parentNode&&(r.disconnect(),document.querySelector("#grecaptcha-challenge-container")?.appendChild(a?.parentNode?.parentNode))});r.observe(document.documentElement||document.body,{childList:!0,subtree:!0})},[]),n.jsxs("div",{className:mg.captcha,children:[n.jsx(Zd,{ref:s,sitekey:t,size:e,badge:"inline",theme:"dark"}),n.jsx("div",{id:"grecaptcha-challenge-container"})]}))),pg="_title_1xlk4_7",fg="_order_1xlk4_13",gg="_orderTitle_1xlk4_22",_g="_orderTitleMargin_1xlk4_28",yg="_orderBillingDate_1xlk4_32",vg="_orderInfo_1xlk4_37",xg="_orderPrice_1xlk4_41",bg="_couponForm_1xlk4_54",wg="_redeemCoupon_1xlk4_59",Sg="_couponInput_1xlk4_66",jg="_orderTotals_1xlk4_84",Cg="_couponCell_1xlk4_96",Pg="_divider_1xlk4_113",Eg="_paymentMethods_1xlk4_118",kg="_paymentMethod_1xlk4_118",Ig="_paymentMethodLabel_1xlk4_127",Ng="_radio_1xlk4_135",we={title:pg,order:fg,orderTitle:gg,orderTitleMargin:_g,orderBillingDate:yg,orderInfo:vg,orderPrice:xg,couponForm:bg,redeemCoupon:wg,couponInput:Sg,orderTotals:jg,couponCell:Cg,divider:Pg,paymentMethods:Eg,paymentMethod:kg,paymentMethodLabel:Ig,radio:Ng},Ag=({paymentMethodId:t,paymentMethods:e,order:s,offer:r,offerType:a,onBackButtonClick:o,onPaymentMethodChange:i,error:c,couponFormOpen:l,couponInputValue:d,couponFormError:u,couponFormApplied:h,couponFormSubmitting:p,onCouponInputChange:g,onCloseCouponFormClick:f,onCouponFormSubmit:y,onRedeemCouponButtonClick:v,children:_,submitting:b,captchaSiteKey:x,recaptchaRef:P})=>{const{t:w}=I("account"),j=()=>r?w(`periods.${r.period}`):"",S=T=>{if(T.freeDays)return w("checkout.days_trial",{count:T.freeDays});if(T.freePeriods){const $=w(`periods.${T.period}`,{count:T.freePeriods});return w("checkout.periods_trial",{count:T.freePeriods,period:$})}return null},C=e?.find(T=>T.methodName==="card"),E=e?.find(T=>T.methodName==="paypal"),A=a==="svod"?r.period==="month"?w("checkout.monthly"):w("checkout.yearly"):r.offerTitle;return n.jsxs("div",{children:[c?n.jsx(Ie,{variant:"error",children:c}):null,n.jsx("h1",{className:we.title,children:w("checkout.payment_method")}),n.jsxs("div",{className:we.order,children:[n.jsxs("div",{className:we.orderInfo,children:[n.jsx("p",{className:L(we.orderTitle,{[we.orderTitleMargin]:a==="svod"}),children:A}),s.discount?.type==="trial"?n.jsx("p",{className:we.orderBillingDate,children:S(r)}):null]}),n.jsxs("div",{className:we.orderPrice,children:[n.jsx("span",{children:ot(r.customerPriceInclTax,s.currency,r.customerCountry)}),a==="svod"&&n.jsxs("small",{children:["/",j()]})]})]}),n.jsx("div",{className:we.couponForm,children:l?n.jsxs("form",{onSubmit:y,noValidate:!0,children:[n.jsxs("div",{className:we.redeemCoupon,children:[n.jsx(Re,{"aria-label":"Close coupon form",onClick:f,children:n.jsx(V,{icon:Zn})}),n.jsx("input",{className:we.couponInput,name:"couponCode",type:"text",placeholder:"Coupon code",value:d,onChange:g}),n.jsx(D,{variant:"outlined",label:"Apply",type:"submit",disabled:p})]}),u?n.jsx(Ie,{variant:"error",children:u}):null,h?n.jsx(Ie,{variant:"success",children:w("checkout.coupon_applied")}):null]}):n.jsx(D,{variant:"outlined",label:w("checkout.redeem_coupon"),onClick:v})}),n.jsx("div",{children:n.jsxs("table",{className:we.orderTotals,children:[n.jsxs("tbody",{children:[s.discount?.applied&&s.discount?.type==="coupon"?n.jsxs("tr",{children:[n.jsxs("td",{className:we.couponCell,children:[w("checkout.coupon_discount"),n.jsx("br",{}),!!r.period&&a==="svod"&&n.jsx("small",{children:w("checkout.discount_period",{count:s.discount?.periods,period:w(`periods.${r.period}`,{count:s.discount?.periods})})})]}),n.jsx("td",{children:ot(-s.priceBreakdown.discountAmount*(1+s.taxRate),s.currency,r.customerCountry)})]}):null,s.discount?.applied&&s.discount?.type==="trial"?n.jsxs("tr",{children:[n.jsx("td",{className:we.couponCell,children:w("checkout.free_trial_discount")}),n.jsx("td",{children:ot(-r.customerPriceInclTax,s.currency,r.customerCountry)})]}):null,s.priceBreakdown.paymentMethodFee>0&&n.jsxs("tr",{children:[n.jsx("td",{children:w("checkout.payment_method_fee")}),n.jsx("td",{children:ot(s.priceBreakdown.paymentMethodFee,s.currency,r.customerCountry)})]})]}),n.jsxs("tfoot",{children:[n.jsxs("tr",{children:[n.jsx("td",{children:w("checkout.total_price")}),n.jsx("td",{children:ot(s.totalPrice,s.currency,r.customerCountry)})]}),s.priceBreakdown.taxValue>0&&n.jsxs("tr",{children:[n.jsx("td",{children:w("checkout.applicable_tax",{taxRate:Math.round(s.taxRate*100)})}),n.jsx("td",{children:ot(s.priceBreakdown.taxValue,s.currency,r.customerCountry)})]})]})]})}),!!x&&n.jsx(Bl,{siteKey:x,ref:P}),n.jsx("hr",{className:we.divider}),s.requiredPaymentDetails?n.jsxs("div",{className:we.paymentMethods,children:[C?n.jsxs("div",{className:we.paymentMethod,children:[n.jsx("input",{className:we.radio,type:"radio",name:"paymentMethodId",value:C.id,id:"card",checked:t===C.id.toString(),onChange:i}),n.jsxs("label",{className:we.paymentMethodLabel,htmlFor:"card",children:[n.jsx(V,{icon:Tl})," ",w("checkout.credit_card")]})]}):null,E?n.jsxs("div",{className:we.paymentMethod,children:[n.jsx("input",{className:we.radio,type:"radio",name:"paymentMethodId",value:E.id,id:"paypal",checked:t===E.id.toString(),onChange:i}),n.jsxs("label",{className:we.paymentMethodLabel,htmlFor:"paypal",children:[n.jsx(V,{icon:wa})," ",w("checkout.paypal")]})]}):null]}):null,_?n.jsx("div",{children:_}):null,b&&n.jsx(ve,{transparentBackground:!0,inline:!0}),n.jsx(Fl,{onClick:o})]})},Tg="_noPaymentRequired_170kq_1",Lg={noPaymentRequired:Tg},$g=({onSubmit:t,error:e})=>{const{t:s}=I("account");return n.jsxs("div",{className:Lg.noPaymentRequired,children:[e?n.jsx(Ie,{variant:"error",children:e}):null,n.jsx("p",{children:s("checkout.no_payment_needed")}),n.jsx(D,{label:s("checkout.continue"),variant:"contained",color:"primary",size:"large",onClick:t,fullWidth:!0})]})},Og="_paymentForm_1nfvx_1",Mg="_columns_1nfvx_6",Dg="_formError_1nfvx_13",fr={paymentForm:Og,columns:Mg,formError:Dg},Rg=({onPaymentFormSubmit:t})=>{const{t:e}=I("account"),{values:s,errors:r,setValue:a,handleChange:o,handleBlur:i,handleSubmit:c}=Lt({initialValues:{cardholderName:"",cardNumber:"",cardExpiry:"",cardCVC:"",cardExpMonth:"",cardExpYear:""},validationSchema:te().required().shape({cardholderName:R().required(),cardNumber:R().required().test("card number validation",e("checkout.invalid_card_number"),l=>ft.fns.validateCardNumber(l)),cardExpiry:R().required().test("card expiry validation",e("checkout.invalid_card_expiry"),l=>ft.fns.validateCardExpiry(l)),cardCVC:R().required().test("cvc validation",e("checkout.invalid_cvc_number"),(l,d)=>{const u=ft.fns.cardType(d.parent.cardNumber);return ft.fns.validateCardCVC(l,u)}),cardExpMonth:R().required(),cardExpYear:R().required()}),validateOnBlur:!0,onSubmit:t});return m.useEffect(()=>{if(s.cardExpiry){const l=ft.fns.cardExpiryVal(s.cardExpiry);l.month&&a("cardExpMonth",l.month.toString()),l.year&&a("cardExpYear",l.year.toString())}},[s.cardExpiry]),n.jsx("div",{className:fr.paymentForm,children:n.jsxs("form",{onSubmit:c,"data-testid":void 0,noValidate:!0,children:[r.form?n.jsx("div",{className:fr.formError,children:n.jsx(Ie,{variant:"error",children:r.form})}):null,n.jsx("div",{children:n.jsx(ae,{label:e("checkout.card_holder_name"),name:"cardholderName",value:s.cardholderName,onChange:o,onBlur:i,placeholder:e("checkout.credit_card_name"),autoComplete:"cc-name",required:!0})}),n.jsx("div",{children:n.jsx(Dl,{value:s.cardNumber.toString(),error:r.cardNumber,onBlur:i,onChange:o})}),n.jsxs("div",{className:fr.columns,children:[n.jsx("div",{children:n.jsx(Ml,{value:s.cardExpiry,onBlur:i,onChange:o,error:r.cardExpiry})}),n.jsx("div",{children:n.jsx(Ol,{value:s.cardCVC,onBlur:i,onChange:o,error:r.cardCVC})})]}),n.jsx("div",{children:n.jsx(D,{label:e("checkout.continue"),variant:"contained",color:"primary",type:"submit",size:"large",fullWidth:!0})})]})})};function Fg({setUpdatingOrder:t,type:e,paymentSuccessUrl:s,orderId:r,getCaptchaValue:a}){const o=W(ie),i=W(vt),{t:c}=I(["account","error"]),l=Fe(),[d,u]=m.useState(),[h,p]=m.useState(),g=o.getSandbox(),f=se();m.useEffect(()=>{(async()=>{t(!0);try{const b=await i.createAdyenPaymentSession(window.origin);p(b)}catch(b){b instanceof Error&&u(b.message)}t(!1)})()},[t,i]);const y=m.useCallback(async(_,b)=>{if(_.isValid){try{if(t(!0),u(void 0),r===void 0){u(c("error:adyen_order_unknown"));return}const x=await a(),P=ye(window.location.href,{u:"finalize-payment-adyen",orderId:r}),w=await i.initialAdyenPayment(_.data.paymentMethod,P,x);"action"in w&&b(w.action),await o.reloadSubscriptions({retry:10}),l(c("account:checkout.payment_success"),"success"),f(s,{replace:!0})}catch(x){x instanceof Error&&u(x.message)}t(!1)}},[t,r,i,o,l,c,f,s,a]),v=m.useMemo(()=>({session:h,showPayButton:!1,environment:g?"test":"live",clientKey:g?Qc:Xc,paymentMethodsConfiguration:{card:{hasHolderName:!0,holderNameRequired:!0}},onAdditionalDetails:async _=>{try{t(!0);const b=_.data.details;await i.finalizeAdyenPayment(r,b),l(c("account:checkout.payment_success"),"success"),f(s,{replace:!0})}catch(b){b instanceof Error&&(u(b.message),t(!1))}},onSubmit:(_,b)=>y(_,b.handleAction),onError:_=>u(_.message)}),[h,g,t,i,r,l,c,f,s,y]);return n.jsx($l,{configuration:v,type:e,error:d})}const Ul=()=>{const t=m.useRef(null),e=H(({config:r})=>r.custom?.captchaSiteKey?r.custom?.captchaSiteKey:void 0),s=ee(async()=>{if(!(!e||!t.current))return t.current.props.size==="invisible"?await t.current?.executeAsync()||void 0:t.current.getValue()||void 0});return{recaptchaRef:t,captchaSiteKey:e,getCaptchaValue:s}},Bg=()=>{const t=re(),e=se(),[s,r]=m.useState(!1),[a,o]=m.useState(!1),[i,c]=m.useState(!1),{t:l}=I("account"),d=Fe(),u=q(t,"choose-offer"),h=q(t,"welcome"),p=q(t,null),{recaptchaRef:g,captchaSiteKey:f,getCaptchaValue:y}=Ul(),v=()=>e(u),{selectedOffer:_,offerType:b,paymentMethods:x,order:P,isSubmitting:w,updateOrder:j,submitPaymentWithoutDetails:S,submitPaymentPaypal:C,submitPaymentStripe:E}=lg({onUpdateOrderSuccess:()=>!!A&&c(!0),onSubmitPaymentWithoutDetailsSuccess:()=>(d(l("checkout.payment_success"),"success"),e(b==="svod"?h:p,{replace:!0})),onSubmitPaypalPaymentSuccess:({redirectUrl:G})=>{window.location.href=G},onSubmitStripePaymentSuccess:()=>e(q(t,"waiting-for-payment"),{replace:!0})}),{values:{couponCode:A,paymentMethodId:T},setValue:$,submitting:U,errors:F,handleChange:N,handleSubmit:k}=Lt({initialValues:{couponCode:"",paymentMethodId:qr(x)},onSubmit:({couponCode:G,paymentMethodId:be})=>(c(!1),j.mutateAsync({couponCode:G,paymentMethodId:parseInt(be)})),onSubmitSuccess:({couponCode:G})=>c(!!G),onSubmitError:({error:G})=>{G instanceof We&&G.errors.order?.includes(`Order with id ${P?.id} not found`)&&e(q(t,"choose-offer"),{replace:!0})}}),O=G=>{N(G),j.mutateAsync({couponCode:A,paymentMethodId:parseInt(G.target.value)})};if(m.useEffect(()=>{if(!_)return e(u,{replace:!0})},[e,u,_]),m.useEffect(()=>{x?.length&&$("paymentMethodId",qr(x))},[x,$]),m.useEffect(()=>()=>c(!1),[]),!_||!P||!x||!b)return n.jsx("div",{style:{height:300},children:n.jsx(ve,{inline:!0})});const Y=It("payment-cancelled"),ce=It("waiting-for-payment",{offerId:_?.offerId}),ne=It("payment-error"),Te=b==="svod"?ce:ye(window.location.href,{u:""}),ut=window.location.href,Se=x?.find(G=>G.id===parseInt(T)),fe=!P?.requiredPaymentDetails,$e=!fe&&Se?.methodName==="card"&&Se?.provider==="stripe",Oe=!fe&&Se?.methodName==="card"&&Se?.paymentGateway==="adyen",Qe=!fe&&Se?.methodName==="paypal";return n.jsxs(Ag,{order:P,offer:_,offerType:b,error:F.form,onBackButtonClick:v,paymentMethods:x,paymentMethodId:T,onPaymentMethodChange:O,onCouponFormSubmit:k,onCouponInputChange:N,onRedeemCouponButtonClick:()=>o(!0),onCloseCouponFormClick:()=>o(!1),couponInputValue:A,couponFormOpen:a,couponFormApplied:i,couponFormSubmitting:U,couponFormError:F.couponCode,submitting:w||s,captchaSiteKey:f,recaptchaRef:g,children:[fe&&n.jsx($g,{onSubmit:async()=>{const G=await y();return S.mutateAsync({captchaValue:G})},error:S.error?.message||null}),$e&&n.jsx(Rg,{onPaymentFormSubmit:async G=>await E.mutateAsync({cardPaymentPayload:G,referrer:ut,returnUrl:It("finalize-payment-stripe-ppv")})}),Oe&&n.jsx(n.Fragment,{children:n.jsx(Fg,{paymentSuccessUrl:b==="svod"?h:p,setUpdatingOrder:r,orderId:P.id,type:"card",getCaptchaValue:y})}),Qe&&n.jsx(Ll,{onSubmit:async()=>{const G=await y();C.mutate({successUrl:Te,waitingUrl:ce,cancelUrl:Y,errorUrl:ne,couponCode:A,captchaValue:G})},error:C.error?.message||null})]})},Sa=()=>{const t=W(vt),e=W(ie),{mediaOffers:s,subscriptionOffers:r,switchSubscriptionOffers:a,requestedMediaOffers:o}=ge(({mediaOffers:f,subscriptionOffers:y,switchSubscriptionOffers:v,requestedMediaOffers:_})=>({mediaOffers:f,subscriptionOffers:y,switchSubscriptionOffers:v,requestedMediaOffers:_}),Q),{isLoading:i}=qe({queryKey:["initialiseOffers",o],queryFn:t.initialiseOffers}),c=it({mutationKey:["chooseOffer"],mutationFn:t.chooseOffer}),l=it({mutationKey:["switchSubscription"],mutationFn:t.switchSubscription,onSuccess:()=>e.reloadSubscriptions({delay:3e3,retry:10})}),d=s.length>0,u=r.length>0,h=o.some(f=>f.premier),p=(r.length>0||a.length>0)&&d&&!h,g=h||!u?"tvod":"svod";return{isLoading:i||c.isLoading,mediaOffers:s,subscriptionOffers:r,switchSubscriptionOffers:a,chooseOffer:c,switchSubscription:l,hasMultipleOfferTypes:p,defaultOfferType:g}},gr=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"})),Ug="_title_1h3nw_1",Hg="_subtitle_1h3nw_7",Wg="_offerGroupSwitch_1h3nw_13",Vg="_label_1h3nw_19",qg="_offers_1h3nw_24",zg="_offer_1h3nw_13",Gg="_radio_1h3nw_41",Jg="_offerGroupLabel_1h3nw_68",Yg="_offerTitle_1h3nw_80",Kg="_offerDivider_1h3nw_86",Qg="_offerBenefits_1h3nw_93",Xg="_fill_1h3nw_114",Zg="_offerPrice_1h3nw_118",Ne={title:Ug,subtitle:Hg,offerGroupSwitch:Wg,label:Vg,offers:qg,offer:zg,radio:Gg,offerGroupLabel:Jg,offerTitle:Yg,offerDivider:Kg,offerBenefits:Qg,fill:Xg,offerPrice:Zg},e_=({offer:t,selected:e,onChange:s})=>{const{t:r}=I("account"),a=c=>{if(c.freeDays)return r("choose_offer.benefits.first_days_free",{count:c.freeDays});if(c.freePeriods){const l=r(`periods.${c.period}`,{count:c.freePeriods});return r("choose_offer.benefits.first_periods_free",{count:c.freePeriods,period:l})}return null},o=(c,l)=>n.jsxs("li",{children:[n.jsx(V,{icon:l}),c,n.jsx("span",{className:"hidden",children:"."})]}),i=({title:c,periodString:l,secondBenefit:d})=>n.jsxs("div",{className:Ne.offer,"aria-labelledby":`title-${t.offerId}`,children:[n.jsx("input",{className:Ne.radio,onChange:s,type:"radio",name:"selectedOfferId",value:t.offerId,id:t.offerId,checked:e,"data-testid":(t.offerId,void 0)}),n.jsx("div",{className:Ne.label,children:n.jsxs("label",{htmlFor:t.offerId,children:[n.jsx("h2",{className:Ne.offerTitle,id:`title-${t.offerId}`,children:c}),n.jsx("span",{className:"hidden",children:"."}),n.jsx("hr",{className:Ne.offerDivider,"aria-hidden":!0}),n.jsxs("ul",{className:Ne.offerBenefits,children:[t.freeDays||t.freePeriods?o(a(t)||"",gr):null,!!d&&o(d,gr),o(r("choose_offer.benefits.watch_on_all_devices"),gr)]}),n.jsx("div",{className:Ne.fill}),n.jsxs("div",{className:Ne.offerPrice,children:[Rh(t)," ",!!l&&n.jsxs("small",{children:["/",l]})]})]})})]});if(fa(t)){const c=t.period==="month";return i({title:r(c?"choose_offer.monthly":"choose_offer.yearly"),secondBenefit:r("choose_offer.benefits.cancel_anytime"),periodString:r(c?"periods.month":"periods.year")})}return i({title:t.offerTitle,secondBenefit:t.durationPeriod&&t.durationAmount?r("choose_offer.tvod_access",{period:t.durationPeriod,count:t.durationAmount}):void 0})},t_=({values:t,errors:e,submitting:s,offers:r,showOfferTypeSwitch:a,onChange:o,onSubmit:i,onBackButtonClickHandler:c})=>{const l=H(p=>p.config.siteName),{t:d}=I("account"),{selectedOfferType:u,selectedOfferId:h}=t;return n.jsxs("form",{onSubmit:i,"data-testid":void 0,noValidate:!0,children:[c?n.jsx(Fl,{onClick:c}):null,n.jsx("h1",{className:Ne.title,children:d("choose_offer.title")}),n.jsx("p",{className:Ne.subtitle,children:d("choose_offer.watch_this_on_platform",{siteName:l})}),e.form?n.jsx(Ie,{variant:"error",children:e.form}):null,a&&n.jsxs("div",{className:Ne.offerGroupSwitch,children:[n.jsx("input",{className:Ne.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"svod",value:"svod",checked:u==="svod"}),n.jsx("label",{className:L(Ne.label,Ne.offerGroupLabel),htmlFor:"svod",children:d("choose_offer.subscription")}),n.jsx("input",{className:Ne.radio,onChange:o,type:"radio",name:"selectedOfferType",id:"tvod",value:"tvod",checked:u==="tvod"}),n.jsx("label",{className:L(Ne.label,Ne.offerGroupLabel),htmlFor:"tvod",children:d("choose_offer.one_time_only")})]}),n.jsx("div",{className:Ne.offers,children:r.length?r.map(p=>n.jsx(e_,{offer:p,selected:h===p.offerId,onChange:o},p.offerId)):n.jsx("p",{children:d("choose_offer.no_pricing_available")})}),s&&n.jsx(ve,{transparentBackground:!0,inline:!0}),n.jsx(D,{label:d("choose_offer.continue"),disabled:s||!r.length,variant:"contained",color:"primary",type:"submit",fullWidth:!0})]})},wc=()=>{const t=se(),e=re(),{t:s}=I("account"),r=Le("u")==="upgrade-subscription",a=B(({pendingOffer:C})=>({isPendingOffer:!!C})),{isLoading:o,mediaOffers:i,subscriptionOffers:c,switchSubscriptionOffers:l,defaultOfferType:d,hasMultipleOfferTypes:u,chooseOffer:h,switchSubscription:p}=Sa(),g=q(e,"checkout"),f=q(e,"upgrade-subscription-pending"),y=q(e,"upgrade-subscription-success"),v=q(e,"upgrade-subscription-error"),{values:_,errors:b,submitting:x,setValue:P,handleSubmit:w,handleChange:j}=Lt({initialValues:{selectedOfferType:d,selectedOfferId:void 0},validationSchema:te().shape({selectedOfferId:Hn().required(s("choose_offer.field_required")),selectedOfferType:Hn().required(s("choose_offer.field_required"))}),onSubmit:async({selectedOfferType:C,selectedOfferId:E})=>{if(!C||!E)return;const A=S.find(T=>T.offerId===E);if(A&&(await h.mutateAsync(A),r))return await p.mutateAsync()},onSubmitSuccess:async()=>{if(r&&a)return t(f);if(r)return t(y);t(g)},onSubmitError:()=>t(v)}),S=_.selectedOfferType==="tvod"?i:r?l:c;return m.useEffect(()=>{if(o||!S.length)return;const C=S[S.length-1]?.offerId;P("selectedOfferId",C)},[S,_.selectedOfferType,P,o]),m.useEffect(()=>{o||!d||P("selectedOfferType",d)},[o,d,P]),o?n.jsx("div",{style:{height:300},children:n.jsx(ve,{inline:!0})}):n.jsx(t_,{onSubmit:w,onChange:j,values:_,errors:b,submitting:x,offers:S,showOfferTypeSwitch:u})},s_="_container_rhor0_1",n_="_error_rhor0_25",r_="_select_rhor0_31",a_="_disabled_rhor0_38",o_="_option_rhor0_69",Es={container:s_,error:n_,select:r_,disabled:a_,option:o_},Hl=({required:t,className:e,disabled:s,defaultLabel:r,options:a,optionsStyle:o,editing:i=!0,value:c,onChange:l,id:d,name:u,error:h,helperTextId:p,type:g,...f})=>{const y=x=>{if(!i)return x.preventDefault();l?.(x)},v=L(Es.container,{[Es.error]:h,[Es.disabled]:s},e),_={"aria-required":!!t,"aria-invalid":!!(t&&h&&c!==""),"aria-describedby":p},b={id:d,name:u,value:c,disabled:s,className:Es.select,readOnly:!i,required:t,..._,...f};return n.jsx("div",{className:L({[v]:i}),children:n.jsxs("select",{...b,onChange:y,children:[r&&n.jsx("option",{className:L(Es.option,o),value:"",disabled:t,children:r}),a&&a.map(x=>n.jsx("option",{className:L(Es.option,o),value:typeof x=="string"?x:x.value,children:typeof x=="string"?x:x.label},typeof x=="string"?x:x.value))]})})},Wl=({name:t,className:e,label:s,error:r,helperText:a,editing:o=!0,required:i=!1,size:c="medium",testId:l,lang:d,...u})=>n.jsx(fn,{className:e,error:r,helperText:a,label:s,required:i,editing:o,testId:l,name:t,size:c,lang:d,renderInput:h=>n.jsx(Hl,{name:t,required:i,editing:o,error:r,size:c,...h,...u})}),i_="_checkbox_le8eo_1",c_="_error_le8eo_17",l_="_row_le8eo_68",_r={checkbox:i_,error:c_,row:l_},er=({className:t,label:e,checkboxLabel:s,name:r,onChange:a,editing:o=!0,value:i,helperText:c,error:l,required:d,lang:u,size:h,...p})=>{const g=L(_r.checkbox,{[_r.error]:l},t),f=y=>{if(!o)return y.preventDefault();a?.(y)};return n.jsx(fn,{className:g,name:r,label:e,editing:o,required:d,error:l,helperText:c,renderInput:({id:y,helperTextId:v})=>n.jsxs("div",{className:_r.row,children:[n.jsx("input",{name:r,type:"checkbox",id:y,value:i,"aria-required":d,"aria-describedby":v,...p,onChange:f,readOnly:!o}),n.jsxs("label",{htmlFor:y,lang:u,children:[d?n.jsx("span",{role:"presentation","aria-hidden":"true",children:"*"}):"",s]})]})})},d_="_radio_2fdju_1",u_="_error_2fdju_6",Sc={radio:d_,error:u_},Vl=({name:t,onChange:e,label:s,value:r,editing:a=!0,size:o,values:i,helperText:c,error:l,required:d,disabled:u,lang:h,...p})=>{const g=f=>{if(!a)return f.preventDefault();e?.(f)};return n.jsx(fn,{name:t,label:s,error:l,helperText:c,required:d,renderInput:({id:f,helperTextId:y})=>n.jsx("div",{id:f,children:i.map(({value:v,label:_},b)=>n.jsxs("div",{className:L(Sc.radio,{[Sc.error]:l}),lang:h,children:[n.jsx("input",{value:v,name:t,type:"radio",id:f+b,onChange:g,checked:r===v,required:d,disabled:u,"aria-describedby":y,...p}),n.jsx("label",{htmlFor:f+b,children:_})]},b))})})},h_="_container_uoh8f_1",m_="_error_uoh8f_10",p_="_input_uoh8f_16",f_="_dateField_uoh8f_62",g_="_hiddenInput_uoh8f_102",ls={container:h_,error:m_,input:p_,dateField:f_,hiddenInput:g_},__=t=>{if(!t)return null;const e=new Date(t);return isNaN(e.getTime())?null:e},ql=t=>t>0&&t<10?`0${t}`:t.toString(),zl=(t,e,s)=>Math.min(s,Math.max(e,t)),yr=(t,e,s)=>{const r=zl(parseInt(t),e,s);return isNaN(r)?"":t.length>0&&r<10?ql(r):r.toString()},vr=(t,e,s)=>{const r=zl(parseInt(t),e,s);return isNaN(r)?"":t.length>1&&r<10?ql(r):r.toString()},Gl=({className:t,label:e,error:s,helperText:r,value:a,onChange:o,format:i="YYYY-MM-DD",name:c,editing:l,lang:d,required:u,onFocus:h,testId:p})=>{const g=__(a),[f,y]=m.useState({date:g?.getDate().toString()||"",month:g?(g.getMonth()+1).toString():"",year:g?.getFullYear().toString()||""}),v=dt("text-field",c),_=dt("helper_text",c),b=m.useRef(null),x=L(ls.dateField,{[ls.error]:s},t),P=E=>{E.currentTarget.select(),h?.(E)},w=E=>{if(E.key==="Backspace"&&f[E.currentTarget.name]==="")return E.currentTarget.previousElementSibling?.focus(),E.preventDefault();if(!/^[0-9]$/.test(E.key)&&E.key!=="Tab"&&E.key!=="Backspace")return E.preventDefault()},j=E=>{const{name:A,value:T}=E.target;y($=>{const U=A==="date"?yr(T,1,31):$.date,F=A==="month"?yr(T,1,12):$.month,N=A==="year"?yr(T,1900,2100):$.year;return{date:U,month:F,year:N}})},S=(E,A,T)=>{const $=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set,U=E&&A&&T?i.replace("YYYY",T).replace("MM",A).replace("DD",E):"";$?.call(b.current,U);const F=new Event("input",{bubbles:!0});b.current?.dispatchEvent(F)},C=E=>{const{name:A,value:T}=E.target,$=E.currentTarget?.nextElementSibling,U=A==="date"?vr(T,0,31):f.date,F=A==="month"?vr(T,0,12):f.month,N=A==="year"?vr(T,0,2100).slice(0,4):f.year;y({date:U,month:F,year:N}),S(U,F,N),($&&A==="month"&&F.length===2||A==="date"&&U.length===2)&&setTimeout(()=>$.focus(),1)};return n.jsx(fn,{className:x,name:c,helperText:r,error:s,label:e,editing:l,lang:d,required:u,testId:p,renderInput:()=>n.jsxs("div",{className:ls.container,children:[n.jsx("input",{ref:b,id:`${v}-hidden`,className:ls.hiddenInput,name:c,onChange:o,"aria-invalid":s,"aria-describedby":_}),n.jsx("input",{className:ls.input,name:"date",placeholder:"dd",value:f.date,onFocus:P,onBlur:j,onChange:C,onKeyDown:w,maxLength:2,type:"number",id:`${v}-date`,autoComplete:"bday-day"})," / ",n.jsx("input",{className:ls.input,name:"month",placeholder:"mm",value:f.month,onFocus:P,onBlur:j,onChange:C,onKeyDown:w,maxLength:2,type:"number",id:`${v}-month`,autoComplete:"bday-month"})," / ",n.jsx("input",{className:ls.input,name:"year",placeholder:"yyyy",value:f.year,onFocus:P,onBlur:j,onChange:C,onKeyDown:w,maxLength:4,type:"number",id:`${v}-year`,autoComplete:"bday-year"})]})})},y_="_title_a6ei2_1",jc={title:y_,continue:"_continue_a6ei2_7"},v_=({initialValues:t,onSubmit:e,fields:s,questions:r,onQuestionChange:a,questionValues:o,questionErrors:i})=>{const{t:c}=I("account"),{setValue:l,handleSubmit:d,handleChange:u,values:h,errors:p,validationSchemaError:g,submitting:f}=Lt({initialValues:t,onSubmit:e}),y=({value:v,key:_,question:b,required:x,enabled:P})=>{if(!P)return null;const w=v?.split(";").map(S=>{const[C,E=C]=S.split(":");return{value:C,label:E}}),j={name:_,onChange:a,error:!!i[_],helperText:i[_],required:x};return w.length===1&&w[0].value===""?n.jsx(ae,{value:o[_],label:b,...j},_):w.length===1?n.jsx(er,{checked:!!o[_],value:w[0].value,label:b,checkboxLabel:w[0].label,...j},_):w.length===2?n.jsx(Vl,{values:w,value:o[_],label:b,...j},_):w.length>2?n.jsx(Wl,{options:w,value:o[_],label:b,defaultLabel:c("personal_details.select_answer"),...j},_):null};return n.jsxs("form",{onSubmit:d,"data-testid":void 0,noValidate:!0,children:[n.jsx("h2",{className:jc.title,children:c("personal_details.title")}),p.form?n.jsx(Ie,{variant:"error",visible:!g,children:p.form}):null,s.firstNameLastName?.enabled?n.jsxs(he.Fragment,{children:[n.jsx(ae,{value:h.firstName,onChange:u,label:c("personal_details.fist_name"),placeholder:c("personal_details.fist_name"),error:!!p.firstName,helperText:p.firstName,required:s.firstNameLastName.required,name:"firstName",autoComplete:"given-name"}),n.jsx(ae,{value:h.lastName,onChange:u,label:c("personal_details.last_name"),placeholder:c("personal_details.last_name"),error:!!p.lastName,helperText:p.lastName,required:s.firstNameLastName.required,name:"lastName",autoComplete:"family-name"})]}):null,s.companyName?.enabled?n.jsx(ae,{value:h.companyName,onChange:u,label:c("personal_details.company_name"),placeholder:c("personal_details.company_name"),error:!!p.companyName,helperText:p.companyName,required:s.companyName.required,name:"companyName",autoComplete:"organization"}):null,s.address?.enabled?n.jsxs(he.Fragment,{children:[n.jsx(ae,{value:h.address,onChange:u,label:c("personal_details.address"),placeholder:c("personal_details.address"),error:!!p.address,helperText:p.address,required:s.address.required,name:"address",autoComplete:"address-line1"}),n.jsx(ae,{value:h.address2,onChange:u,label:c("personal_details.address2"),placeholder:c("personal_details.address2"),error:!!p.address2,helperText:p.address2,name:"address2",autoComplete:"address-line2"}),n.jsx(ae,{value:h.city,onChange:u,label:c("personal_details.city"),placeholder:c("personal_details.city"),error:!!p.city,helperText:p.city,required:s.address.required,name:"city",autoComplete:"address-level2"}),n.jsx(ae,{value:h.state,onChange:u,label:c("personal_details.state"),placeholder:c("personal_details.state"),error:!!p.state,helperText:p.state,required:s.address.required,name:"state",autoComplete:"address-level1"}),n.jsx(ae,{value:h.postCode,onChange:u,label:c("personal_details.post_code"),placeholder:c("personal_details.post_code"),error:!!p.postCode,helperText:p.postCode,required:s.address.required,name:"postCode",autoComplete:"postal-code"})]}):null,s.phoneNumber?.enabled?n.jsx(ae,{value:h.phoneNumber,onChange:u,label:c("personal_details.phone_number"),placeholder:c("personal_details.phone_number"),error:!!p.phoneNumber,helperText:p.phoneNumber,required:s.phoneNumber.required,name:"phoneNumber"}):null,s.birthDate?.enabled?n.jsx(Gl,{value:h.birthDate,onChange:v=>l("birthDate",v.currentTarget.value),label:c("personal_details.birth_date"),error:!!p.birthDate,helperText:p.birthDate,required:s.birthDate.required,name:"birthDate"}):null,r.map(v=>y(v)),n.jsx(D,{className:jc.continue,type:"submit",label:c("personal_details.continue"),variant:"contained",color:"primary",size:"large",disabled:f,fullWidth:!0}),f&&n.jsx(ve,{transparentBackground:!0,inline:!0})]})},Dt=(t,e)=>t?R().required(e):Hn().notRequired(),x_=()=>{const t=W(ie),e=se(),s=re(),{t:r}=I("account"),a=H(x=>x.accessModel),{data:o,isLoading:i}=qe("captureStatus",t.getCaptureStatus),{mediaOffers:c}=Sa(),l=c.length>0,[d,u]=m.useState({}),[h,p]=m.useState({}),g=m.useMemo(()=>Object.fromEntries(o?.settings.map(x=>[x.key,x])||[]),[o]),f=m.useMemo(()=>o?.settings.filter(x=>!!x.question)||[],[o]),y=m.useCallback(()=>{const x=a===Ae.SVOD||a===Ae.AUTHVOD&&l;e(q(s,x?"choose-offer":"welcome"),{replace:!0})},[e,s,a,l]);m.useEffect(()=>{o&&((!o.isCaptureEnabled||!o.shouldCaptureBeDisplayed)&&y(),f&&u(Object.fromEntries(f.map(x=>[x.key,""]))))},[o,y,f]);const v=m.useMemo(()=>{const[x,P]=(()=>{if(g.firstNameLastName?.enabled){const w=g.firstNameLastName?.answer;return[w?.firstName||"",w?.lastName||""]}return["",""]})();return{firstName:x,lastName:P,birthDate:"",companyName:"",phoneNumber:"",address:"",address2:"",city:"",state:"",postCode:"",country:""}},[g]),_=x=>{const P=x.target.type==="checkbox"&&!x.target.checked?"":x.target.value;u(w=>({...w,[x.target.name]:P}))},b=async(x,{setErrors:P,setSubmitting:w,setValidationSchemaError:j,validate:S})=>{const C=r("personal_details.this_field_is_required"),E=te().shape({firstName:Dt(!!g.firstNameLastName?.required,C),lastName:Dt(!!g.firstNameLastName?.required,C),address1:Dt(!!g.address?.required,C),address2:Dt(!!g.address?.required,C),postCode:Dt(!!g.address?.required,C),state:Dt(!!g.address?.required,C),city:Dt(!!g.address?.required,C),companyName:Dt(!!g.companyName?.required,C),birthDate:g.birthDate?.required?R().required(C).matches(/\d{4}-\d{2}-\d{2}/,r("personal_details.birth_date_not_valid")):Hn().notRequired(),phoneNumber:Dt(!!g.phoneNumber?.required,C)}),A={};if(f.forEach(T=>{T.enabled&&T.required&&!d[T.key]&&(A[T.key]=r("personal_details.this_field_is_required"))}),p(A),!S(E)||Object.keys(A).length){w(!1),j(!0);return}try{const T=U=>Object.fromEntries(Object.keys(U).filter(F=>U[F]!=="").map(F=>[F,U[F]])),$=f.map(U=>({question:U.question,questionId:U.key,value:d[U.key]}));await t.updateCaptureAnswers(T({...x,customAnswers:$})),y()}catch(T){T instanceof Error&&P({form:T.message})}w(!1)};return i?n.jsx("div",{style:{height:400},children:n.jsx(ve,{inline:!0})}):n.jsx(v_,{initialValues:v,fields:g,questions:f,onQuestionChange:_,questionValues:d,questionErrors:h,onSubmit:b})};function Jl(t){const e=W(ie),{data:s,error:r}=qe(["socialUrls",t],()=>e.getSocialLoginUrls(t),{enabled:e.getFeatures().hasSocialURLs,retry:!1}),a=m.useMemo(()=>s?s.reduce((o,i)=>({...o,...i}),{}):null,[s]);return r||!a?null:a}const Yl=({type:t,value:e="",label:s,options:r,editing:a,lang:o,...i})=>{const{t:c,i18n:l}=I(),d=m.useMemo(()=>t&&["country","us_state"].includes(t)?Object.keys(l.getResourceBundle(l.language,t)).map(h=>({value:h,label:c(`${t}:${h}`)})):r?Object.entries(r).map(([u,h])=>({value:u,label:h})):[],[t,r,l,c]);switch(t){case"input":return n.jsx(ae,{...i,value:String(e),label:s,testId:void 0});case"radio":return n.jsx(Vl,{...i,label:s,values:d,value:String(e),"data-testid":void 0,lang:o});case"select":case"country":case"us_state":return n.jsx(Wl,{...i,options:d,value:String(e),label:s,defaultLabel:i.placeholder,testId:void 0,lang:o});case"datepicker":return n.jsx(Gl,{...i,value:String(e),label:s,testId:void 0});default:return n.jsx(er,{...i,checkboxLabel:s,checked:ns(e),"data-testid":void 0,lang:o})}},b_="_link_1nyb9_1",w_={link:b_},ln=({to:t,href:e,children:s,className:r,onClick:a,target:o,...i})=>{const c=L(w_.link,r);return t?n.jsx(dn,{to:t,className:c,onClick:a,...i,children:s}):n.jsx("a",{href:e,className:c,onClick:a,target:o,rel:o==="_blank"?"noreferrer":void 0,...i,children:s})},S_="_title_io7pr_1",j_="_bottom_io7pr_11",C_="_customFields_io7pr_27",Nn={title:S_,continue:"_continue_io7pr_7",bottom:j_,customFields:C_},P_=({onSubmit:t,onChange:e,onBlur:s,values:r,errors:a,submitting:o,validationError:i,loading:c,publisherConsents:l,consentValues:d,onConsentChange:u,consentErrors:h,captchaSiteKey:p,recaptchaRef:g})=>{const{t:f,i18n:y}=I("account"),v=re(),{isActive:_,consent:b}=kl(),x=m.useRef(null),P=y.language!==M.APP_DEFAULT_LANGUAGE?M.APP_DEFAULT_LANGUAGE:void 0,w=E=>{const A=ea.sanitize(E),T=/<a(.|\n)*?>/.test(A),$=/<\/a(.|\n)*?>/.test(A);return T&&$?n.jsx("span",{dangerouslySetInnerHTML:{__html:E}}):E};m.useEffect(()=>{a.form&&x.current?.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},[a.form]);const j=l?.filter(({type:E,required:A})=>E==="checkbox"&&A).every(({name:E})=>!!d[E]),C=!!p&&(_&&b==="accepted"||j);return n.jsxs("form",{onSubmit:t,"data-testid":void 0,noValidate:!0,children:[n.jsx("div",{ref:x,children:a.form?n.jsx(Ie,{variant:"error",visible:!i,children:a.form}):null}),n.jsx("h2",{className:Nn.title,children:f("registration.sign_up")}),n.jsx(ae,{value:r.email,onChange:e,onBlur:s,label:f("registration.email"),placeholder:f("registration.email"),error:!!a.email,helperText:a.email,name:"email",type:"email",autoComplete:"email",required:!0}),n.jsx(an,{value:r.password,onChange:e,onBlur:s,label:f("registration.password"),placeholder:f("registration.password"),error:!!a.password,name:"password",autoComplete:"new-password",required:!0}),l&&n.jsx("div",{className:Nn.customFields,"data-testid":"custom-reg-fields",children:l.map(E=>{const A=h.find(T=>T===E.name);return n.jsx(Yl,{type:E.type,name:E.name,options:E.options,label:w(E.label),placeholder:E.placeholder,value:d[E.name]||"",required:E.required,error:!!A,helperText:A?f("registration.field_required"):void 0,onChange:u,lang:P},E.name)})}),C&&n.jsx(Bl,{siteKey:p,ref:g,size:b==="accepted"?"invisible":"normal"}),n.jsx(D,{className:Nn.continue,type:"submit",label:f("registration.continue"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),n.jsxs("p",{className:Nn.bottom,children:[f("registration.already_account")," ",n.jsx(ln,{to:q(v,"login"),children:f("login.sign_in")})]}),(c||o)&&n.jsx(ve,{transparentBackground:!0,inline:!0})]})},E_=()=>{const t=W(ie),e=se(),s=re(),{t:r}=I("account"),a=Fe(),[o,i]=m.useState({}),[c,l]=m.useState([]),{publisherConsents:d,publisherConsentsLoading:u,loading:h}=B(({publisherConsents:C,publisherConsentsLoading:E,loading:A})=>({publisherConsents:C,publisherConsentsLoading:E,loading:A})),{recaptchaRef:p,captchaSiteKey:g,getCaptchaValue:f}=Ul(),y=({currentTarget:C})=>{if(!C)return;const{name:E,type:A}=C,T=A==="checkbox"?C.checked:C.value;i($=>({...$,[E]:T})),l($=>$.filter(U=>U!==E))};m.useEffect(()=>{if(!d){t.getPublisherConsents();return}i(Ah(d))},[t,d]);const v=Jl(It("personal-details")),{handleSubmit:_,handleChange:b,handleBlur:x,values:P,errors:w,validationSchemaError:j,submitting:S}=Lt({initialValues:{email:"",password:""},validationSchema:te().shape({email:R().email(r("registration.field_is_not_valid_email")).required(r("registration.field_required",{field:r("registration.email")})),password:R().matches(/^(?=.*[a-z])(?=.*[0-9]).{8,}$/,r("registration.invalid_password",{field:r("registration.password")})).required(r("registration.field_required",{field:r("registration.password")})),captchaValue:R().notRequired()}),validateOnBlur:!0,onSubmit:async({email:C,password:E})=>{const{consentsErrors:A}=Th(d||[],o);if(A.length)throw l(A),new Error(r("registration.consents_error"));const T=await f();await t.register(C,E,window.location.href,Bn(d,o),T)},onSubmitSuccess:()=>{a(r("registration.success"),"success"),e(q(s,"personal-details"))}});return n.jsx(P_,{onSubmit:_,onChange:b,onConsentChange:y,onBlur:x,values:P,errors:w,consentErrors:c,validationError:j,submitting:S,consentValues:o,publisherConsents:d,loading:h||u,socialLoginURLs:v,captchaSiteKey:g,recaptchaRef:p})},k_="_title_8jji7_1",I_="_link_8jji7_7",N_="_bottom_8jji7_11",xr={title:k_,link:I_,bottom:N_},A_=({onSubmit:t,onChange:e,values:s,errors:r,validationError:a,submitting:o,siteName:i})=>{const[c,l]=va(),{t:d}=I("account"),u=re();return n.jsxs("form",{onSubmit:t,"data-testid":void 0,noValidate:!0,children:[r.form?n.jsx(Ie,{variant:"error",visible:!a,children:r.form}):null,n.jsx("h2",{className:xr.title,children:d("login.sign_in")}),n.jsx(ae,{value:s.email,onChange:e,label:d("login.email"),placeholder:d("login.email"),error:!!r.email,helperText:r.email,name:"email",type:"email",required:!0,testId:"login-email-input",autoComplete:"email"}),n.jsx(ae,{value:s.password,onChange:e,label:d("login.password"),placeholder:d("login.password"),error:!!r.password,helperText:r.password,name:"password",type:c?"text":"password",rightControl:n.jsx(Re,{"aria-label":d("login.view_password"),onClick:()=>l(),"aria-pressed":c,children:n.jsx(V,{icon:c?xa:ba})}),required:!0,testId:"login-password-input",autoComplete:"current-password"}),o&&n.jsx(ve,{transparentBackground:!0,inline:!0}),n.jsx(ln,{className:xr.link,to:q(u,"forgot-password"),children:d("login.forgot_password")}),n.jsx(D,{type:"submit",label:d("login.sign_in"),variant:"contained",color:"primary",size:"large",disabled:o,fullWidth:!0}),n.jsxs("p",{className:xr.bottom,children:[d("login.not_registered",{siteName:i})," ",n.jsx(ln,{to:q(u,"create-account"),children:d("login.sign_up")})]})]})},T_=()=>{const t=W(ie),{siteName:e}=H(g=>g.config),s=se(),r=re(),{t:a}=I("account"),o=Fe(),i=Jl(window.location.href.split("?")[0]),{values:c,errors:l,submitting:d,validationSchemaError:u,handleSubmit:h,handleChange:p}=Lt({initialValues:{email:"",password:""},validationSchema:te().shape({email:R().email(a("login.field_is_not_valid_email")).required(a("login.field_required",{field:a("login.email")})),password:R().required(a("login.field_required",{field:a("login.password")}))}),onSubmit:({email:g,password:f})=>t.login(g,f,window.location.href),onSubmitSuccess:()=>{o(a("login.sign_in_success"),"success"),s(q(r,null))},onSubmitError:({resetValue:g})=>g("password")});return n.jsx(A_,{values:c,validationError:u,errors:l,submitting:d,siteName:e,socialLoginURLs:i,onSubmit:h,onChange:p})},L_="_banner_ygdsu_1",$_={banner:L_},O_=["login","create-account","forgot-password","reset-password","send-confirmation","edit-password"],M_=()=>{const t=se(),e=re(),s=Le("u"),r=m.useRef(s),a=Le("message"),{loading:o,user:i}=B(({loading:_,user:b})=>({loading:_,user:b}),Q),c=H(_=>_.config),{assets:{banner:l},siteName:d}=c,u=s&&O_.includes(s),h=ee(()=>{t(q(e,"login"))}),p=m.useMemo(()=>(s&&(r.current=s),r.current),[s]);m.useEffect(()=>{s&&!o&&!i&&!u&&h()},[s,o,u,i,h]);const g=ee(()=>{t(Il(e,{u:null,message:null}))}),f=()=>{if(!i&&o&&!u)return n.jsx("div",{style:{height:300},children:n.jsx(ve,{inline:!0})});switch(p){case"login":return n.jsx(T_,{});case"create-account":return n.jsx(E_,{});case"personal-details":return n.jsx(x_,{});case"choose-offer":return n.jsx(wc,{});case"edit-card":return n.jsx(kf,{});case"upgrade-subscription":return n.jsx(wc,{});case"upgrade-subscription-error":return n.jsx(lr,{type:"error",onCloseButtonClick:g});case"upgrade-subscription-success":return n.jsx(lr,{type:"success",onCloseButtonClick:g});case"upgrade-subscription-pending":return n.jsx(lr,{type:"pending",onCloseButtonClick:g});case"checkout":return n.jsx(Bg,{});case"payment-error":return n.jsx(cc,{type:"error",message:a,onCloseButtonClick:g});case"payment-cancelled":return n.jsx(cc,{type:"cancelled",message:a,onCloseButtonClick:g});case"welcome":return n.jsx(sp,{onCloseButtonClick:g,onCountdownCompleted:g,siteName:d});case"reset-password":return n.jsx(pr,{type:"reset"});case"forgot-password":return n.jsx(pr,{type:"forgot"});case"add-password":return n.jsx(xc,{type:"add"});case"delete-account":case"delete-account-confirmation":return n.jsx(Hp,{});case"warning-account-deletion":return n.jsx(af,{});case"send-confirmation":return n.jsx(pr,{type:"confirmation"});case"edit-password":return n.jsx(xc,{});case"unsubscribe":return n.jsx(Jf,{});case"renew-subscription":return n.jsx(Hf,{});case"payment-method":case"payment-method-success":return n.jsx(vf,{onCloseButtonClick:g});case"waiting-for-payment":return n.jsx(Kp,{});case"finalize-payment-adyen":return n.jsx(pc,{type:"adyen"});case"finalize-payment-stripe-ppv":return n.jsx(pc,{type:"stripe"})}},y=!["delete-account","delete-account-confirmation","edit-card","warning-account-deletion"].includes(p??""),v=["delete-account-confirmation"].includes(p??"")?"large":"small";return n.jsxs(ya,{size:v,open:!!s,onClose:g,children:[y&&l&&n.jsx("div",{className:$_.banner,children:n.jsx("img",{src:l,alt:""})}),f()]})},D_={jwpAuth:{id:"9qqwmnbx",label:"JWP AUTHVOD"},jwpSvod:{id:"a2kbjdv0",label:"JWP SVOD"},jwpAuthNoWatchlist:{id:"oqrsyxin",label:"JWP Authvod (No WL)"},basicNoAuth:{id:"gnnuzabk",label:"Demo App (No Auth)"},noStyling:{id:"kujzeu1b",label:"No Styling (No Auth)"},inlinePlayer:{id:"ata6ucb8",label:"Inline Player"},cleengAuthvod:{id:"nvqkufhy",label:"Cleeng Authvod"},cleengAuthvodNoWatchlist:{id:"7weyqrua",label:"Cleeng Authvod (No WL)"},svod:{id:"ozylzc5m",label:"Cleeng SVOD"}},R_=D_;[...Object.values(R_).map(({id:t,label:e})=>({value:t,label:`${t.length>8?"ext-json":t} - ${e}`}))];const F_=(t,e)=>{const s=W(Kn),r=ta(),{i18n:a}=I(),o=()=>r.invalidateQueries({queryKey:["entitlements"]}),{data:i,isLoading:c,error:l,isSuccess:d,refetch:u}=qe("config-init",()=>s.initializeApp(t,a.language,o),{refetchInterval:!1,retry:1,onSettled:h=>{gt("Bootstrap","Initialized application",{...h}),e(h?.config)},cacheTime:gs,staleTime:_s});return{data:i,isLoading:c,error:l,isSuccess:d,refetch:u}},B_=t=>{const e=document.querySelector(":root"),{highlightColor:s,backgroundColor:r,headerBackground:a}=t.styling||{},o=M.APP_BODY_FONT,i=M.APP_BODY_ALT_FONT;if(e){if(e.style.setProperty("--highlight-color",s||"#fff"),e.style.setProperty("--highlight-contrast-color",s?Cn(s):"#000"),a&&(e.style.setProperty("--header-background",a),e.style.setProperty("--header-contrast-color",Cn(a))),r){const c=Cn(r);e.style.setProperty("--body-background-color",r),e.style.setProperty("--body-color",c),e.style.setProperty("--cookie-banner-background-color",Cn(r)),e.style.setProperty("--cookie-banner-color",r),c==="#000000"&&(e.style.setProperty("--body-text-shadow","none"),e.style.setProperty("--hero-shelf-background-color","#1f1f1f"),e.style.setProperty("--epg-background-color","#262626"))}o&&e.style.setProperty("--body-font-family",o),i&&e.style.setProperty("--body-alt-font-family",i)}},Ee=ys("UIStore",()=>({searchQuery:"",searchActive:!1,userMenuOpen:!1,sideBarOpen:!1,languageMenuOpen:!1,cookieWallOpen:!1})),U_="_title_gkrmh_1",H_="_body_gkrmh_8",W_="_confirmButton_gkrmh_12",br={title:U_,body:H_,confirmButton:W_},V_=({open:t,title:e,body:s,onConfirm:r,onClose:a,busy:o})=>{const{t:i}=I("common");return n.jsxs(ya,{open:t,onClose:a,role:"alertdialog",children:[n.jsx("h2",{className:br.title,children:e}),n.jsx("p",{className:br.body,children:s}),n.jsx(D,{className:br.confirmButton,label:i("confirmation_dialog.confirm"),variant:"contained",color:o?"default":"primary",onClick:r,fullWidth:!0,disabled:o,busy:o}),n.jsx(D,{label:i("confirmation_dialog.close"),variant:"outlined",onClick:a,fullWidth:!0,disabled:o})]})},q_=()=>{const t=eu();return n.jsx(Ke,{error:t})},z_="_markdown_hxhg7_1",G_="_inline_hxhg7_62",Cc={markdown:z_,inline:G_},J_=new tu,Y_={link({href:t,title:e,tokens:s}){const r=this.parser.parseInline(s),a=/^(https?|www\.|\/\/)/.test(t||""),o=a?'target="_blank"':void 0,i=a?'rel="noopener"':void 0,c=e?`title="${e}"`:void 0,l=[o,i,c].filter(Boolean);return`<a href="${t}" ${l.join(" ")}>${r}</a>`},image(t){return this.options.gfm?J_.image(t):""}};Ur.use({renderer:Y_});const K_=(t,e)=>t.replace(/^(#{1,6})\s/gm,(r,a)=>{const o=Math.min(a.length+e,6);return`${"#".repeat(o)} `}),Hs=({markdownString:t,className:e,tag:s="div",inline:r=!1,headerOffset:a=0})=>{const o=m.useMemo(()=>{const i=K_(t,a),c=r?Ur.parseInline(i,{async:!1}):Ur.parse(i,{async:!1,breaks:!0});return ea.sanitize(c,{ADD_ATTR:["target"]})},[r,t,a]);return he.createElement(s,{dangerouslySetInnerHTML:{__html:o},className:L(Cc.markdown,r&&Cc.inline,e)})},Q_="_about_c4gxs_1",X_={about:Q_},Z_=()=>n.jsx(Hs,{className:X_.about,markdownString:`# About JW OTT Webapp
  
JW OTT Webapp is an open-source, dynamically generated video website built around JW Player and JW Platform services. It enables you to easily publish your JW Player-hosted video content with no coding and minimal configuration.

To see an example of JW OTT Webapp in action, see [https://app-preview.jwplayer.com/](https://app-preview.jwplayer.com/).

## Supported Features

- Works with any JW Player edition, from Free to Enterprise (note that usage will count against your monthly JW streaming limits). Only cloud-hosted JW Players are supported.
- It looks great on any device. The responsive UI automatically optimizes itself for desktop, tablet, and mobile screens.
- Populates your site's media content using JSON feeds. If you are using JW Platform, this happens auto-magically based on playlists that you specify. Using feeds from other sources will require you to hack the source code.
- Video titles, descriptions and hero images are populated from JW Platform JSON feed metadata.
- Playback of HLS video content from the JW Platform CDN. You can add external URLs (for example, URLS from your own server or CDN) to your playlists in the Content section of your JW Player account dashboard, but they must be HLS streams (\`.m3u8\` files).
- Support for live video streams (must be registered as external .m3u8 URLs in your JW Dashboard).
- Customize the user interface with your own branding. The default app is configured for JW Player branding and content, but you can easily change this to use your own assets by modifying the \`config.json\` file. Advanced customization is possible (for example, editing the CSS files), but you will need to modify the source code and build from source.
- Site-wide video search and related video recommendations powered by [JW Recommendations](https://docs.jwplayer.com/platform/docs/vdh-learn-about-recommendations).
- Basic playback analytics is reported to your JW Dashboard.
- Ad integrations (VAST, VPAID, GoogleIMA, etc.). These features require a JW Player Ads Edition license. For more information, see the [JW Player pricing page](https://www.jwplayer.com/pricing/).
- A "Favorites" feature for users to save videos for watching later. A separate list for "Continue Watching" is also kept so users can resume watching videos from where they left off. The lists are per-browser at this time (i.e., lists do not sync across user's browsers or devices). The "Continue Watching" list can be disabled in your JW OTT Webapp's \`config.json\` file.
- A grid view for a particular playlist of videos, with the ability to deep-link to the playlist through a static URL.
- Social sharing options using the device native sharing dialog.

## Unsupported Features

- Security-related features (encrypted HLS, DRM, signed URLs)
- Self-hosted JW Players`}),An=(t,e)=>{typeof t.addEventListener>"u"?t.addListener(e):t.addEventListener("change",e)},Tn=(t,e)=>{typeof t.removeEventListener>"u"?t.removeListener(e):t.removeEventListener("change",e)},Gr=matchMedia("screen and (max-width: 479px)"),Jr=matchMedia("screen and (min-width: 480px) and (max-width: 767px)"),Yr=matchMedia("screen and (min-width: 768px) and (max-width: 1023px)"),Kr=matchMedia("screen and (min-width: 1024px) and (max-width: 1199px)");var z=(t=>(t[t.xs=0]="xs",t[t.sm=1]="sm",t[t.md=2]="md",t[t.lg=3]="lg",t[t.xl=4]="xl",t))(z||{});const Qr=()=>Gr.matches?0:Jr.matches?1:Yr.matches?2:Kr.matches?3:4,pe=()=>{const[t,e]=m.useState(()=>Qr());return m.useEffect(()=>{const s=()=>e(Qr());return An(Gr,s),An(Jr,s),An(Yr,s),An(Kr,s),()=>{Tn(Gr,s),Tn(Jr,s),Tn(Yr,s),Tn(Kr,s)}},[]),t},wr={mobile:"mobile",tablet:"tablet",desktop:"desktop"},ey={DE:"Germany",FR:"France",NL:"Netherlands",RO:"Romania"},Pc={"Europe/Berlin":"DE","Europe/Paris":"FR","Europe/Amsterdam":"NL","Europe/Bucharest":"RO"},ty=()=>{const t=Qr(),e=t<z.md,s=t>=z.md&&t<z.lg,r=t>=z.lg;return{isMobile:e,isTablet:s,isDesktop:r}},sy=()=>{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;if(!(!t||!(t in Pc)))return ey[Pc[t]]},ny=()=>new Date().toLocaleString("en-US",{weekday:"long"}),ry=t=>!t?.filterTags?.length,ay=t=>{const{isMobile:e,isTablet:s,isDesktop:r}=ty(),a=t?.filterTags?.split(",")||[];if(a.includes(wr.mobile)&&e||a.includes(wr.tablet)&&s||a.includes(wr.desktop)&&r)return!0},oy=t=>{const e=ny();return(t?.filterTags?.split(",")||[]).includes(e)},iy=t=>{const e=sy(),s=t?.filterTags?.split(",")||[];return e&&s.includes(e)},cy=t=>e=>t.some(s=>s(e)),ly=[ry,ay,oy,iy],dy=({content:t,labelsFilteringEnabled:e})=>e?t?.filter(cy(ly)):t,uy=vl(30),Kl=({type:t,contentId:e,siteId:s,enabled:r,usePlaceholderData:a,params:o={},queryClient:i,language:c})=>{const l=W(xe);return{enabled:!!e&&r,queryKey:["playlist",t,e,o,c],queryFn:async()=>{if(t===Ft.playlist){const d=await l.getPlaylistById(e,o,c);return d?.playlist?.forEach(u=>{i.setQueryData(["media",u.mediaid],u)}),d}else if(t===Ft.content_list)return await l.getContentList({siteId:s,id:e,language:c})},placeholderData:e&&a?uy:void 0,refetchInterval:d=>d&&(ns(d.refetch)||d.playlist.some(tl))?1e3*30:!1,retry:!1}};function gn(t,e={},s=!0,r=!0,a=Ft.playlist){const{i18n:o}=I(),i=o.language,c=ta(),l=H(u=>u.config.siteId),d=Kl({type:a,contentId:t,siteId:l,params:e,queryClient:c,enabled:s,usePlaceholderData:r,language:i});return qe(d)}const hy=t=>!Su.some(e=>e===t),my=(t,e=void 0,s=ju)=>{const r=ta(),a=H(u=>u.config.siteId),o=pt(u=>u.getPlaylist()),i=_t(u=>u.getPlaylist()),{i18n:c}=I(),l=Jc(t.map(({contentId:u,type:h},p)=>hy(h)?Kl({enabled:!e||e>p,type:h,siteId:a,contentId:u,queryClient:r,usePlaceholderData:!0,params:{page_limit:s},language:c.language}):{enabled:!1}));return t.map(({type:u},h)=>{if(u===yt.Favorites)return{data:o,isLoading:!1,isSuccess:!0};if(u===yt.ContinueWatching)return{data:i,isLoading:!1,isSuccess:!0};const{data:p,isSuccess:g,error:f,isPlaceholderData:y}=l[h];return{data:p,isSuccess:g,error:f,isPlaceholderData:y}})},xs=t=>{const{i18n:e}=I();return`${t}-${e.language}`},ja=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),_n=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),Ca=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})),Pa=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),m.createElement("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"})),py="_image_f8aiq_1",fy={image:py},gy=(t,e)=>ye(t,{width:e}),Sr=new Map,_y=async(t,e)=>{const s=gy(t,e);let r=s;if(Sr.has(s))return Sr.get(s);try{const a=await fetch(s);a.redirected&&(r=a.url.replace("-1920",`-${e}`)),Sr.set(s,r)}catch(a){rl("Image","Failed to fetch image",{error:a,url:r})}return r},yy=m.forwardRef(({className:t,image:e,onLoad:s,alt:r="",width:a=640},o)=>{const[i,c]=m.useState(null);return m.useEffect(()=>{if(!e)return;(async()=>{const d=await _y(e,a);c(d),s?.()})()},[e,a,s]),i?n.jsx("img",{ref:o,className:`${t} ${fy.image}`,src:i,alt:r}):null}),Ws=he.memo(yy),vy="_card_j4dp8_1",xy="_featured_j4dp8_18",by="_title_j4dp8_18",wy="_tag_j4dp8_33",Sy="_meta_j4dp8_42",jy="_disabled_j4dp8_50",Cy="_poster_j4dp8_55",Py="_current_j4dp8_65",Ey="_posterImage_j4dp8_74",ky="_currentLabel_j4dp8_82",Iy="_aspect11_j4dp8_98",Ny="_aspect21_j4dp8_102",Ay="_aspect23_j4dp8_106",Ty="_aspect43_j4dp8_110",Ly="_aspect53_j4dp8_114",$y="_aspect169_j4dp8_118",Oy="_aspect916_j4dp8_122",My="_aspect913_j4dp8_126",Dy="_titleContainer_j4dp8_130",Ry="_hasSubtitle_j4dp8_137",Fy="_loading_j4dp8_140",By="_subtitle_j4dp8_169",Uy="_tags_j4dp8_201",Hy="_lock_j4dp8_223",Wy="_live_j4dp8_232",Vy="_scheduled_j4dp8_236",qy="_progressContainer_j4dp8_242",zy="_progressBar_j4dp8_252",oe={card:vy,featured:xy,title:by,tag:wy,meta:Sy,disabled:jy,poster:Cy,current:Py,posterImage:Ey,currentLabel:ky,aspect11:Iy,aspect21:Ny,aspect23:Ay,aspect43:Ty,aspect53:Ly,aspect169:$y,aspect916:Oy,aspect913:My,titleContainer:Dy,hasSubtitle:Ry,loading:Fy,subtitle:By,tags:Uy,lock:Hy,live:Wy,scheduled:Vy,progressContainer:qy,progressBar:zy},Gy=Symbol("CARD");function Jy({onHover:t,progress:e,item:s,posterAspect:r="16:9",featured:a=!1,disabled:o=!1,loading:i=!1,isCurrent:c=!1,isLocked:l=!0,currentLabel:d,headingLevel:u=3,url:h,tabIndex:p=0,hasSubtitle:g=!1}){const{title:f,duration:y,episodeNumber:v,seasonNumber:_,cardImage:b,mediaStatus:x,scheduledStart:P}=s,{t:w,i18n:{language:j}}=I(["common","video"]),S=L(oe.card,{[oe.featured]:a,[oe.disabled]:o}),C=r?oe[`aspect${r.replace(":","")}`]:void 0,E=L(oe.poster,C,{[oe.current]:c}),A=il(s),T=x===Ut.LIVE||ll(s),$=x===Ut.SCHEDULED,U=()=>{if(i||!f)return null;if(A)return n.jsx("div",{className:oe.tag,children:w("video:series")});if(v)return n.jsx("div",{className:oe.tag,children:Qn(_,v)});if(y)return n.jsx("div",{className:oe.tag,children:pa(y,{minutesAbbreviation:w("common:abbreviation.minutes")})});if(T)return n.jsx("div",{className:L(oe.tag,oe.live),children:w("live")});if($)return n.jsxs("div",{className:oe.tag,children:[n.jsx(V,{icon:Pa,className:oe.scheduled}),w("scheduled")]})},F=()=>{const N=he.createElement(`h${u}`,{className:oe.title},f),k=typeof s.subtitle=="string"?s.subtitle:null,O=P&&ca(s)?Wn(P,j):k;return i?n.jsx("div",{className:L(oe.titleContainer,oe.loading)}):n.jsxs("div",{className:L(oe.titleContainer,{[oe.hasSubtitle]:g}),children:[N,O&&n.jsx("p",{className:L(oe.subtitle),children:O})]})};return n.jsxs(dn,{role:"button",to:h,className:S,onClick:o?N=>N.preventDefault():void 0,onMouseEnter:t,tabIndex:o?-1:p,"data-testid":void 0,children:[!a&&F(),n.jsxs("div",{className:E,children:[n.jsx(Ws,{className:oe.posterImage,image:b,width:a?640:320,alt:""}),!i&&n.jsxs("div",{className:L(oe.meta,{[oe.featured]:a}),children:[a&&F(),n.jsxs("div",{className:oe.tags,children:[l&&n.jsx("div",{className:L(oe.tag,oe.lock),"aria-label":w("card_lock"),role:"img",children:n.jsx(V,{icon:Ca})}),U()]})]}),c&&n.jsx("div",{className:oe.currentLabel,children:d}),e?n.jsx("div",{className:oe.progressContainer,children:n.jsx("div",{className:oe.progressBar,style:{width:`${Math.round(e*100)}%`}})}):null]})]})}const Ql=m.memo(rs(Gy,Jy)),Yy="_shelf_c333h_1",Ky="_chevron_c333h_5",Qy="_loadingTitle_c333h_9",Xy="_title_c333h_17",Zy="_slider_c333h_34",ev="_dots_c333h_76",tv="_dot_c333h_76",sv="_active_c333h_95",nv="_error_c333h_100",Ct={shelf:Yy,chevron:Ky,loadingTitle:Qy,title:Xy,slider:Zy,dots:ev,dot:tv,active:sv,error:nv},rv={[z.xs]:1,[z.sm]:2,[z.md]:3,[z.lg]:4,[z.xl]:5},av={[z.xs]:1,[z.sm]:1,[z.md]:1,[z.lg]:1,[z.xl]:1},ov=Symbol("SHELF"),iv=({playlist:t,type:e,onCardHover:s,title:r,watchHistory:a,featured:o=!1,loading:i=!1,error:c=null,accessModel:l,isLoggedIn:d,hasSubscription:u,posterAspect:h,visibleTilesDelta:p=0})=>{const g=pe(),{t:f}=I("common"),y=(o?av[g]:rv[g])+p,v=t.playlist.some(dl),_=m.useCallback(({item:w,isVisible:j})=>{const{mediaid:S,title:C}=w,E=ue({id:S,title:C,playlistId:t.feedid,play:e===yt.ContinueWatching});return n.jsx(Ql,{progress:a?a[w.mediaid]:void 0,onHover:typeof s=="function"?()=>s(w):void 0,featured:o,disabled:!j,loading:i,isLocked:Yn(l,d,u,w),posterAspect:h,item:w,url:E,hasSubtitle:v},w.mediaid)},[a,s,o,i,l,d,u,h,t.feedid,e,v]),b=m.useCallback(({onClick:w})=>n.jsx("button",{className:Ct.chevron,"aria-label":f("slide_next"),onClick:w,children:n.jsx(V,{icon:_n})}),[f]),x=m.useCallback(({onClick:w})=>n.jsx("button",{className:Ct.chevron,"aria-label":f("slide_previous"),onClick:w,children:n.jsx(V,{icon:ja})}),[f]),P=({page:w,pages:j})=>{const S=Array.from({length:j},(C,E)=>E);return n.jsxs(n.Fragment,{children:[n.jsx("div",{"aria-live":"polite",className:"hidden",children:f("slide_indicator",{page:w+1,pages:j})}),o&&n.jsx("div",{"aria-hidden":"true",className:Ct.dots,children:S.map(C=>n.jsx("span",{className:L(Ct.dot,{[Ct.active]:w===C})},C))})]})};return c||!t?.playlist?n.jsx("h2",{className:Ct.error,children:"Could not load items"}):n.jsxs("div",{className:L(Ct.shelf),children:[o?null:i?n.jsx("div",{className:Ct.loadingTitle}):n.jsx("h2",{className:L(Ct.title),children:r||t.title}),n.jsx(su,{className:Ct.slider,items:t.playlist,tilesToShow:y,cycleMode:nu,showControls:!i,spacing:16,renderLeftControl:x,renderRightControl:b,renderPagination:P,renderTile:_})]})},cv=rs(ov,iv),lv="_infiniteScrollLoader_6rn4e_1",dv={infiniteScrollLoader:lv},Ea=()=>n.jsx("div",{className:dv.infiniteScrollLoader,children:n.jsx(vs,{})}),Vs=({className:t,open:e=!0,duration:s=250,delay:r=0,willChange:a=!0,onOpenAnimationEnd:o,onCloseAnimationEnd:i,keepMounted:c,children:l})=>{const u=`opacity ${s/1e3}s ease-in-out`,h=p=>({transition:u,opacity:p==="opening"||p==="open"?1:0,willChange:a?"opacity":void 0});return n.jsx(_a,{className:t,createStyle:p=>h(p),open:e,duration:s,delay:r,onOpenAnimationEnd:o,onCloseAnimationEnd:i,keepMounted:c,children:l})},Xl=(t=300,e=30,s)=>{const r=ee(()=>{const o=(document.scrollingElement||document.body).scrollTop,i=Math.max(0,Math.min(1,(o-t)/(e-t)));s(i)});m.useEffect(()=>{const{scrollingElement:a,documentElement:o,body:i}=document,c=a&&a!==o&&a!==i?a:window;return c.addEventListener("scroll",r,{passive:!0}),()=>{c.removeEventListener("scroll",r)}},[r])},uv="_shelf_h0uti_1",hv="_chevron_h0uti_19",mv="_loadingTitle_h0uti_47",pv="_title_h0uti_55",fv="_poster_h0uti_74",gv="_background_h0uti_108",_v="_image_h0uti_147",yv="_fade_h0uti_158",vv="_fadeMenu_h0uti_167",xv="_fade2_h0uti_177",bv="_swipeSlider_h0uti_191",wv="_swipeSliderMobile_h0uti_198",Sv="_metadata_h0uti_203",jv="_error_h0uti_270",Cv="_chevronLeft_h0uti_315",Pv="_chevronRight_h0uti_320",Ev="_dots_h0uti_324",kv="_dotsList_h0uti_338",Iv="_dot_h0uti_324",Nv="_dotActive_h0uti_374",Av="_dotPlaceholder_h0uti_383",_e={shelf:uv,chevron:hv,loadingTitle:mv,title:pv,poster:fv,background:gv,image:_v,fade:yv,fadeMenu:vv,fade2:xv,swipeSlider:bv,swipeSliderMobile:wv,metadata:Sv,error:jv,chevronLeft:Cv,chevronRight:Pv,dots:Ev,dotsList:kv,dot:Iv,dotActive:Nv,dotPlaceholder:Av},Tv="_truncatedText_vuggl_1",Lv={truncatedText:Tv},Zl=({text:t,maximumLines:e,className:s})=>n.jsx("div",{className:L(Lv.truncatedText,s),style:{maxHeight:`calc(1.5em * ${e})`,WebkitLineClamp:e,lineClamp:e,display:"-webkit-box"},children:n.jsx(Hs,{markdownString:t,inline:!0})}),$v=["data","isLoading"],qs=t=>{const{accessModel:e}=H(),{user:s,subscription:r}=B(({user:h,subscription:p})=>({user:h,subscription:p}),Q),a=W(vt,!1),o=t&&!Yn(e,!!s,!!r,t),i=t?.mediaOffers||[],c=Jc(i.map(({offerId:h})=>({queryKey:["entitlements",h],queryFn:()=>a?.getEntitlements({offerId:h}),enabled:!!t&&!!s&&!!s.id&&!!h&&!o,refetchOnMount:"always",notifyOnChangeProps:$v}))),l=!!s&&c.some(h=>h.isSuccess&&h.data?.responseData?.accessGranted),d=!l&&c.some(h=>h.isLoading);return{isEntitled:!!t&&(o||l),isMediaEntitlementLoading:d,mediaOffers:i}},ed=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M8,5.14V19.14L19,12.14L8,5.14Z"})),Ov="_progressRail_14udi_1",Mv="_progress_14udi_1",Ec={progressRail:Ov,progress:Mv},bs=({item:t,playUrl:e,disabled:s=!1,onClick:r})=>{const{t:a}=I("video"),o=se(),i=re(),c=pe(),l=H(P=>P.accessModel),u=!!B(P=>P.user),p=_t(P=>t&&P.getItem(t))?.progress,g=ge(P=>P.setRequestedMediaOffers),{isEntitled:f,mediaOffers:y}=qs(t),v=!!y.length,_=m.useMemo(()=>a(f?typeof p=="number"?"continue_watching":"start_watching":v?"buy":u?"complete_your_subscription":"sign_up_to_start_watching"),[f,u,v,p,a]),b=m.useMemo(()=>f?"start_watching":v?"buy":u?"complete_subscription":"sign_up",[v,f,u]),x=m.useCallback(()=>{if(f){if(r){r();return}return e&&o(e)}return o(u?v?q(i,"choose-offer"):"/u/payments":q(i,"create-account"))},[f,e,o,u,i,v,r]);return m.useEffect(()=>(g(y),()=>g([])),[y,g]),l===Ae.AVOD&&!f?null:n.jsx(D,{color:"primary",variant:"contained",size:"large",label:_,startIcon:f?n.jsx(V,{icon:ed}):void 0,onClick:x,fullWidth:c<z.md,disabled:s,"data-testid":b,"data-mediaid":t.mediaid,children:p?n.jsx("div",{className:Ec.progressRail,children:n.jsx("div",{className:Ec.progress,style:{width:`${p*100}%`}})}):null})},jr=({item:t,loading:e,playlistId:s,style:r,hidden:a})=>{const o=se(),{t:i}=I("common"),l=pe()<z.sm;if(!t)return null;const d=!Bt(t,Ve.hub)&&!Bt(t,Ve.liveChannel)&&!Bt(t,Ve.page),h=t.sources.find(p=>p.file.indexOf(".m3u8")>-1||p.file.indexOf(".mp4")>-1)&&d&&!l;return n.jsxs("div",{className:_e.metadata,"data-testid":void 0,style:{...r,visibility:a?"hidden":void 0},"aria-hidden":a?"true":void 0,children:[n.jsx("h2",{className:L(e?_e.loadingTitle:_e.title),children:!e&&t?.title}),t?.synopsis?n.jsx("div",{children:t.synopsis}):n.jsx(Zl,{text:t?.description,maximumLines:3}),n.jsxs("div",{children:[h&&n.jsx(bs,{item:t,playUrl:ue({id:t.mediaid,title:t.title,playlistId:s,play:!0})}),n.jsx(D,{label:i("common:more_info"),onClick:()=>o(ue({id:t.mediaid,title:t.title,playlistId:s})),startIcon:n.jsx(V,{icon:_n}),size:"large",variant:h?void 0:"contained",color:h?void 0:"primary"})]})]})},Dv=({item:t,style:e,hidden:s,onTransitionEnd:r})=>{if(!t)return null;const a=t?.backgroundImage;return n.jsx("div",{style:{...e,visibility:s?"hidden":void 0},"aria-hidden":s?"true":void 0,onTransitionEnd:r,children:n.jsx(Ws,{className:_e.image,image:a,width:1920,alt:t?.title})},t.mediaid)},Cr=he.memo(Dv),Rv=(t,e,s,r,a)=>{const o=t==="left",i=t==="right",c={semiEdgeLeft:e===s-r+1&&i,edgeLeft:e===s-r,newDotLeft:e===s-r-1,semiEdgeRight:e===s+r-1&&o,edgeRight:e===s+r,newDotRight:e===s+r+1};return c.semiEdgeLeft||c.semiEdgeRight?a:c.edgeLeft?i?0:o?1:a:c.edgeRight?o?0:i?1:a:c.newDotLeft?o?a:0:c.newDotRight?i?a:0:1},Fv=({playlist:t,index:e,direction:s,nextIndex:r,setIndex:a,range:o=3,animationDuration:i=200})=>{const{t:c}=I("common"),l=o+1,d=e+l,u=r+l,h=m.useMemo(()=>{const p=Array.from({length:l}).map(()=>!1);return[...p,...t.playlist,...p]},[t.playlist,l]);return n.jsxs(n.Fragment,{children:[n.jsx("div",{"aria-live":"polite",className:"hidden",children:c("slide_indicator",{page:e+1,pages:t.playlist.length})}),n.jsx("nav",{className:_e.dots,children:n.jsx("ul",{className:_e.dotsList,children:h.map((p,g)=>{if(g<d-o-1||g>d+o+1)return null;if(!p)return n.jsx("li",{className:L(_e.dotPlaceholder),"aria-hidden":"true"},g);const y=Math.abs(d-u)*22,_=`translateX(${s==="left"?y:s==="right"?0-y:0}px)`,b=s?`transform ${i}ms ease-out ${i/3}ms, width ${i/2}ms ease-out ${i/3}ms`:"",x=Rv(s,g,d,o,.6),P=`scale(${x})`,w=s?`width ${i}ms ease-out, height ${i}ms ease-out, transform ${i}ms ease-out`:"",j=g===d,S=x!==1,C=S?void 0:c("slide_to",{item:g-l+1,items:t.playlist.length});return n.jsx("li",{"aria-hidden":S||void 0,"aria-current":j||void 0,children:n.jsx("button",{className:L(_e.dot,g===u&&_e.dotActive,!s&&g===d&&_e.dotActive),style:{transform:_,transition:b},"aria-label":C,disabled:S||void 0,onClick:S||j?void 0:()=>a(g-l),children:n.jsx("div",{style:{transform:P,transition:w}})})},p?.mediaid)})})})]})},Bv=({hasLeftItem:t,hasRightItem:e,renderItem:s,renderLeftItem:r,renderRightItem:a,direction:o,isSwipeAnimation:i,onSwipeLeft:c,onSwipeRight:l})=>{const d=m.useRef({x:0,y:0,start:Date.now()}),u=m.useRef(null),[h,p]=m.useState(null),f=pe()<=z.sm,y=ee(b=>{o||(d.current={x:b.touches[0].clientX,y:b.touches[0].clientY,start:Date.now()},p(null))}),v=ee(b=>{if(o||!u.current)return;const x=b.changedTouches[0].clientX-d.current.x,P=b.changedTouches[0].clientY-d.current.y,w=Math.abs(x)>Math.abs(P)?"slide":"scroll";if(h||p(w),w==="scroll"||h==="scroll")return;b.preventDefault(),b.stopPropagation();const j=e?-window.innerWidth:0,S=t?window.innerWidth:0,C=Math.max(Math.min(x,S),j);u.current.style.transform=`translateX(${C}px)`,u.current.style.transition="none"}),_=ee(b=>{if(o||!u.current||h==="scroll")return;const x=d.current.x-b.changedTouches[0].clientX,P=Math.round(x/(Date.now()-d.current.start)*100),w=80;e&&(x>window.innerWidth/2||P>w)?l():t&&(x<-window.innerWidth/2||P<-w)?c():(u.current.style.transition="transform 0.2s ease-out",u.current.style.transform="translateX(0)"),p(null)});return m.useLayoutEffect(()=>{u.current&&(i&&o==="left"?(u.current.style.transition="transform 0.2s ease-out",u.current.style.transform="translateX(100%)"):i&&o==="right"?(u.current.style.transition="transform 0.2s ease-out",u.current.style.transform="translateX(-100%)"):(u.current.style.transform="translateX(0)",u.current.style.transition="none"))},[o,i]),m.useEffect(()=>{const b=u.current;if(b)return b.addEventListener("touchstart",y),b.addEventListener("touchmove",v,{passive:!1}),b.addEventListener("touchend",_),()=>{b.removeEventListener("touchstart",y),b.removeEventListener("touchmove",v),b.removeEventListener("touchend",_)}},[y,v,_]),n.jsxs("div",{ref:u,className:L(_e.swipeSlider,f&&_e.swipeSliderMobile),children:[r(h==="slide"),s(),a(h==="slide")]})},Uv=({playlist:t,loading:e=!1,error:s=null})=>{const[r,a]=m.useState(0),[o,i]=m.useState(0),{t:c}=I("common"),d=pe()<=z.sm,u=m.useRef(null),[h,p]=m.useState(null),[g,f]=m.useState(null),[y,v]=m.useState(!1);Xl(50,d?200:600,N=>{u.current&&(u.current.style.opacity=`${Math.max(1-N,d?0:.1)}`)});const _=(N,k=!1)=>{g||(i(N),p(N>r?"right":"left"),f("init"),v(k))},b=()=>_(r-1),x=()=>_(r+1),P=()=>_(r-1,!0),w=()=>_(r+1,!0),j=m.useCallback(N=>{N.propertyName==="transform"&&g==="start"&&f("end")},[g]);m.useEffect(()=>{if(h){if(g==="init"){f("start");return}g==="end"&&(a(o),p(null),f(null),v(!1))}},[g,h,o]);const S=g==="start"||g==="end",C=h==="left"?1:h==="right"?-1:0,E=N=>{const k=d?10:40;return N=="left"?{transform:`translateX(${g==="init"?k*-1:0}px)`,opacity:S&&h==="left"?1:0,transition:S&&h==="left"?"opacity 0.3s ease-out, transform 0.3s ease-out":"none"}:N=="right"?{transform:`translateX(${g==="init"?k:0}px)`,opacity:S&&h==="right"?1:0,transition:S&&h==="right"?"opacity 0.3s ease-out, transform 0.3s ease-out":"none"}:{transform:`translateX(${S?k*C:0}px)`,opacity:S?0:1,transition:S?`opacity ${d?.3:.1}s ease-out, transform 0.3s ease-in`:"none"}},A=(N,k=!1)=>N==="left"?{left:k||y?"-100%":g==="init"?-60:0,opacity:k||y||S&&h==="left"?1:0,transition:S?"opacity 0.2s ease-out, left 0.2s ease-out":"none",pointerEvents:"none"}:N==="right"?{left:k||y?"100%":g==="init"?60:0,opacity:k||y||S&&h==="right"?1:0,transition:S?"opacity 0.2s ease-out, left 0.2s ease-out":"none",pointerEvents:"none"}:{left:S&&h?60*C:0,opacity:S?0:1,transition:S?"opacity 0.15s ease-out, left 0.15s ease-out":"none",pointerEvents:S?"none":"initial"},T=t.playlist[r],$=t.playlist[o<r?o:r-1]||null,U=t.playlist[o>r?o:r+1]||null,F=g!=="end"?T:h==="right"?$:U;return s||!t?.playlist?n.jsx("h2",{className:_e.error,children:"Could not load items"}):n.jsxs("div",{className:L(_e.shelf),children:[n.jsxs("div",{className:_e.poster,ref:u,children:[n.jsxs("div",{className:_e.background,id:"background",children:[n.jsx(Cr,{item:$,style:E("left"),hidden:h!=="left"},F?.mediaid===$?.mediaid?"left-item":$?.mediaid),n.jsx(Cr,{item:F,style:E(),onTransitionEnd:j},F?.mediaid),n.jsx(Cr,{item:U,style:E("right"),hidden:h!=="right"},F?.mediaid===U?.mediaid?"right-item":U?.mediaid),n.jsx("div",{className:_e.fade})]}),n.jsx("div",{className:_e.fadeMenu}),n.jsx("div",{className:_e.fade2})]}),n.jsx("button",{className:L(_e.chevron,_e.chevronLeft),"aria-label":c("slide_previous"),disabled:!$,onClick:$?b:void 0,children:n.jsx(V,{icon:ja})}),n.jsx(Bv,{direction:h,isSwipeAnimation:y,loading:e,onSwipeLeft:P,onSwipeRight:w,hasLeftItem:!!$,hasRightItem:!!U,renderLeftItem:N=>n.jsx(jr,{loading:e,item:$,playlistId:t.feedid,style:A("left",N),hidden:h!=="left"&&!N},F?.mediaid===$?.mediaid?"left-item":$?.mediaid),renderItem:()=>n.jsx(jr,{loading:e,item:F,playlistId:t.feedid,style:A()},F?.mediaid),renderRightItem:N=>n.jsx(jr,{loading:e,item:U,playlistId:t.feedid,style:A("right",N),hidden:h!=="right"&&!N},F?.mediaid===U?.mediaid?"right-item":U?.mediaid)}),n.jsx("button",{className:L(_e.chevron,_e.chevronRight),"aria-label":c("slide_next"),disabled:!U,onClick:U?x:void 0,children:n.jsx(V,{icon:_n})}),n.jsx(Fv,{playlist:t,index:r,setIndex:_,nextIndex:o,direction:h||!1})]})},Hv="_row_gdady_1",Wv="_cell_gdady_5",kc={row:Hv,cell:Wv},Vv=Lu(function(t){t.scrollIntoView({behavior:"smooth",block:"center"})},300),qv=({className:t,columnCount:e,data:s,renderCell:r,getCellKey:a})=>{const[o,i]=m.useState(0),[c,l]=m.useState(0),d=m.useRef(null),u=Math.ceil(s.length/e),h=(f,y)=>{const v=document.getElementById(`layout_grid_${f}-${y}`),b=v?.querySelector('button, a, input, [tabindex]:not([tabindex="-1"])')||v;i(f),l(y),b&&(b.focus({preventScroll:!0}),Vv(b))},p=ee(f=>{const{key:y,ctrlKey:v}=f;if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(y))return;f.preventDefault();const _=u-1,b=c===0,x=c===e-1,P=o===0,w=o===_,j=(s.length%e||e)-1,S=w?j:e-1,C=Math.min(o+1,_),E=Math.max(o-1,0);switch(y){case"ArrowLeft":return b&&!P?h(E,e-1):h(o,Math.max(c-1,0));case"ArrowRight":return x&&!w?h(C,0):h(o,Math.min(c+1,S));case"ArrowUp":return h(E,c);case"ArrowDown":return h(C,C===_?Math.min(c,j):c);case"Home":return h(v?0:o,0);case"End":return v?h(_,j):h(o,S);case"PageUp":return h(E,c);case"PageDown":return h(C,C===_?Math.min(j,c):c);default:return}});m.useEffect(()=>{if(!d.current?.contains(document.activeElement))return;const f=(s.length%e||e)-1;if(c>e-1)return h(o,e-1);if(o===u-1&&c>f)return h(o,f)},[e]);const g=m.useMemo(()=>({width:`${Math.floor(100/e*100)/100}%`}),[e]);return n.jsx("div",{role:"grid","data-testid":void 0,ref:d,"aria-rowcount":u,className:t,onKeyDown:p,children:Array.from({length:u}).map((f,y)=>n.jsx("div",{role:"row","aria-rowindex":y+1,className:kc.row,children:s.slice(y*e,y*e+e).map((v,_)=>n.jsx("div",{role:"gridcell",id:`layout_grid_${y}-${_}`,"aria-colindex":_+1,className:kc.cell,style:g,children:r(v,o===y&&c===_?0:-1)},a(v)))},y))})},zv="_cell_1jw02_1",Gv="_container_1jw02_6",Ic={cell:zv,container:Gv,"cols-1":"_cols-1_1jw02_10","cols-2":"_cols-2_1jw02_13","cols-3":"_cols-3_1jw02_16","cols-4":"_cols-4_1jw02_19","cols-5":"_cols-5_1jw02_22","cols-6":"_cols-6_1jw02_25","cols-7":"_cols-7_1jw02_28","cols-8":"_cols-8_1jw02_31","cols-9":"_cols-9_1jw02_34","cols-10":"_cols-10_1jw02_37"},Nc=6,Jv=4,Yv={[z.xs]:2,[z.sm]:2,[z.md]:3,[z.lg]:4,[z.xl]:5},Kv=Symbol("CARD_GRID"),Qv=t=>t.mediaid;function Xv({playlist:t,watchHistory:e,isLoading:s=!1,cols:r=Yv,currentCardItem:a,currentCardLabel:o,accessModel:i,isLoggedIn:c,hasSubscription:l,hasMore:d,getUrl:u,loadMore:h,onCardHover:p,headingLevel:g}){const f=pe(),y=xl(t.cardImageAspectRatio||t.shelfImageAspectRatio),v=r[f]+bl(y),_=t.playlist.some(dl),[b,x]=m.useState(Nc),P=()=>x(S=>S+Jv),w=b*v<t.playlist.length;m.useEffect(()=>{x(Nc)},[t.feedid]);const j=m.useCallback((S,C)=>n.jsx(Ql,{tabIndex:C,progress:e?e[S.mediaid]:void 0,url:u(S),onHover:typeof p=="function"?()=>p(S):void 0,loading:s,isCurrent:a&&a.mediaid===S.mediaid,currentLabel:o,isLocked:Yn(i,c,l,S),posterAspect:y,item:S,headingLevel:g,hasSubtitle:_}),[i,a,o,u,l,g,s,c,p,y,e,_]);return n.jsx(sa,{pageStart:0,loadMore:h??P,hasMore:d??w,loader:n.jsx(Ea,{},"loader"),getScrollParent:ga,useWindow:!1,children:n.jsx(qv,{className:L(Ic.container,Ic[`cols-${v}`]),data:h?t.playlist:t.playlist.slice(0,b*v),columnCount:v,renderCell:j,getCellKey:Qv})})}const zs=rs(Kv,Xv),Zv="_shelfList_gtbvf_1",ex="_shelfContainer_gtbvf_6",tx="_hero_gtbvf_10",sx="_featured_gtbvf_13",nx="_grid_gtbvf_23",ks={shelfList:Zv,shelfContainer:ex,hero:tx,featured:sx,grid:nx},Ac=6,rx=4,td=({rows:t})=>{const{accessModel:e}=H(({accessModel:p})=>({accessModel:p}),Q),[s,r]=m.useState(Ac),{t:a}=I("error"),o=xs("title"),i=_t(p=>p.getDictionaryWithSeries()),{user:c,subscription:l}=B(({user:p,subscription:g})=>({user:p,subscription:g}),Q),d=t.length===1,u=my(t,s,d?Cu:void 0);return m.useEffect(()=>()=>r(Ac),[t]),u.every(({data:p,isSuccess:g})=>g&&!p?.playlist?.length)?n.jsx(Ke,{title:a("empty_shelves_heading"),message:a("empty_shelves_description")}):d?u[0].data?n.jsx("section",{className:L(ks.shelfContainer,ks.grid),children:n.jsx(zs,{getUrl:p=>ue({id:p.mediaid,title:p.title,playlistId:u[0].data?.feedid}),playlist:u[0].data,accessModel:e,isLoading:u[0].isPlaceholderData||!1,isLoggedIn:!!c,hasSubscription:!!l})}):void 0:n.jsx("div",{className:ks.shelfList,children:n.jsx(sa,{style:{overflow:"hidden"},loadMore:()=>r(p=>p+rx),hasMore:s<t.length,loader:n.jsx(Ea,{},"loader"),getScrollParent:ga,useWindow:!1,children:t.slice(0,s).map(({type:p,featured:g,title:f,custom:y},v)=>{const{data:_,isPlaceholderData:b,error:x}=u[v];if(!_?.playlist?.length)return null;const P=xl(_.cardImageAspectRatio||_.shelfImageAspectRatio),w=bl(P),S=y?.[o]||_?.[o]||f||_?.title,C=y?.layoutType===Ga.hero&&v===0,E=!C&&(y?.layoutType===Ga.featured||g);return n.jsx("section",{className:L(ks.shelfContainer,{[ks.hero]:C,[ks.featured]:E}),"data-testid":(`${C?"hero":E?"featured":p==="playlist"?Jn(S):p}`,void 0),"aria-label":S,children:n.jsx(Vs,{duration:250,delay:v*33,willChange:!C,open:!0,children:C?n.jsx(Uv,{loading:b,error:x,playlist:_}):n.jsx(cv,{loading:b,error:x,type:p,playlist:_,watchHistory:p===yt.ContinueWatching?i:void 0,title:S,featured:E,accessModel:e,isLoggedIn:!!c,hasSubscription:!!l,posterAspect:P,visibleTilesDelta:w})})},`${v}_${_.id}`)})})})},ax=()=>{const{config:t}=H(({config:o,accessModel:i})=>({config:o,accessModel:i}),Q),e=t?.content,{t:s}=I("common"),r=ns(t?.custom?.enableLabelsFiltering),a=dy({content:e,labelsFilteringEnabled:r});return n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:"hideUntilFocus",children:s("home")}),n.jsx(td,{rows:a})]})},sd=()=>{const t=m.useRef(!0);return m.useEffect(()=>{t.current=!1},[]),t.current},ox=(t,e)=>{const s=m.useRef(),r=m.useRef(Tu((...a)=>{s.current&&s.current(...a)},e));return m.useEffect(()=>{s.current=t},[t]),r.current},nd=()=>{const t=se(),e=ox(a=>{t(`/q/${encodeURIComponent(a)}`)},350),s=m.useCallback(a=>{Ee.setState({searchQuery:a}),e(a)},[e]),r=m.useCallback(()=>{const a=Ee.getState().preSearchPage;Ee.setState({searchQuery:"",preSearchPage:void 0}),t(a||"/")},[t]);return{updateSearchQuery:s,resetSearchQuery:r}},ix=vl(30),cx=({siteId:t,enabled:e,query:s})=>{const r=W(xe);return qe(["app-search",s],async()=>await r.getContentSearch({siteId:t,params:{searchTerm:s}}),{placeholderData:e?ix:void 0,enabled:e,staleTime:_s,cacheTime:gs})},lx=t=>{const{config:e}=H(({config:c})=>({config:c}),Q),s=e?.siteId,r=e?.features?.searchPlaylist,a=ns(e?.custom?.appContentSearch),o=gn(r||"",{search:t||""},!a,!!t),i=cx({siteId:s,enabled:a,query:t});return a?{data:i.data,isFetching:i.isFetching,error:i.error}:{isFetching:o.isFetching,error:o.error,data:o.data}},dx="_search_1fatj_1",ux="_header_1fatj_17",hx="_subHeading_1fatj_38",Ln={search:dx,header:ux,subHeading:hx},mx=()=>{const{t}=I("search"),{config:e,accessModel:s}=H(({config:b,accessModel:x})=>({config:b,accessModel:x}),Q),{siteName:r,features:a}=e,o=dt("search_heading"),i=sd(),c=Ee(b=>b.searchQuery),{updateSearchQuery:l}=nd(),u=Rs()["*"],{isFetching:h,error:p,data:g}=lx(u||""),{user:f,subscription:y}=B(({user:b,subscription:x})=>({user:b,subscription:x}),Q),v=b=>ue({id:b.mediaid,title:b.title,playlistId:a?.searchPlaylist}),_=m.useMemo(()=>h?t("heading"):u?g?.playlist.length?t("title",{count:g.playlist.length,query:u}):t("no_results_heading",{query:u}):t("start_typing"),[h,g?.playlist.length,u,t]);return m.useEffect(()=>{i&&u&&u!==c&&l(u)},[i,u,c,l]),m.useEffect(()=>()=>{Ee.setState({searchQuery:"",searchActive:!1})},[]),(p||!g)&&!h?n.jsxs(Ke,{title:t("error_heading"),children:[n.jsx("h2",{className:Ln.subHeading,children:t("error_subheading")}),n.jsx("p",{children:t("error_description")})]}):u?g?.playlist.length?n.jsxs("div",{className:Ln.search,children:[n.jsx(Tt,{children:n.jsxs("title",{children:[_," - ",r]})}),n.jsx("header",{className:Ln.header,children:n.jsx("h2",{id:o,"aria-live":h?void 0:"polite",children:_})}),n.jsx(zs,{"aria-labelledby":o,getUrl:v,playlist:g,isLoading:i,accessModel:s,isLoggedIn:!!f,hasSubscription:!!y})]}):n.jsxs(n.Fragment,{children:[n.jsx(Tt,{children:n.jsxs("title",{children:[_," - ",r]})}),n.jsxs(Ke,{title:_,children:[n.jsx("h2",{className:Ln.subHeading,children:t("suggestions")}),n.jsxs("ul",{children:[n.jsx("li",{children:t("tip_one")}),n.jsx("li",{children:t("tip_two")}),n.jsx("li",{children:t("tip_three")})]})]})]}):n.jsx(Ke,{title:_})},ka=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})),rd=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M5,3C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V16.72C21.59,16.37 22,15.74 22,15V9C22,8.26 21.59,7.63 21,7.28V5A2,2 0 0,0 19,3H5M5,5H19V7H13A2,2 0 0,0 11,9V15A2,2 0 0,0 13,17H19V19H5V5M13,9H20V15H13V9M16,10.5A1.5,1.5 0 0,0 14.5,12A1.5,1.5 0 0,0 16,13.5A1.5,1.5 0 0,0 17.5,12A1.5,1.5 0 0,0 16,10.5Z"})),ad=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"})),Ia=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})),px="_user_15a6w_1",fx="_leftColumn_15a6w_18",gx="_button_15a6w_29",_x="_logoutLi_15a6w_41",yx="_mainColumn_15a6w_50",vx="_panel_15a6w_55",xx="_panelHeader_15a6w_73",He={user:px,leftColumn:fx,button:gx,logoutLi:_x,mainColumn:yx,panel:vx,panelHeader:xx},bx=()=>{const t=W(ie),{accessModel:e,favoritesList:s}=H(u=>({accessModel:u.accessModel,favoritesList:u.config.features?.favoritesList}),Q),r=se(),{t:a}=I("user"),i=pe()>z.md,{user:c,loading:l}=B(),d=m.useCallback(async()=>{await t.logout()},[t]);return m.useEffect(()=>{!l&&!c&&r("/",{replace:!0})},[r,c,l]),c?n.jsxs("div",{className:He.user,children:[i&&n.jsx("nav",{className:He.leftColumn,children:n.jsx("div",{className:He.panel,children:n.jsxs("ul",{children:[n.jsx("li",{children:n.jsx(D,{to:cn,label:a("nav.account"),variant:"text",startIcon:n.jsx(V,{icon:ka}),className:He.button})}),s&&n.jsx("li",{children:n.jsx(D,{to:da,label:a("nav.favorites"),variant:"text",startIcon:n.jsx(V,{icon:Ia}),className:He.button})}),e!==Ae.AVOD&&n.jsx("li",{children:n.jsx(D,{to:ua,label:a("nav.payments"),variant:"text",startIcon:n.jsx(V,{icon:rd}),className:He.button})}),n.jsx("li",{className:He.logoutLi,children:n.jsx(D,{onClick:d,label:a("nav.logout"),variant:"text",startIcon:n.jsx(V,{icon:ad}),className:He.button})})]})})}),n.jsx("div",{className:He.mainColumn,children:n.jsx(na,{})})]}):n.jsx("div",{className:He.user,children:n.jsx(ve,{inline:!0})})},Na=(t,e)=>{const s=[],r=wl(t.duration,e);return t.pubdate&&s.push(String(new Date(t.pubdate*1e3).getFullYear())),!e.episodesLabel&&r&&s.push(r),e.episodesLabel&&s.push(e.episodesLabel),t.genre&&s.push(t.genre),t.rating&&s.push(t.rating),s},wx=(t,e)=>{const s=[];return e&&s.push(e),t.genre&&s.push(t.genre),t.rating&&s.push(t.rating),s},Sx=(t,e,s)=>{const r=[],a=Dh(e,t.scheduledStart,t.scheduledEnd),o=wl(t.duration,s);return a&&r.push(a),o&&r.push(o),t.genre&&r.push(t.genre),t.rating&&r.push(t.rating),r};function es(t,e=!0){const s=W(xe),{i18n:r}=I(),a=r.language;return qe(["media",t,a],()=>s.getMediaById({id:t,language:a}),{enabled:!!t&&e,refetchInterval:(o,i)=>o&&tl(o)?1e3*30:!1,staleTime:60*1e3*10})}const yn=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,8V16L15,12L10,8Z"})),jx="_filterRow_1pd69_1",Cx="_dropDown_1pd69_10",Px="_filterDropDown_1pd69_17",Pr={filterRow:jx,dropDown:Cx,filterDropDown:Px},od=({name:t,value:e,defaultLabel:s,options:r,setValue:a,forceDropdown:o=!1})=>{const{t:i}=I("common"),c=pe();if(!r.length)return null;const l=u=>a(u.target.value),d=!o&&c>=z.md&&r.length<6;return n.jsx(m.Fragment,{children:d?n.jsxs("div",{className:Pr.filterRow,role:"listbox","aria-label":i("filter_videos_by",{name:t}),children:[r.map(u=>{const h=typeof u=="string"?u:u.label,p=typeof u=="string"?u:u.value,g=e===p;return n.jsx(D,{label:h,onClick:()=>a(p),active:g,role:"option","aria-selected":g},p)}),n.jsx(D,{label:s,onClick:()=>a(""),active:e==="",role:"option","aria-selected":e===""},s)]}):n.jsx("div",{className:Pr.filterDropDown,children:n.jsx(Hl,{className:Pr.dropDown,size:"small",options:r,defaultLabel:s,name:t,value:e,onChange:l,"aria-label":i("filter_videos_by",{name:t})})})})},Ex="_hero_sxun8_1",kx="_info_sxun8_11",Ix="_title_sxun8_18",Nx="_description_sxun8_35",Ax="_poster_sxun8_42",Tx="_posterFadeMenu_sxun8_56",Lx="_posterBackground_sxun8_66",$x="_posterFadeBottom_sxun8_79",Ox="_posterFadeLeft_sxun8_90",Et={hero:Ex,info:kx,title:Ix,description:Nx,poster:Ax,posterFadeMenu:Tx,posterBackground:Lx,posterFadeBottom:$x,posterFadeLeft:Ox},Aa=({image:t,children:e,className:s,infoClassName:r})=>{const a="",o=m.useRef(null),c=pe()<=z.sm;return Xl(50,c?150:500,l=>{o.current&&(o.current.style.opacity=`${Math.max(1-l,.1)}`)}),n.jsxs("div",{className:L([Et.hero,s]),children:[n.jsx(Ws,{ref:o,className:Et.poster,image:t,width:1280,alt:a}),n.jsx("div",{className:Et.posterFadeMenu}),n.jsx("div",{className:Et.posterFadeLeft}),n.jsx("div",{className:Et.posterFadeBottom}),n.jsx("div",{className:Et.posterBackground}),n.jsx("div",{className:L(Et.info,r),children:e})]})},id=({title:t})=>n.jsx("h1",{className:Et.title,children:t}),Mx="_collapsibleText_1ve3l_1",Dx="_textContainer_1ve3l_11",Rx="_collapsed_1ve3l_15",Fx="_chevron_1ve3l_20",Bx="_expanded_1ve3l_33",Zs={collapsibleText:Mx,textContainer:Dx,collapsed:Rx,chevron:Fx,expanded:Bx},cd=({text:t,className:e})=>{const s=m.useRef(),r=pe(),[a,o]=m.useState(!1),[i,c]=m.useState(!1),l=i?"Collapse":"Expand",d=4,u=60;return m.useEffect(()=>{s.current&&o(s.current.scrollHeight>s.current.offsetHeight+d||u<s.current.offsetHeight)},[u,t,r]),n.jsxs("div",{className:L(Zs.collapsibleText),children:[n.jsx("p",{ref:s,id:"collapsible-content",className:L(Zs.textContainer,e,{[Zs.collapsed]:!i&&a}),style:{maxHeight:i?s.current.scrollHeight:u},children:n.jsx(Hs,{tag:"span",markdownString:t,inline:!0})}),a&&n.jsx(Re,{"aria-label":l,"aria-expanded":i,"aria-controls":"collapsible-content",className:L(Zs.chevron,{[Zs.expanded]:i}),onClick:()=>c(!i),children:n.jsx(V,{icon:_n})})]})},Ta=({className:t,description:e,maximumLines:s=8})=>pe()<=z.sm?n.jsx(cd,{text:e,className:L(Et.description,t)}):n.jsx(Zl,{text:e,maximumLines:s,className:L(Et.description,t)}),Ux="_videoDetails_1dlco_1",Hx="_metaContainer_1dlco_5",Wx="_primaryMetadata_1dlco_10",Vx="_secondaryMetadata_1dlco_24",qx="_description_1dlco_39",zx="_buttonBar_1dlco_43",Is={videoDetails:Ux,metaContainer:Hx,primaryMetadata:Wx,secondaryMetadata:Vx,description:qx,buttonBar:zx},ld=({title:t,description:e,primaryMetadata:s,secondaryMetadata:r,image:a,startWatchingButton:o,shareButton:i,favoriteButton:c,trailerButton:l,children:d})=>n.jsxs("div",{"data-testid":void 0,children:[n.jsx("header",{className:Is.videoDetails,"data-testid":void 0,id:"video-details",children:n.jsxs(Aa,{image:a,children:[n.jsx(id,{title:t}),n.jsxs("div",{className:Is.metaContainer,children:[n.jsx("div",{className:Is.primaryMetadata,children:s}),r&&n.jsx("div",{className:Is.secondaryMetadata,children:r})]}),n.jsx(Ta,{className:Is.description,description:e}),n.jsxs("div",{className:Is.buttonBar,children:[o,l,c,i]})]})}),d]}),Gx="_details_72tjp_1",Jx="_inlinePlayerMetadata_72tjp_23",Yx="_title_72tjp_39",Kx="_primaryMetadata_72tjp_65",Qx="_buttonBar_72tjp_77",Xx="_description_72tjp_98",ds={details:Gx,inlinePlayerMetadata:Jx,title:Yx,primaryMetadata:Kx,buttonBar:Qx,description:Xx},dd=({title:t,description:e,primaryMetadata:s,shareButton:r,favoriteButton:a,trailerButton:o})=>{const c=pe()===z.xs,l=typeof t=="string"?"h1":"div";return n.jsxs("div",{className:ds.details,"data-testid":void 0,children:[n.jsx(l,{className:ds.title,children:t}),n.jsxs("div",{className:ds.inlinePlayerMetadata,children:[n.jsx("div",{className:ds.primaryMetadata,children:s}),n.jsxs("div",{className:ds.buttonBar,children:[o,a,r]})]}),c?n.jsx(cd,{text:e,className:ds.description}):n.jsx(Hs,{markdownString:e,className:ds.description})]})},Zx="_listItem_1hb3b_1",eb="_poster_1hb3b_20",tb="_posterImage_1hb3b_39",sb="_visible_1hb3b_48",nb="_activeLabel_1hb3b_58",rb="_title_1hb3b_90",ab="_titleContainer_1hb3b_104",ob="_scheduledStart_1hb3b_109",ib="_tags_1hb3b_120",cb="_lock_1hb3b_127",lb="_scheduled_1hb3b_109",db="_tag_1hb3b_120",ub="_live_1hb3b_155",hb="_progressContainer_1hb3b_159",mb="_progressBar_1hb3b_169",Ce={listItem:Zx,poster:eb,posterImage:tb,visible:sb,activeLabel:nb,title:rb,titleContainer:ab,scheduledStart:ob,tags:ib,lock:cb,scheduled:lb,tag:db,live:ub,progressContainer:hb,progressBar:mb};function pb({onHover:t,progress:e,activeLabel:s,item:r,url:a,loading:o=!1,isActive:i=!1,isLocked:c=!0}){const{title:l,duration:d,seasonNumber:u,episodeNumber:h,cardImage:p,mediaStatus:g,scheduledStart:f}=r,{t:y,i18n:{language:v}}=I("common"),[_,b]=m.useState(!1),x=L(Ce.posterImage,{[Ce.visible]:_}),P=il(r),w=g===Ut.LIVE||ll(r),j=g===Ut.SCHEDULED,S=()=>{if(o||!l)return null;if(P)return n.jsx("div",{className:Ce.tag,children:y("video:series")});if(h)return n.jsx("div",{className:Ce.tag,children:Qn(u,h)});if(d)return n.jsx("div",{className:Ce.tag,children:pa(d,{minutesAbbreviation:y("common:abbreviation.minutes")})});if(w)return n.jsx("div",{className:L(Ce.tag,Ce.live),children:y("live")});if(j)return n.jsxs("div",{className:Ce.tag,children:[n.jsx(V,{icon:Pa,className:Ce.scheduled}),y("scheduled")]})};return n.jsxs(dn,{role:"button",to:a,className:Ce.listItem,onMouseEnter:t,tabIndex:0,"data-testid":void 0,children:[n.jsxs("div",{className:Ce.titleContainer,children:[n.jsx("h3",{className:Ce.title,children:l}),!!f&&n.jsx("div",{className:Ce.scheduledStart,children:Wn(f,v)})]}),n.jsxs("div",{className:Ce.poster,children:[n.jsx(Ws,{className:x,image:p,onLoad:()=>b(!0),width:320,alt:""}),n.jsxs("div",{className:Ce.tags,children:[c&&n.jsx("div",{className:L(Ce.tag,Ce.lock),"aria-label":y("card_lock"),children:n.jsx(V,{icon:Ca})}),S()]}),i&&n.jsx("div",{className:Ce.activeLabel,children:s}),e?n.jsx("div",{className:Ce.progressContainer,children:n.jsx("div",{className:Ce.progressBar,style:{width:`${Math.round(e*100)}%`}})}):null]})]})}const fb=m.memo(pb),gb="_container_w9k9j_1",_b="_content_w9k9j_6",yb="_list_w9k9j_13",Er={container:gb,content:_b,list:yb},Tc=()=>{};function ud({playlist:t,header:e,onListItemHover:s,isLoading:r=!1,watchHistory:a,activeMediaId:o,activeLabel:i,className:c,accessModel:l,isLoggedIn:d,hasSubscription:u,hasMore:h,loadMore:p=Tc,getUrl:g}){return n.jsxs("div",{className:L(Er.container,!!c&&c),"data-testid":void 0,children:[!!e&&e,n.jsx("div",{className:Er.content,children:n.jsx(sa,{element:"ul",pageStart:0,loadMore:p??Tc,hasMore:h??!1,className:Er.list,loader:n.jsx(Ea,{},"loader"),getScrollParent:ga,useWindow:!1,children:t?.playlist?.map(f=>n.jsx("li",{children:n.jsx(fb,{url:g(f),progress:a?a[f.mediaid]:void 0,onHover:()=>s&&s(f),loading:r,isActive:o===f.mediaid,activeLabel:i,isLocked:Yn(l,d,u,f),item:f})},f.mediaid))})})]})}const vb="_videoInlineLayout_1o3za_1",xb="_player_1o3za_29",bb="_videoDetailsInline_1o3za_53",wb="_relatedVideosList_1o3za_58",Sb="_relatedVideosListHeader_1o3za_62",jb="_relatedVideos_1o3za_58",Cb="_relatedVideosGrid_1o3za_89",Pb="_inlineLayout_1o3za_96",Eb="_relatedVideosGridTitle_1o3za_112",kb="_relatedVideosListTitle_1o3za_121",Ib="_filters_1o3za_129",Nb="_filtersInline_1o3za_135",Ab="_filterMetadata_1o3za_140",Je={videoInlineLayout:vb,player:xb,videoDetailsInline:bb,relatedVideosList:wb,relatedVideosListHeader:Sb,relatedVideos:jb,relatedVideosGrid:Cb,inlineLayout:Pb,relatedVideosGridTitle:Eb,relatedVideosListTitle:kb,filters:Ib,filtersInline:Nb,filterMetadata:Ab},La=({inlineLayout:t,player:e,playlist:s,accessModel:r,isLoading:a,isLoggedIn:o,item:i,hasSubscription:c,title:l,description:d,image:u,primaryMetadata:h,secondaryMetadata:p,shareButton:g,favoriteButton:f,startWatchingButton:y,trailerButton:v,relatedTitle:_,watchHistory:b,activeLabel:x,filters:P,setFilter:w,filterMetadata:j,currentFilter:S="",defaultFilterLabel:C="",children:E,hasMore:A,loadMore:T,getURL:$})=>{const U=pe(),F=U===z.sm||U===z.md,N=P&&P.length>1,k=N&&w,O=ce=>n.jsxs("div",{className:L(Je.filters,{[Je.filtersInline]:t}),children:[!!j&&t&&n.jsx("span",{className:Je.filterMetadata,children:j}),k&&n.jsx(od,{name:"season",value:S,defaultLabel:C,options:P,setValue:w,forceDropdown:ce})]}),Y=(ce=!0)=>s?ce?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:L(Je.relatedVideosGrid,{[Je.inlineLayout]:t}),children:[n.jsx("h2",{className:Je.relatedVideosGridTitle,children:_||""}),N&&O(t)]}),n.jsx(zs,{playlist:s,isLoading:a,watchHistory:b,accessModel:r,isLoggedIn:o,currentCardItem:i,currentCardLabel:x,hasSubscription:c,hasMore:A,loadMore:T,getUrl:$})]}):n.jsx("div",{className:Je.relatedVideosList,children:n.jsx(ud,{header:n.jsxs("div",{className:Je.relatedVideosListHeader,children:[l&&n.jsx("h2",{className:Je.relatedVideosListTitle,children:_}),N&&O(!0)]}),activeMediaId:i?.mediaid,activeLabel:x,playlist:s,watchHistory:b,isLoading:a,accessModel:r,isLoggedIn:o,hasSubscription:c,hasMore:A,loadMore:T,getUrl:$})}):null;return t?n.jsxs("div",{className:Je.videoInlineLayout,"data-testid":void 0,children:[n.jsx("div",{className:Je.player,children:e}),n.jsx("div",{className:Je.videoDetailsInline,children:n.jsx(dd,{title:p||l,live:i?.duration===0,description:d,primaryMetadata:h,shareButton:g,favoriteButton:f,trailerButton:v})}),Y(F),E]}):n.jsxs(ld,{title:l,description:d,image:u,startWatchingButton:y,favoriteButton:f,trailerButton:v,shareButton:g,primaryMetadata:h,secondaryMetadata:p,children:[s&&n.jsx("section",{className:Je.relatedVideos,children:Y(!0)}),E,e]})},Tb=3e5,Lb=(t,e)=>{const s=m.useRef(null),r=W(Ms),{features:a}=H(d=>d.config),i=!!a?.continueWatchingList,c=m.useCallback(()=>{if(!i||!s.current)return;const{item:d,seriesItem:u,progress:h}=s.current;r.saveItem(d,u,h),s.current=null},[i,r]),l=ee(({position:d,duration:u})=>{if(u<0)return;const h=Number((d/u).toFixed(5));!isNaN(h)&&isFinite(h)&&(s.current={item:t,seriesItem:e,progress:h,timestamp:s.current?.timestamp||Date.now()},Date.now()-s.current.timestamp>Tb&&c())});return m.useEffect(()=>()=>{c()},[t?.mediaid,c]),m.useLayoutEffect(()=>{const d=()=>document.visibilityState==="hidden"&&c();return window.addEventListener("pagehide",c),window.addEventListener("visibilitychange",d),()=>{window.removeEventListener("pagehide",c),window.removeEventListener("visibilitychange",d)}},[c]),{saveWatchProgress:c,handleTimeUpdate:l}},$b=(t,e)=>{const{features:s}=H(d=>d.config),a=!!s?.continueWatchingList,{saveWatchProgress:o,handleTimeUpdate:i}=Lb(t,e),c=_t(d=>t&&a?d.getItem(t):void 0);return{startTime:m.useMemo(()=>{const d=c?.progress;return d&&d>Zt.Min&&d<Zt.Max?d*t.duration:0},[t.duration,c?.progress]),saveWatchProgress:o,handleTimeUpdate:i,watchHistoryEnabled:a}},Ob=(t,e)=>{const s=r=>{if(!t)return r;const a=[t,e].filter(Boolean).join("-");return{...r,allSources:void 0,sources:r.sources.map(o=>({...o,file:ye(o.file,{t:a})}))}};return ee(async r=>s(r))},Lc=60*1e3*20,Mb=({adScheduleId:t,enabled:e})=>{const s=W(xe),{isLoading:r,data:a}=qe(["ad-schedule",t],async()=>s.getAdSchedule(t),{enabled:e&&!!t,cacheTime:Lc,staleTime:Lc});return{isLoading:r,data:a}},Db=({mediaId:t})=>{const{adSchedule:e,adConfig:s,adScheduleUrls:r,adDeliveryMethod:a}=H(d=>d.config),o=!!s&&a!=="ssai",{data:i,isLoading:c}=Mb({adScheduleId:e,enabled:!!e}),l=o?{client:"vast",schedule:ye(r?.xml||"",{media_id:t})}:void 0;return{isLoading:o?!1:c,data:o?l:i}};function Rb(t){const e=W(yl),{i18n:s}=I(),{language:r}=s,a=pl(t);return qe(["media-signed",t.mediaid,r],async()=>e.getSignedMedia(t.mediaid,r,{},a),{retry:2,retryDelay:1e3,keepPreviousData:!1})}const Fb=({item:t,baseUrl:e,config:s,user:r,passport:a})=>{const{sources:o,mediaid:i}=t,{adConfig:c,siteId:l,adDeliveryMethod:d}=s,u=r?.id,h=!!c&&d==="ssai";return o.map(p=>{const g=new URL(p.file),f=g.searchParams.has("exp")&&g.searchParams.has("sig")||p.drm;return h&&!f&&(g.href=`${e}/v2/sites/${l}/media/${i}/ssai.${Nu.dash===p.type?"mpd":"m3u8"}`,g.searchParams.set("ad_config_id",c)),u&&g.searchParams.set("user_id",u),a&&Bb(p,a),p.file=g.toString(),p})};function Bb(t,e){function s(r,a){const o=new URL(r);return o.searchParams.has("token")||o.searchParams.set("passport",a),o.toString()}return t?.drm&&(t.drm?.playready?.url&&(t.drm.playready.url=s(t.drm.playready.url,e)),t.drm?.widevine?.url&&(t.drm.widevine.url=s(t.drm.widevine.url,e)),t.drm?.fairplay?.processSpcUrl&&(t.drm.fairplay.processSpcUrl=s(t.drm.fairplay.processSpcUrl,e))),t}const Ub=({item:t,baseUrl:e})=>{const s=H(o=>o.config),r=B(o=>o.user),a=Fn(o=>o.passport);return m.useMemo(()=>Fb({item:t,baseUrl:e,config:s,user:r,passport:a}),[t,e,s,r,a])},Hb="_container_79xjy_1",Wb={container:Hb},Vb=({item:t,adsData:e,onReady:s,onPlay:r,onPause:a,onTime:o,onSeek:i,onSeeked:c,onComplete:l,onUserActive:d,onUserInActive:u,onBeforePlay:h,onFirstFrame:p,onRemove:g,onPlaylistItem:f,onPlaylistItemCallback:y,onNext:v,onAdImpression:_,onBackClick:b,feedId:x,startTime:P=0,autostart:w})=>{const j=m.useRef(null),S=m.useRef(),C=m.useRef(!1),E=m.useRef(!1),[A,T]=m.useState(!!window.jwplayer),$=m.useRef(P),U=Ub({item:t,baseUrl:M.APP_API_BASE_URL}),{settings:F}=H(xt=>xt),N=F.playerId,k=F.playerLicenseKey,O=ee(h),Y=ee(r),ce=ee(a),ne=ee(o),Te=ee(l),ut=ee(i),Se=ee(c),fe=ee(_),$e=ee(d),Oe=ee(u),Qe=ee(()=>{S.current?.getContainer()?.querySelector('.jw-controlbar [aria-label="Play"], .jw-button-container [aria-label="Pause"]')?.focus(),p?.()}),G=ee(g),be=ee(f),ze=ee(y),Xe=ee(v),X=ee(()=>{E.current=!0,b?.()}),Ht=ee(()=>s&&s(S.current)),as=m.useCallback(()=>{S.current?.on("ready",Ht),S.current?.on("beforePlay",O),S.current?.on("complete",Te),S.current?.on("play",Y),S.current?.on("pause",ce),S.current?.on("time",ne),S.current?.on("seek",ut),S.current?.on("seeked",Se),S.current?.on("adImpression",fe),S.current?.on("userActive",$e),S.current?.on("userInactive",Oe),S.current?.on("firstFrame",Qe),S.current?.on("remove",G),S.current?.on("playlistItem",be),S.current?.on("nextClick",Xe),S.current?.on("backClick",X),S.current?.setPlaylistItemCallback(ze)},[Ht,O,Te,Y,ce,ne,ut,Se,fe,$e,Oe,Qe,G,be,Xe,ze,X]),Wt=m.useCallback(()=>{S.current?.off("ready"),S.current?.off("beforePlay"),S.current?.off("complete"),S.current?.off("play"),S.current?.off("pause"),S.current?.off("userActive"),S.current?.off("userInactive"),S.current?.off("firstFrame")},[]);return m.useEffect(()=>{if(!window.jwplayer&&!C.current){C.current=!0;const xt=`${M.APP_API_BASE_URL}/libraries/${N}.js`;wm(xt).then(()=>{T(!0),C.current=!1})}},[N]),m.useEffect(()=>{$.current=P},[P]),m.useEffect(()=>{const xt=()=>{if(!t||!S.current)return;const ht=S.current?.getPlaylistItem();if(ht&&ht.mediaid===t.mediaid){rl("Player","Calling loadPlaylist with the same item, check the dependencies");return}typeof w<"u"&&S.current?.setConfig({autostart:w}),S.current.load([Bi({...t,starttime:$.current,feedid:x})])},os=()=>{if(!window.jwplayer||!j.current)return;S.current=window.jwplayer(j.current);const ht={advertising:{...e,showCountdown:!0},timeSlider:{showAdMarkers:!1},aspectratio:!1,controls:!0,displaytitle:!1,displayHeading:!1,displaydescription:!1,floating:{mode:"never"},height:"100%",mute:!1,playbackRateControls:!0,pipIcon:"disabled",playlist:[Bi({...t,starttime:$.current,feedid:x,sources:U})],repeat:!1,cast:M.APP_CHROMECAST_APPLICATION_ID?{appid:M.APP_CHROMECAST_APPLICATION_ID}:{},stretching:"uniform",width:"100%"};typeof w<"u"&&(ht.autostart=w),k&&(ht.key=k),S.current.setup(ht),as()};if(S.current)return xt();A&&os()},[A,t,Wt,as,N,w,e,k,U,x]),m.useEffect(()=>()=>{if(S.current){if(Wt(),E.current){E.current=!1;return}S.current.remove(),S.current=void 0}},[Wt,E]),n.jsx("div",{className:Wb.container,"data-testid":void 0,children:n.jsx("div",{ref:j})})},qb="_error_4iaxi_1",zb="_title_4iaxi_11",$c={error:qb,title:zb};var Un=(t=>(t.GEO_BLOCKED="GEO_BLOCKED",t.UNAUTHORIZED="UNAUTHORIZED",t.UNKNOWN="UNKNOWN",t))(Un||{});const Gb=({error:t})=>{const{t:e}=I("video");return n.jsxs("div",{className:$c.error,children:[n.jsx("h2",{className:$c.title,children:e(`player_error.${t.toLowerCase()}.title`)}),n.jsx("p",{children:e(`player_error.${t.toLowerCase()}.description`)})]})},$a=({item:t,seriesItem:e,feedId:s,onPlay:r,onPause:a,onComplete:o,onUserActive:i,onUserInActive:c,onNext:l,onBackClick:d,liveEndDateTime:u,liveFromBeginning:h,liveStartDateTime:p,autostart:g})=>{const{data:f,isLoading:y}=Db({mediaId:t?.mediaid}),{data:v,isLoading:_,error:b}=Rb(t),[x,P]=m.useState(),w=$b(t,e),j=F=>{P(F)},S=()=>{h&&x?.seek(0)},C=F=>{w.handleTimeUpdate(F)},E=()=>{w.saveWatchProgress(),r?.()},A=()=>{w.saveWatchProgress(),a?.()},T=()=>{o?.()},$=()=>{w.saveWatchProgress()},U=Ob(p,u);if(_||y)return n.jsx(ve,{inline:!0});if(!v||b instanceof Error){let F=Un.UNKNOWN;return b instanceof Error&&(b.message.toLowerCase()==="access blocked"&&(F=Un.GEO_BLOCKED),b.message.toLowerCase()==="unauthorized"&&(F=Un.UNAUTHORIZED)),n.jsx(Gb,{error:F})}return n.jsx(Vb,{feedId:s,item:v,adsData:f,onReady:j,onFirstFrame:S,onPlay:E,onPause:A,onTime:C,onComplete:T,onUserActive:i,onUserInActive:c,onRemove:$,onNext:l,onBackClick:d,onPlaylistItemCallback:U,startTime:w.startTime,autostart:g})},Jb="_inlinePlayer_g5xl8_1",Yb="_paywall_g5xl8_10",Kb="_poster_g5xl8_26",Qb="_lock_g5xl8_47",Xb="_title_g5xl8_62",Zb="_text_g5xl8_88",Ns={inlinePlayer:Jb,paywall:Yb,poster:Kb,lock:Qb,title:Xb,text:Zb},tr=({item:t,seriesItem:e,onPlay:s,onPause:r,onComplete:a,feedId:o,liveStartDateTime:i,liveEndDateTime:c,liveFromBeginning:l,startWatchingButton:d,isLoggedIn:u,isEntitled:h,autostart:p,playable:g=!0,hasMediaOffers:f})=>{const y=H(w=>w.config.siteName),{t:v}=I(),_=se(),b=re(),x=()=>{_(q(b,"login"))},P=v(f?"video:buy_to_start_watching":"video:sign_up_to_start_watching");return n.jsxs("div",{className:Ns.inlinePlayer,children:[n.jsx(Vs,{open:!g||!h,children:n.jsxs("div",{className:Ns.paywall,children:[n.jsx(Ws,{className:Ns.poster,image:t.backgroundImage,alt:t.title,width:1280}),!h&&n.jsxs(n.Fragment,{children:[n.jsx(V,{icon:Ca,className:Ns.lock}),n.jsx("h2",{className:Ns.title,children:P}),n.jsx("span",{className:Ns.text,children:v("account:choose_offer.watch_this_on_platform",{siteName:y})}),d,!u&&n.jsx(D,{onClick:x,label:v("common:sign_in")})]})]})}),h&&g&&n.jsx($a,{item:t,seriesItem:e,feedId:o,autostart:p,onPlay:s,onPause:r,onComplete:a,liveEndDateTime:c,liveFromBeginning:l,liveStartDateTime:i})]})},ew="_cinemaContainer_b92ry_1",tw="_cinema_b92ry_1",sw="_overlayFade_b92ry_13",nw="_playerOverlay_b92ry_18",rw="_playerContent_b92ry_36",aw="_backButton_b92ry_46",ow="_title_b92ry_58",iw="_metaContainer_b92ry_74",cw="_primaryMetadata_b92ry_79",lw="_secondaryMetadata_b92ry_93",Pt={cinemaContainer:ew,cinema:tw,overlayFade:sw,playerOverlay:nw,playerContent:rw,backButton:aw,title:ow,metaContainer:iw,primaryMetadata:cw,secondaryMetadata:lw},vn=({open:t,item:e,seriesItem:s,title:r,primaryMetadata:a,secondaryMetadata:o,onPlay:i,onPause:c,onComplete:l,onClose:d,onNext:u,feedId:h,liveStartDateTime:p,liveEndDateTime:g,liveFromBeginning:f})=>{const{t:y}=I(),[v,_]=m.useState(!1),[b,x]=m.useState(!1),[P,w]=m.useState(!0),j=m.useCallback(()=>{_(!0),i?.()},[i]),S=m.useCallback(()=>{_(!1),c?.()},[c]),C=m.useCallback(()=>{l?.()},[l]),E=m.useCallback(()=>{u?.()},[u]),A=m.useCallback(()=>w(!0),[]),T=m.useCallback(()=>w(!1),[]);return m.useEffect(()=>{t&&w(!0)},[t]),n.jsx(pn,{open:t,animationContainerClassName:Pt.cinemaContainer,onClose:d,"aria-label":y("videoplayer"),children:n.jsxs("div",{className:Pt.cinema,children:[n.jsx(Vs,{className:Pt.overlayFade,open:!v||P||b,keepMounted:!0,children:n.jsx("div",{className:Pt.playerOverlay,onFocus:()=>x(!0),onBlur:()=>x(!1),children:n.jsxs("div",{className:Pt.playerContent,children:[n.jsx(Re,{"aria-label":y("common:back"),onClick:d,className:Pt.backButton,children:n.jsx(V,{icon:Rl})}),n.jsxs("div",{children:[n.jsx("h1",{className:Pt.title,children:r}),n.jsxs("div",{className:Pt.metaContainer,children:[o&&n.jsx("div",{className:Pt.secondaryMetadata,children:o}),n.jsx("div",{className:Pt.primaryMetadata,children:a})]})]})]})})}),n.jsx($a,{item:e,seriesItem:s,feedId:h,autostart:!0,onPlay:j,onPause:S,onComplete:C,onUserActive:A,onUserInActive:T,onNext:E,onBackClick:d,liveEndDateTime:g,liveFromBeginning:f,liveStartDateTime:p})]})})},dw="_container_98mgl_1",uw="_playerOverlay_98mgl_14",hw="_title_98mgl_25",kr={container:dw,playerOverlay:uw,title:hw},xn=({item:t,open:e,title:s,onClose:r})=>{const[a,o]=m.useState(!1),[i,c]=m.useState(!0),l=m.useCallback(()=>o(!0),[]),d=m.useCallback(()=>o(!1),[]),u=m.useCallback(()=>c(!0),[]),h=m.useCallback(()=>c(!1),[]);return t?n.jsx(pn,{open:e,onClose:r,"aria-labelledby":"trailer-modal-title",centered:!0,children:n.jsxs("div",{className:kr.container,children:[n.jsx($a,{item:t,onPlay:l,onPause:d,onComplete:r,onUserActive:u,onUserInActive:h,autostart:!0}),n.jsxs(Vs,{open:!a||i,keepMounted:!0,children:[n.jsx("div",{className:kr.playerOverlay,children:n.jsx("h1",{id:"trailer-modal-title",className:kr.title,children:s})}),n.jsx(Nl,{onClick:r})]})]})}):null},mw=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})),pw=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z"})),fw=t=>{const e=document.activeElement,s=document.createElement("input");s.style.zIndex="-10",s.style.position="absolute",s.style.left="-1000",s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),s.blur(),document.body.removeChild(s),e?.focus()},Gs=({title:t,description:e,url:s,className:r})=>{const{t:a}=I(),o=pe(),[i,c]=m.useState(!1),l=async()=>{if(typeof navigator.share=="function"){await navigator.share({title:t,text:e,url:s});return}fw(window.location.href),c(!0),setTimeout(()=>c(!1),2e3)};return n.jsx(D,{label:a(i?"video:copied_url":"video:share"),startIcon:i?n.jsx(V,{icon:mw}):n.jsx(V,{icon:pw}),onClick:l,active:i,fullWidth:o<z.md,className:r})},gw=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"})),_w="_title_gkrmh_1",yw="_body_gkrmh_8",Oc={title:_w,body:yw},Oa=({open:t,message:e,onClose:s,isSuccess:r,actionsOverride:a,titleOverride:o})=>{const{t:i}=I("common"),c=dt("alert-heading");return n.jsxs(ya,{open:t,onClose:s,role:"alertdialog","aria-modal":"true","aria-labelledby":c,children:[n.jsx("h2",{id:c,className:Oc.title,children:o??i(r?"alert.success":"alert.title")}),n.jsx("p",{className:Oc.body,children:e}),a??n.jsx(D,{label:i("alert.close"),variant:"outlined",onClick:s,fullWidth:!0})]})},bn=({item:t,className:e})=>{const{t:s}=I(),r=pe(),a=W(fs),{isFavorite:o,clearWarning:i,warning:c}=pt(d=>({isFavorite:!!t&&d.hasItem(t),clearWarning:d.clearWarning,warning:d.warning})),l=m.useCallback(async()=>{await a.toggleFavorite(t)},[t,a]);return m.useEffect(()=>()=>i(),[i]),n.jsxs(n.Fragment,{children:[n.jsx(D,{label:s("video:favorite"),"aria-label":s("video:favorite"),startIcon:o?n.jsx(V,{icon:Ia}):n.jsx(V,{icon:gw}),onClick:l,"aria-pressed":o,color:o?"primary":"default",fullWidth:r<z.md,className:e}),n.jsx(Oa,{open:c!==null,message:c,onClose:i})]})},vw="_loading_1bc17_1",xw={loading:vw},ws=()=>n.jsx("div",{className:xw.loading,children:n.jsx(vs,{})}),bw="_separator_14n07_1",ww={separator:bw},ts=({attributes:t,separator:e=""})=>n.jsx("div",{children:t.map((s,r)=>n.jsxs(he.Fragment,{children:[n.jsx("span",{children:s}),r<t.length-1&&n.jsx("span",{className:ww.separator,"aria-hidden":"true",children:e})]},s))});function Vn(t,e=!1){if(!t)return"";const s=new Date(t?t*1e3:0),r=s.getUTCHours(),a=s.getUTCMinutes(),o=s.getUTCSeconds();if(!e)return s.toISOString();let i="PT";return r>0&&(i+=r+"H"),a>0&&(i+=a+"M"),o>0&&(i+=o+"S"),i}const Sw=()=>{const t=new Date(Date.UTC(2022,6,20,18,0,0));return/am|pm/.test(t.toLocaleTimeString())},jw=t=>(t?.playlist||[]).reduce((e,s)=>e.some(r=>r?.value===s?.seasonNumber)?e:e.concat(s.seasonNumber?[{label:me.t("video:season_number_filter_template",{seasonNumber:s.seasonNumber}),value:s.seasonNumber}]:[]),[]).slice().sort(),Cw=(t,e)=>{if(t)return e===""?t:{...t,playlist:t.playlist.filter(({seasonNumber:s})=>s===e)}},Pw=(t,e)=>{if(!t||!e)return;const s=e?.playlist?.findIndex(({mediaid:r})=>r===t.mediaid);return e?.playlist?.[s+1]},Ew=(t,e)=>{if(e)return e.playlist.filter(s=>s.seasonNumber===t?.seasonNumber)?.length},kw=(t,e)=>({"@type":"TVSeries","@id":`${M.APP_PUBLIC_URL}/s/${e}`,name:t.title,numberOfEpisodes:String(t.playlist.length),numberOfSeasons:String(t.playlist.reduce(function(r,a){return!a.seasonNumber||r.includes(a.seasonNumber)?r:r.concat(a.seasonNumber)},[]).length)}),Iw=(t,e,s,r)=>{const a=`${M.APP_PUBLIC_URL}${hs({episodeId:e?.mediaid,seriesId:r})}`,o=kw(t,r);return JSON.stringify(e?{"@context":"http://schema.org/","@type":"TVEpisode","@id":a,episodeNumber:s?.episodeNumber,seasonNumber:s?.seasonNumber,name:e.title,uploadDate:Vn(e.pubdate),partOfSeries:o}:o)},Nw=()=>{const t=pe(),{t:e}=I("video"),[s,r]=m.useState(!1),a=se(),i=Rs().id||"",c=Le("play")==="1",l=Le("r"),d=Le("e"),{isLoading:u,data:h,isError:p}=gn(i,{},!0,!1),{isLoading:g,data:f}=es(d||""),{isLoading:y,data:v}=es(f?.trailerId||""),_=m.useMemo(()=>({episodeNumber:f?.episodeNumber||"0",seasonNumber:f?.seasonNumber||"0"}),[f]),b=f||h,x=b?.image||"",{config:P,accessModel:w}=H(({config:Ge,accessModel:is})=>({config:Ge,accessModel:is}),Q),{features:j,siteName:S,custom:C}=P,E=!!j?.favoritesList,A=!!C?.inlinePlayer,T=m.useMemo(()=>jw(h),[h]),[$,U]=m.useState(void 0),F=m.useMemo(()=>h?.playlist?.[0],[h]),N=m.useMemo(()=>Cw(h,$),[h,$]),k=Ew(f,h),O=m.useMemo(()=>Pw(f,h),[f,h]),Y=_t(Ge=>Ge.getDictionaryWithEpisodes()),{user:ce,subscription:ne}=B(({user:Ge,subscription:is})=>({user:Ge,subscription:is}),Q),{isEntitled:Te,mediaOffers:ut}=qs(f||F),Se=!!ut.length,fe=!!ce,$e=!!ne,Oe=()=>f&&a(hs({episodeId:f.mediaid,seriesId:i,play:!1,playlistId:l})),Qe=Ge=>h?hs({episodeId:Ge.mediaid,seriesId:i,play:!1,playlistId:l}):"",G=m.useCallback(async()=>{a(hs({episodeId:O?.mediaid,seriesId:i,play:!!O,playlistId:l}))},[a,O,i,l]);m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0}),document.querySelector("#video-details button")?.focus()},[f]),m.useEffect(()=>{u||g||$===void 0&&U(parseInt(_?.seasonNumber,10)?_?.seasonNumber:T?.[0]?.value||"")},[_,$,u,g,T]);const be=u||g;if(be)return n.jsx(ws,{});if(p||!h||!b||!F)return n.jsx(Ke,{title:e("series_error")});const ze=`${b.title} - ${S}`,Xe=b?.description||"",X=`${M.APP_PUBLIC_URL}${hs({episodeId:f?.mediaid,seriesId:i})}`,Ht=b.backgroundImage||void 0,as=f?n.jsx(ts,{attributes:Na(f,{episodesLabel:e("video:total_episodes",{count:h?.playlist?.length}),hoursAbbreviation:e("common:abbreviation.hours"),minutesAbbreviation:e("common:abbreviation.minutes")})}):n.jsx(ts,{attributes:wx(h,e("video:total_episodes",{count:h?.playlist?.length}))}),Wt=_&&f&&n.jsxs(n.Fragment,{children:[n.jsx("strong",{children:Qn(_.seasonNumber,_.episodeNumber)})," - ",f.title]}),xt=_&&` ${e("video:season")} ${_.seasonNumber}/${T?.length} - ${e("video:episode")} ${_.episodeNumber}/${k}`,os=n.jsx(Gs,{title:b?.title,description:Xe,url:X}),ht=n.jsx(bs,{item:f||F,playUrl:hs({episodeId:f?.mediaid||F?.mediaid,seriesId:i,play:!0,playlistId:l})},d),Ot=E&&n.jsx(bn,{item:f||F}),wn=(!!v||y)&&n.jsx(D,{label:e("video:trailer"),"aria-label":e("video:watch_trailer"),startIcon:n.jsx(V,{icon:yn}),onClick:()=>r(!0),active:s,fullWidth:t<z.md,disabled:!v});return n.jsxs(he.Fragment,{children:[n.jsxs(Tt,{children:[n.jsx("title",{children:ze}),n.jsx("link",{rel:"canonical",href:X}),n.jsx("meta",{name:"description",content:Xe}),n.jsx("meta",{property:"og:description",content:Xe}),n.jsx("meta",{property:"og:title",content:ze}),n.jsx("meta",{property:"og:type",content:f?"video.episode":"video.series"}),x&&n.jsx("meta",{property:"og:image",content:x?.replace(/^https:/,"http:")}),x&&n.jsx("meta",{property:"og:image:secure_url",content:x?.replace(/^http:/,"https:")}),x&&n.jsx("meta",{property:"og:image:width",content:x?"720":""}),x&&n.jsx("meta",{property:"og:image:height",content:x?"406":""}),n.jsx("meta",{name:"twitter:title",content:ze}),n.jsx("meta",{name:"twitter:description",content:Xe}),x&&n.jsx("meta",{name:"twitter:image",content:x}),n.jsx("meta",{property:"og:video",content:X.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:X.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),b.tags?String(b.tags).split(",").map(Ge=>n.jsx("meta",{property:"og:video:tag",content:Ge},Ge)):null,h&&b?n.jsx("script",{type:"application/ld+json",children:Iw(h,f,_,i)}):null]}),n.jsx(La,{item:f,title:b.title,description:Xe,inlineLayout:A,primaryMetadata:as,secondaryMetadata:Wt,image:Ht,shareButton:os,favoriteButton:Ot,trailerButton:wn,startWatchingButton:ht,isLoading:be,accessModel:w,isLoggedIn:fe,hasSubscription:$e,playlist:N,relatedTitle:A?b.title:e("episodes"),setFilter:U,currentFilter:$,defaultFilterLabel:e("all_seasons"),activeLabel:e("current_episode"),watchHistory:Y,filterMetadata:xt,filters:T,getURL:Qe,player:A&&(f||F)?n.jsx(tr,{isLoggedIn:fe,item:f||F,onComplete:G,feedId:l??void 0,startWatchingButton:ht,isEntitled:Te,hasMediaOffers:Se,autostart:c||void 0}):n.jsx(vn,{open:c&&Te,onClose:Oe,item:f||F,title:f?.title||F.title,primaryMetadata:as,secondaryMetadata:Wt,onComplete:G,feedId:l??void 0})}),f&&n.jsx(xn,{item:v,title:`${f.title} - Trailer`,open:s,onClose:()=>r(!1)})]})};class Ma{defaultScreen=void 0;definitions=[];register(e,s){this.definitions.push({component:e,predicate:s})}registerByContentType(e,s){this.register(e,r=>!!r&&Bt(r,s))}registerDefault(e){this.defaultScreen=e}getScreen(e){const s=this.definitions.find(({predicate:r})=>r(e))?.component;if(s)return s;if(!this.defaultScreen)throw new Error("Default screen not defined");return this.defaultScreen}}const Aw="_mediaStaticPage_v6zr1_1",Tw={mediaStaticPage:Aw},Lw=({data:t})=>{const{config:e}=H(({config:o})=>({config:o}),Q),{siteName:s}=e,r=`${t.title} - ${s}`,a=t?`${M.APP_PUBLIC_URL}${ue({id:t.mediaid,title:t.title})}`:window.location.href;return m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0})},[t.mediaid]),n.jsxs(n.Fragment,{children:[n.jsxs(Tt,{children:[n.jsx("title",{children:r}),n.jsx("link",{rel:"canonical",href:a}),n.jsx("meta",{property:"og:title",content:r}),n.jsx("meta",{name:"twitter:title",content:r})]}),n.jsx("div",{className:Tw.mediaStaticPage,children:n.jsx(Hs,{markdownString:t.markdown||t.description})})]})};function hd(t,e,s){const{t:r}=I("common"),[a,o]=m.useState(!1),{config:i,accessModel:c}=H(({config:w,accessModel:j})=>({config:w,accessModel:j}),Q),{features:l}=i,d=!!l?.favoritesList,{isLoading:u,data:h}=es(t?.trailerId||""),{isLoading:p,data:g}=gn(l?.recommendationsPlaylist||"",{related_media_id:e}),f=m.useMemo(()=>{if(!e||!g)return;const w=g.playlist.findIndex(({mediaid:S})=>S===e);return g.playlist[w+1]},[e,g]),{isEntitled:y,mediaOffers:v}=qs(t),_=ue({id:t.mediaid,title:t.title,playlistId:s,play:!1}),b=ue({id:t.mediaid,title:t.title,playlistId:s,play:!0}),x=!!h||u,P=[...Na(t,{hoursAbbreviation:r("common:abbreviation.hours"),minutesAbbreviation:r("common:abbreviation.minutes")}),...t?.contentType?[t.contentType]:[]];return{playlist:g,isTrailerLoading:u,isPlaylistLoading:p,mediaOffers:v,movieURL:_,playUrl:b,nextItem:f,trailerItem:h,accessModel:c,hasTrailer:x,isFavoritesEnabled:d,isEntitled:y,playTrailer:a,primaryMetadata:P,setPlayTrailer:o}}function md(){const e=Rs().id||"",s=Le("play")==="1",r=Le("r");return{id:e,play:s,feedId:r}}function pd(t,e){const{config:s}=H(({config:c,accessModel:l})=>({config:c,accessModel:l}),Q),{features:r}=s,a=se(),o=()=>a(e),i=ee(()=>{t&&a(ue({id:t.mediaid,title:t.title,playlistId:r?.recommendationsPlaylist,play:!0}))});return{handleBack:o,handleComplete:i}}function fd(t){m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0}),document.querySelector("#video-details button")?.focus()},[t])}const Da=(t,e)=>{const{mediaid:s,title:r}=t,a=`${e}${ue({id:s,title:r})}`;return JSON.stringify({"@context":"http://schema.org/","@type":"VideoObject","@id":a,name:t.title,description:t.description,duration:Vn(t.duration,!0),thumbnailUrl:t.image,uploadDate:Vn(t.pubdate)})},$w=(t,e,s,r)=>({"@type":"TVSeries","@id":`${r}/m/${s}`,name:e.title,numberOfEpisodes:String(t?.episode_count||0),numberOfSeasons:String(t?.season_count||0)}),Ow=(t,e,s,r,a)=>{const o=`${s}/m/${t.series_id}?e=${r?.mediaid}`,i=$w(t,e,t.series_id,s);return JSON.stringify(r?{"@context":"http://schema.org/","@type":"TVEpisode","@id":o,episodeNumber:a?.episodeNumber||"0",seasonNumber:a?.seasonNumber||"0",name:r.title,uploadDate:Vn(r.pubdate),partOfSeries:i}:i)},gd=({data:t,canonicalUrl:e})=>{const{config:s}=H(({config:o,accessModel:i})=>({config:o,accessModel:i}),Q),{siteName:r}=s,a=`${t.title} - ${r}`;return n.jsxs(Tt,{children:[n.jsx("title",{children:a}),n.jsx("link",{rel:"canonical",href:e}),n.jsx("meta",{name:"description",content:t.description}),n.jsx("meta",{property:"og:description",content:t.description}),n.jsx("meta",{property:"og:title",content:a}),n.jsx("meta",{property:"og:type",content:"video.other"}),t.image&&n.jsx("meta",{property:"og:image",content:t.image?.replace(/^https:/,"http:")}),t.image&&n.jsx("meta",{property:"og:image:secure_url",content:t.image?.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:image:width",content:t.image?"720":""}),n.jsx("meta",{property:"og:image:height",content:t.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:a}),n.jsx("meta",{name:"twitter:description",content:t.description}),n.jsx("meta",{name:"twitter:image",content:t.image}),n.jsx("meta",{property:"og:video",content:e.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:e.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),t.tags?.split(",").map(o=>n.jsx("meta",{property:"og:video:tag",content:o},o)),t?n.jsx("script",{type:"application/ld+json",children:Da(t,M.APP_PUBLIC_URL)}):null]})},Mw="_title_1wz4k_1",Dw="_description_1wz4k_18",Rw="_metaContainer_1wz4k_22",Ir={title:Mw,description:Dw,metaContainer:Rw},Fw=({title:t,description:e,metadataComponent:s,formatComponent:r,definitionComponent:a})=>n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:Ir.title,children:t}),n.jsxs("div",{className:Ir.metaContainer,children:[r,s]}),e&&typeof e=="string"?n.jsx("p",{className:Ir.description,children:e}):e,a]}),Bw="_buttonBar_adq67_1",Uw="_roundButton_adq67_24",Hw="_rectangleButton_adq67_37",Nr={buttonBar:Bw,roundButton:Uw,rectangleButton:Hw},Ww=({cta:t,children:e,buttonClassOverride:s=!0})=>{const r=pe(),a=s?r<z.md?Nr.rectangleButton:Nr.roundButton:void 0,o=he.Children.toArray(e).filter(he.isValidElement);return n.jsxs("div",{className:Nr.buttonBar,children:[t,o.map(i=>he.cloneElement(i,{className:a}))]})},Vw="_infoSmallScreenReorder_wa432_1",qw={infoSmallScreenReorder:Vw},zw=({image:t,children:e})=>{const s=pe();return n.jsx("header",{id:"video-details",children:n.jsx(Aa,{image:t,infoClassName:s<z.md?qw.infoSmallScreenReorder:void 0,children:e})})},Gw="_relatedVideos_17aqc_1",Jw="_relatedVideosGrid_17aqc_15",Yw="_relatedVideosGridTitle_17aqc_28",Ar={relatedVideos:Gw,relatedVideosGrid:Jw,relatedVideosGridTitle:Yw},_d=({className:t,item:e,playlist:s,isLoading:r})=>{const{t:a}=I("video"),o=xs("title"),{config:i,accessModel:c}=H(({config:f,accessModel:y})=>({config:f,accessModel:y}),Q),{user:l,subscription:d}=B(({user:f,subscription:y})=>({user:f,subscription:y}),Q),{features:u}=i,h=f=>ue({id:f.mediaid,title:f.title,playlistId:u?.recommendationsPlaylist}),p=!!l,g=!!d;return s?n.jsxs("section",{className:L(Ar.relatedVideos,t),children:[n.jsx("div",{className:Ar.relatedVideosGrid,children:n.jsx("h2",{className:Ar.relatedVideosGridTitle,children:s?.[o]||s?.title||""})}),n.jsx(zs,{playlist:s,isLoading:r,accessModel:c,isLoggedIn:p,currentCardItem:e,currentCardLabel:a("current_video"),hasSubscription:g,getUrl:h})]}):null},Kw=({data:t,isLoading:e})=>{const{t:s}=I("video"),{id:r,play:a,feedId:o}=md(),{playlist:i,nextItem:c,playUrl:l,movieURL:d,trailerItem:u,hasTrailer:h,isFavoritesEnabled:p,isEntitled:g,playTrailer:f,primaryMetadata:y,isPlaylistLoading:v,setPlayTrailer:_}=hd(t,r,o),{handleBack:b,handleComplete:x}=pd(c,d),P=t?`${M.APP_PUBLIC_URL}${ue({id:t.mediaid,title:t.title})}`:window.location.href;return fd(r),n.jsxs(he.Fragment,{children:[n.jsx(gd,{canonicalUrl:P,data:t}),n.jsxs(zw,{image:t.backgroundImage,children:[n.jsx(Fw,{title:t.title,description:n.jsx(Ta,{description:t.description}),metadataComponent:n.jsx(ts,{attributes:y}),formatComponent:null,definitionComponent:null}),n.jsxs(Ww,{buttonClassOverride:!1,cta:n.jsx(bs,{item:t,playUrl:l},r),children:[h?n.jsx(D,{label:s("video:trailer"),"aria-label":s("video:watch_trailer"),startIcon:n.jsx(V,{icon:yn}),onClick:()=>_(!0),active:f,disabled:!u}):void 0,p?n.jsx(bn,{item:t}):void 0,n.jsx(Gs,{title:t.title,description:t.description,url:P})]})]}),n.jsx(_d,{playlist:i,item:t,isLoading:e||v}),n.jsx(vn,{open:a&&g,onClose:b,item:t,title:t.title,primaryMetadata:n.jsx(ts,{attributes:y}),onComplete:x,feedId:o??void 0,onNext:x}),n.jsx(xn,{item:u,title:`${t.title} - Trailer`,open:f,onClose:()=>_(!1)})]})},Qw="_relatedVideosList_1jlhg_1",Xw="_relatedVideosListHeader_1jlhg_5",Zw="_relatedVideosListTitle_1jlhg_39",Tr={relatedVideosList:Qw,relatedVideosListHeader:Xw,relatedVideosListTitle:Zw},e1=({item:t,playlist:e,isLoading:s})=>{const{t:r}=I("video"),a=xs("title"),{config:o,accessModel:i}=H(({config:g,accessModel:f})=>({config:g,accessModel:f}),Q),{user:c,subscription:l}=B(({user:g,subscription:f})=>({user:g,subscription:f}),Q),{features:d}=o,u=g=>ue({id:g.mediaid,title:g.title,playlistId:d?.recommendationsPlaylist}),h=!!c,p=!!l;return e?n.jsx("section",{className:Tr.relatedVideosList,children:n.jsx(ud,{header:n.jsx("div",{className:Tr.relatedVideosListHeader,children:n.jsx("h2",{className:Tr.relatedVideosListTitle,children:e?.[a]||e?.title})}),activeMediaId:t?.mediaid,activeLabel:r("current_video"),playlist:e,isLoading:s,accessModel:i,isLoggedIn:h,hasSubscription:p,getUrl:u})}):null},t1="_videoInlineLayout_afzow_1",s1="_player_afzow_29",n1="_videoDetailsInline_afzow_53",Lr={videoInlineLayout:t1,player:s1,videoDetailsInline:n1},r1=({player:t,videoDetails:e,children:s})=>n.jsxs("div",{className:Lr.videoInlineLayout,"data-testid":void 0,children:[n.jsx("div",{className:Lr.player,children:t}),n.jsx("div",{className:Lr.videoDetailsInline,children:e}),s]}),a1="_relatedVideosGrid_1klsy_1",o1={relatedVideosGrid:a1},i1=({data:t,isLoading:e})=>{const{t:s}=I("video"),{id:r,play:a,feedId:o}=md(),{playlist:i,nextItem:c,movieURL:l,trailerItem:d,mediaOffers:u,hasTrailer:h,isPlaylistLoading:p,isFavoritesEnabled:g,isEntitled:f,playTrailer:y,primaryMetadata:v,setPlayTrailer:_}=hd(t,r,o),{handleComplete:b}=pd(c,l),x=t?`${M.APP_PUBLIC_URL}${ue({id:t.mediaid,title:t.title})}`:window.location.href;fd(r);const P=pe(),w=P===z.sm||P===z.md,{user:j}=B(({user:C,subscription:E})=>({user:C,subscription:E}),Q),S=n.jsx(bs,{item:t,playUrl:ue({id:t.mediaid,title:t.title,playlistId:o,play:!0})},r);return n.jsxs(he.Fragment,{children:[n.jsx(gd,{canonicalUrl:x,data:t}),n.jsxs(r1,{player:n.jsx(tr,{isLoggedIn:!!j,item:t,onComplete:b,feedId:o??void 0,startWatchingButton:S,isEntitled:f,hasMediaOffers:!!u.length,autostart:a||void 0}),videoDetails:n.jsx(dd,{title:t.title,live:t?.duration===0,description:t.description,primaryMetadata:n.jsx(ts,{attributes:v}),shareButton:n.jsx(Gs,{title:t.title,description:t.description,url:x}),favoriteButton:g&&n.jsx(bn,{item:t}),trailerButton:h&&n.jsx(D,{label:s("video:trailer"),"aria-label":s("video:watch_trailer"),startIcon:n.jsx(V,{icon:yn}),onClick:()=>_(!0),active:y,fullWidth:P<z.md,disabled:!d})}),children:[w?n.jsx(_d,{className:o1.relatedVideosGrid,playlist:i,item:t,isLoading:e||p}):n.jsx(e1,{playlist:i,item:t,isLoading:e||p}),n.jsx(xn,{item:d,title:`${t.title} - Trailer`,open:y,onClose:()=>_(!1)})]})]})},yd=({data:t,isLoading:e})=>H(r=>!!r.config?.custom?.inlinePlayer)?n.jsx(i1,{data:t,isLoading:e}):n.jsx(Kw,{data:t,isLoading:e}),c1=t=>t&&"seasons"in t?t.seasons.map(e=>({label:e.season_title||String(e.season_number),value:String(e.season_number)})):[],l1=(t,e)=>(e?.seasons||[]).find(s=>s.season_number===Number(t?.seasonNumber))?.episode_count,d1=t=>{const e=W(xe),{data:s,isLoading:r,error:a}=qe(["series",t],async()=>await e.getSeries(t||""),{enabled:!!t,staleTime:_s,cacheTime:gs,retry:(o,i)=>i.code!==404&&o<2});return{data:s,isLoading:r,error:a}},u1=t=>{const{page:e,page_limit:s,total:r}=t;if(!(s*e>=r))return e},h1=(t,e,s)=>{const r=W(xe),{i18n:a}=I(),o=a.language,{data:i,fetchNextPage:c,isLoading:l,hasNextPage:d=!1}=ru([t,e,o],async({pageParam:u=0})=>{if(Number(e)){const h=await r.getSeasonWithEpisodes({seriesId:t,seasonNumber:Number(e),pageOffset:u,language:o});return{pagination:h.pagination,episodes:h.episodes}}else return await r.getEpisodes({seriesId:t,pageOffset:u,language:o})},{getNextPageParam:u=>u1(u?.pagination),enabled:s.enabled,staleTime:_s,cacheTime:gs});return{data:i?.pages||[],isLoading:l,fetchNextPage:c,hasNextPage:d}},vd=t=>{const e=W(xe),{isLoading:s,data:r}=qe(["seriesLookup",t],async()=>t?(await e.getSeriesByMediaIds([t]))?.[t]?.[0]:void 0,{staleTime:_s,cacheTime:gs,enabled:!!t});return{isLoading:s,data:r}},m1=({series:t,episodeId:e})=>{const s=W(xe),{i18n:r}=I(),a=r.language,{isLoading:o,data:i}=qe(["next-episode",t?.series_id,e,a],async()=>(await s.getEpisodes({seriesId:t?.series_id,pageLimit:1,afterId:e,language:a}))?.episodes?.[0],{staleTime:_s,cacheTime:gs,enabled:!!(t?.series_id&&e)});return{isLoading:o,data:i}},p1=({series:t})=>{const e=W(xe),{i18n:s}=I(),{isLoading:r,data:a}=qe(["first-episode",t?.series_id],async()=>(await e.getEpisodes({seriesId:t?.series_id,pageLimit:1,language:s.language}))?.episodes?.[0],{staleTime:_s,cacheTime:gs,enabled:!!t?.series_id});return{isLoading:r,data:a}},xd=({data:t})=>{const e=pe(),{t:s}=I("video"),[r,a]=m.useState(!1),[o,i]=Ds(),c=t.mediaid,l=o.get("play")==="1",d=o.get("r"),u=o.get("e"),{isLoading:h,data:p,error:g}=d1(c),{isLoading:f,data:y}=es(u||""),{isLoading:v,data:_}=es(y?.trailerId||""),{isLoading:b,data:x}=vd(u||void 0),{isLoading:P,data:w}=p1({series:p}),j=y||t,{config:S,accessModel:C}=H(({config:je,accessModel:sr})=>({config:je,accessModel:sr}),Q),{features:E,siteName:A,custom:T}=S,$=!!E?.favoritesList,U=!!T?.inlinePlayer,F=m.useMemo(()=>c1(p),[p]),[N,k]=m.useState(void 0),{data:O,fetchNextPage:Y,hasNextPage:ce}=h1(c,N,{enabled:N!==void 0&&!!p}),ne=m.useMemo(()=>x&&{episodeNumber:x?.episode_number?String(x.episode_number):"",seasonNumber:x?.season_number?String(x.season_number):""},[x]),Te=m.useMemo(()=>({title:t.title,description:t.description,feedid:p?.series_id,playlist:O?.flatMap(je=>je.episodes)||[]}),[t,p,O]),ut=l1(ne,p),{data:Se}=m1({series:p,episodeId:y?.mediaid||w?.mediaid}),fe=_t(je=>je.watchHistory),$e=_t(je=>je.getDictionaryWithEpisodes()),Oe=fe.find(je=>je?.seriesId===c&&je.progress>Zt.Min&&je.progress<Zt.Max),{user:Qe,subscription:G}=B(({user:je,subscription:sr})=>({user:je,subscription:sr}),Q),{isEntitled:be,mediaOffers:ze}=qs(y||w),Xe=!!ze.length,X=!!Qe,Ht=!!G,as=re(),Wt=je=>Il(as,{e:je.mediaid}),xt=m.useCallback(()=>{i({...o,e:y?.mediaid,r:d||""})},[i,o,y,d]),os=m.useCallback(async()=>{i({...o,e:(Se||y)?.mediaid,r:d||"",play:Se?"1":"0"})},[i,Se,y,d,o]),ht=m.useCallback(async()=>{y||i({...o,e:w?.mediaid,r:d||"",play:"1"})},[i,w,d,y,o]);m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0}),document.querySelector("#video-details button")?.focus()},[y]),m.useEffect(()=>{Oe&&!o.get("e")&&i({...o,e:Oe.mediaid,r:d||""},{replace:!0})},[Oe,i,o,d]),m.useEffect(()=>{if(!(h||f||b)){if(!u&&N===void 0){k(F[0]?.value||"");return}N===void 0&&ne&&k(ne.seasonNumber)}},[ne,N,h,f,b,F,u]);const Ot=y||w,wn=h||b||f||P,Ge=m.useMemo(()=>Ot&&n.jsx(bs,{item:Ot,onClick:()=>{i({...o,e:Ot.mediaid,r:d||"",play:"1"},{replace:!0})}},u),[u,Ot,i,o,d]);if(wn)return n.jsx(ws,{});if(g?.code===404){const je=hl(t,l,d);return n.jsx(Os,{to:je,replace:!0})}if(!t||!p||!Ot)return n.jsx(Ke,{title:s("series_error")});const is=`${j.title} - ${A}`,Sn=`${M.APP_PUBLIC_URL}${ue({id:t.mediaid,title:t.title,episodeId:y?.mediaid})}`,Ba=n.jsx(ts,{attributes:Na(j,{episodesLabel:s("video:total_episodes",{count:p.episode_count}),hoursAbbreviation:s("common:abbreviation.hours"),minutesAbbreviation:s("common:abbreviation.minutes")})}),Ua=ne&&y&&n.jsxs(n.Fragment,{children:[n.jsx("strong",{children:Qn(ne.seasonNumber,ne.episodeNumber)})," - ",y.title]}),Nd=ne&&` ${s("video:season")} ${ne.seasonNumber}/${F?.length} - ${s("video:episode")} ${ne.episodeNumber}/${ut}`,Ad=n.jsx(Gs,{title:j?.title,description:j.description,url:Sn}),Td=$&&n.jsx(bn,{item:t||w}),Ld=(!!_||v)&&n.jsx(D,{label:s("video:trailer"),"aria-label":s("video:watch_trailer"),startIcon:n.jsx(V,{icon:yn}),onClick:()=>a(!0),active:r,fullWidth:e<z.md,disabled:!_});return n.jsxs(he.Fragment,{children:[n.jsxs(Tt,{children:[n.jsx("title",{children:is}),n.jsx("link",{rel:"canonical",href:Sn}),n.jsx("meta",{name:"description",content:j.description}),n.jsx("meta",{property:"og:description",content:j.description}),n.jsx("meta",{property:"og:title",content:is}),n.jsx("meta",{property:"og:type",content:y?"video.episode":"video.series"}),j.image&&n.jsx("meta",{property:"og:image",content:j.image?.replace(/^https:/,"http:")}),j.image&&n.jsx("meta",{property:"og:image:secure_url",content:j.image?.replace(/^http:/,"https:")}),j.image&&n.jsx("meta",{property:"og:image:width",content:j.image?"720":""}),j.image&&n.jsx("meta",{property:"og:image:height",content:j.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:is}),n.jsx("meta",{name:"twitter:description",content:j.description}),n.jsx("meta",{name:"twitter:image",content:j.image}),n.jsx("meta",{property:"og:video",content:Sn.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:Sn.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),j.tags?.split(",").map(je=>n.jsx("meta",{property:"og:video:tag",content:je},je)),j?n.jsx("script",{type:"application/ld+json",children:Ow(p,t,M.APP_PUBLIC_URL,y,ne)}):null]}),n.jsx(La,{item:j,title:U?j.title:t.title,description:j.description||t.description,inlineLayout:U,primaryMetadata:Ba,secondaryMetadata:Ua,image:j.backgroundImage,shareButton:Ad,favoriteButton:Td,trailerButton:Ld,startWatchingButton:Ge,isLoading:wn,accessModel:C,isLoggedIn:X,hasSubscription:Ht,playlist:Te,relatedTitle:U?t.title:s("episodes"),getURL:Wt,setFilter:k,currentFilter:N,defaultFilterLabel:s("all_seasons"),activeLabel:s("current_episode"),watchHistory:$e,filterMetadata:Nd,filters:F,hasMore:ce,loadMore:Y,player:U?n.jsx(tr,{isLoggedIn:X,item:Ot,seriesItem:t,onComplete:os,feedId:d??void 0,onPlay:ht,startWatchingButton:Ge,isEntitled:be,hasMediaOffers:Xe,autostart:l||void 0}):n.jsx(vn,{open:l&&be,onClose:xt,item:Ot,seriesItem:t,title:t.title,primaryMetadata:Ba,secondaryMetadata:Ua,onComplete:os,feedId:d??void 0})}),y&&n.jsx(xn,{item:_,title:`${y.title} - Trailer`,open:r,onClose:()=>a(!1)})]})},f1=({data:t,isLoading:e})=>{const s=t.liveChannelsId;return e?n.jsx(ws,{}):s?n.jsx(Os,{to:Ts(s,t.mediaid),replace:!0}):n.jsx(yd,{data:t,isLoading:e})},bd=({data:t,isLoading:e})=>{const s=t.mediaid,[r]=Ds(),a=r.get("play")==="1",o=r.get("r"),{data:i,isLoading:c}=vd(t.mediaid),{isLoading:l,data:d}=es(i?.series_id||"");if(e||c||l)return n.jsx(ws,{});if(!i)return n.jsx(Os,{to:hl(t,a,o),replace:!0});const{mediaid:u,title:h}=d;return n.jsx(Os,{to:ue({episodeId:s,id:u,title:h,play:a,playlistId:o}),replace:!0})};function g1(t){return{isLiveEvent:ca(t),isPlayable:Uu(t)}}const _1="_tag_gc1jh_1",y1="_normal_gc1jh_11",v1="_large_gc1jh_20",x1="_live_gc1jh_31",$r={tag:_1,normal:y1,large:v1,live:x1},Xr=({children:t,className:e,isLive:s=!1,size:r="normal"})=>n.jsx("div",{className:L(e,$r.tag,$r[r],{[$r.live]:s}),children:t}),b1="_icon_1fdnv_1",Mc={icon:b1};function w1({mediaStatus:t}){const{t:e}=I("video");return t===Ut.SCHEDULED||t===Ut.VOD?n.jsx(V,{icon:Pa,className:Mc.icon}):t===Ut.LIVE?n.jsx(Xr,{isLive:!0,className:Mc.icon,children:e("live")}):null}const S1=({data:t,isLoading:e})=>{const{t:s,i18n:r}=I(["video","common"]),a=xs("title"),[o,i]=m.useState(!1),c=pe(),l=se(),u=Rs().id||"",h=Le("play")==="1",p=Le("r"),{config:g,accessModel:f}=H(({config:G,accessModel:be})=>({config:G,accessModel:be}),Q),{siteName:y,features:v,custom:_}=g,b=!!v?.favoritesList,x=!!_?.inlinePlayer,{isLoading:P,data:w}=es(t?.trailerId||""),{isLoading:j,data:S}=gn(v?.recommendationsPlaylist||"",{related_media_id:u}),C=g1(t),{user:E,subscription:A}=B(({user:G,subscription:be})=>({user:G,subscription:be}),Q),{isEntitled:T,mediaOffers:$}=qs(t),U=!!$.length,F=()=>t&&l(ue({id:t.mediaid,title:t.title,playlistId:p,play:!1})),N=G=>ue({id:G.mediaid,title:G.title,playlistId:v?.recommendationsPlaylist}),k=m.useCallback(()=>{if(!u||!S)return;const G=S.playlist.findIndex(({mediaid:ze})=>ze===u),be=S.playlist[G+1];if(be.mediaStatus!==Ut.SCHEDULED)return be&&l(ue({id:be.mediaid,title:be.title,playlistId:p,play:!0}))},[u,S,l,p]);m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0}),document.querySelector("#video-details button")?.focus()},[u]);const{title:O,mediaid:Y}=t,ce=`${O} - ${y}`,ne=t?`${M.APP_PUBLIC_URL}${ue({id:Y,title:O})}`:window.location.href,Te=n.jsxs(n.Fragment,{children:[n.jsx(w1,{mediaStatus:t.mediaStatus}),n.jsx(ts,{attributes:Sx(t,r.language,{minutesAbbreviation:s("common:abbreviation.minutes"),hoursAbbreviation:s("common:abbreviation.hours")})})]}),ut=n.jsx(Gs,{title:t.title,description:t.description,url:ne}),Se=n.jsx(bs,{item:t,playUrl:ue({id:Y,title:O,playlistId:p,play:!0}),disabled:!C.isPlayable},u),fe=b&&n.jsx(bn,{item:t}),$e=(!!w||P)&&n.jsx(D,{label:s("video:trailer"),"aria-label":s("video:watch_trailer"),startIcon:n.jsx(V,{icon:yn}),onClick:()=>i(!0),active:o,fullWidth:c<z.md,disabled:!w}),Oe=!!E,Qe=!!A;return n.jsxs(he.Fragment,{children:[n.jsxs(Tt,{children:[n.jsx("title",{children:ce}),n.jsx("link",{rel:"canonical",href:ne}),n.jsx("meta",{name:"description",content:t.description}),n.jsx("meta",{property:"og:description",content:t.description}),n.jsx("meta",{property:"og:title",content:ce}),n.jsx("meta",{property:"og:type",content:"video.other"}),t.image&&n.jsx("meta",{property:"og:image",content:t.image?.replace(/^https:/,"http:")}),t.image&&n.jsx("meta",{property:"og:image:secure_url",content:t.image?.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:image:width",content:t.image?"720":""}),n.jsx("meta",{property:"og:image:height",content:t.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:ce}),n.jsx("meta",{name:"twitter:description",content:t.description}),n.jsx("meta",{name:"twitter:image",content:t.image}),n.jsx("meta",{property:"og:video",content:ne.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:ne.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),t.tags?.split(",").map(G=>n.jsx("meta",{property:"og:video:tag",content:G},G)),t?n.jsx("script",{type:"application/ld+json",children:Da(t,M.APP_PUBLIC_URL)}):null]}),n.jsx(La,{item:t,inlineLayout:x,isLoading:e||j,accessModel:f,isLoggedIn:Oe,hasSubscription:Qe,title:t.title,description:t.description,image:t.backgroundImage,primaryMetadata:Te,shareButton:ut,favoriteButton:fe,trailerButton:$e,startWatchingButton:Se,playlist:S,relatedTitle:S?.[a]||S?.title,getURL:N,activeLabel:s("current_video"),player:x?n.jsx(tr,{isLoggedIn:Oe,item:t,onComplete:k,feedId:p??void 0,startWatchingButton:Se,isEntitled:T,hasMediaOffers:U,autostart:C.isPlayable&&(h||void 0),playable:C.isPlayable}):n.jsx(vn,{open:h&&T,onClose:F,item:t,title:t.title,primaryMetadata:Te,onComplete:k,feedId:p??void 0,onNext:k})}),n.jsx(xn,{item:w,title:`${t.title} - Trailer`,open:o,onClose:()=>i(!1)})]})},$t=new Ma;$t.registerByContentType(xd,Ve.series);$t.registerByContentType(bd,Ve.episode);$t.registerByContentType(f1,Ve.liveChannel);$t.registerByContentType(S1,Ve.liveEvent);$t.registerByContentType(Lw,Ve.page);$t.registerDefault(yd);$t.register(bd,t=>!!t&&cl(t));$t.register(xd,t=>!!t&&ol(t));const j1=()=>{const e=Rs().id||"",{isLoading:s,isFetching:r,error:a,data:o}=es(e),{t:i}=I("error");if(s)return n.jsx(ws,{});if(a||!o)return n.jsx(Ke,{title:i("video_not_found")});const c=$t.getScreen(o);return n.jsx(Vs,{open:!0,children:n.jsx(c,{data:o,isLoading:r})})},C1="_playlist_1tsu4_1",P1="_header_1tsu4_17",Dc={playlist:C1,header:P1},wd=({data:t,isLoading:e})=>{const s=xs("title"),{config:r,accessModel:a}=H(({config:y,accessModel:v})=>({config:y,accessModel:v}),Q),[o,i]=m.useState(""),c=Eh(r,t.feedid),l=m.useMemo(()=>kh(t,o),[t,o]),d=!!c.length,{user:u,subscription:h}=B(({user:y,subscription:v})=>({user:y,subscription:v}),Q);m.useEffect(()=>{i("")},[t.feedid]);const p=t?.[s]||t.title,g=`${p} - ${r.siteName}`,f=y=>ue({id:y.mediaid,title:y.title,playlistId:y.feedid});return n.jsxs("div",{className:Dc.playlist,children:[n.jsxs(Tt,{children:[n.jsx("title",{children:g}),n.jsx("meta",{property:"og:title",content:g}),n.jsx("meta",{name:"twitter:title",content:g})]}),n.jsxs("header",{className:Dc.header,children:[n.jsx("h1",{children:p}),d&&n.jsx(od,{name:"genre",value:o,defaultLabel:"All",options:c,setValue:i})]}),n.jsx(zs,{getUrl:f,playlist:l,accessModel:a,isLoggedIn:!!u,hasSubscription:!!h,isLoading:e,headingLevel:2})]})},Ra=t=>{const e=new Date(t.startTime),s=new Date(t.endTime);return Yc(e)&&au(s)},E1=t=>{const e=new Date(t.endTime);return Yc(e)},k1=(t,e=8)=>{const s=new Date(t.startTime),r=Kc(new Date,e);return ou(s,r)},$n=t=>t.programs.find(Ra),I1=({playlist:t,initialChannelId:e,enableAutoUpdate:s=!0})=>{const r=W(_l),{data:a=[]}=qe(["schedules",...t.map(({mediaid:p})=>p)],()=>r.getSchedules(t),{refetchInterval:Pu}),[o,i]=m.useState(s),[c,l]=m.useState(),[d,u]=m.useState();m.useEffect(()=>{if(!o||!s)return;const p=window.setInterval(()=>c&&u($n(c)),5e3);return()=>clearInterval(p)},[c,o,s]),m.useEffect(()=>{const p=a.find(({id:g})=>g===e)||a[0];if(!c&&p&&(l(p),u($n(p))),c){const g=a.find(({id:y})=>y===c.id);let f=d&&g?.programs.find(({id:y})=>y===d?.id);!f&&g&&(f=$n(g)),l(g),u(f)}},[a]);const h=m.useCallback((p,g)=>{const f=a?.find(v=>v.id===p);if(!f)return;const y=g?f.programs.find(v=>v.id===g):$n(f);l(f),u(y),i(!y||Ra(y))},[a]);return{channel:c,channels:a,program:d,setActiveChannel:h}},N1=({program:t,catchupHours:e})=>{const[s,r]=m.useState(!1),[a,o]=m.useState(!1),[i,c]=m.useState(!1);return m.useEffect(()=>{const l=()=>{r(!!t&&Ra(t)),o(!!t&&E1(t)),c(!!t&&k1(t,e))},d=setInterval(l,5e3);return l(),()=>clearInterval(d)},[e,t]),{isLive:s,isVod:a,isWatchableFromBeginning:i}},A1=Sw(),T1=({id:t,channelLogoImage:e,backgroundImage:s})=>({uuid:t,logo:e,channelLogoImage:e,backgroundImage:s}),L1=(t,{id:e,title:s,cardImage:r,backgroundImage:a,description:o,endTime:i,startTime:c})=>({channelUuid:t,id:e,title:s,image:r||"",cardImage:r||"",backgroundImage:a||"",description:o||"",till:i,since:c}),$1=({channels:t,sidebarWidth:e,itemHeight:s})=>{const[r,a]=m.useMemo(()=>[t.map(T1),t.flatMap(d=>d.programs.map(u=>L1(d.id,u)))],[t]),o=m.useMemo(()=>O1(),[]),i=iu().toJSON(),[c,l]=m.useMemo(()=>[cu(new Date(i)),lu()],[i]);return du({channels:r,epg:a,dayWidth:7200,sidebarWidth:e,itemHeight:s,isSidebar:!0,isTimeline:!0,isLine:!0,isBaseTimeFormat:A1,startDate:c,endDate:l,theme:o})},O1=()=>({primary:{600:"var(--epg-background-color, var(--body-background-color))",900:"var(--epg-background-color, var(--body-background-color))"},grey:{300:"#fff"},white:"#fff",green:{300:"#fff"},loader:{teal:"",purple:"",pink:"",bg:""},scrollbar:{border:"",thumb:{bg:""}},gradient:{blue:{300:"",600:"",900:""}},text:{grey:{300:"",500:""}},timeline:{divider:{bg:""}}}),M1="_epgChannelBox_15tvm_1",D1="_epgChannel_15tvm_1",R1="_epgChannelLogo_15tvm_27",On={epgChannelBox:M1,epgChannel:D1,epgChannelLogo:R1},F1=({channel:t,channelItemWidth:e,sidebarWidth:s,onClick:r,isActive:a,title:o})=>{const{position:i,uuid:c,channelLogoImage:l}=t,d={top:i.top,height:i.height,width:s};return n.jsx("div",{className:On.epgChannelBox,style:d,children:n.jsx("div",{className:L(On.epgChannel,{[On.active]:a}),style:{width:e},onClick:()=>r&&r(t),"data-testid":void 0,role:"button",children:n.jsx(Ws,{className:On.epgChannelLogo,image:l,alt:o,width:320})})})},B1="_epgProgramBox_h87h7_1",U1="_epgProgram_h87h7_1",H1="_disabled_h87h7_24",W1="_live_h87h7_28",V1="_selected_h87h7_31",q1="_epgProgramTitle_h87h7_34",z1="_epgProgramText_h87h7_37",G1="_epgLiveTag_h87h7_50",J1="_epgProgramContent_h87h7_77",Y1="_epgProgramImage_h87h7_119",rt={epgProgramBox:B1,epgProgram:U1,disabled:H1,live:W1,selected:V1,epgProgramTitle:q1,epgProgramText:z1,epgLiveTag:G1,epgProgramContent:J1,epgProgramImage:Y1},K1=({program:t,onClick:e,isActive:s,compact:r,disabled:a,isBaseTimeFormat:o})=>{const{styles:{position:i},formatTime:c,set12HoursTimeFormat:l,isLive:d,isMinWidth:u}=uu({program:t,isBaseTimeFormat:o}),{t:h}=I("common"),{data:p}=t,{image:g,title:f,since:y,till:v}=p,_=c(y,l()).toLowerCase(),b=c(v,l()).toLowerCase(),x=!r&&u,P=!r&&u&&d,w="";return n.jsx("div",{className:rt.epgProgramBox,style:i,onClick:()=>e&&e(t),children:n.jsxs("div",{className:L(rt.epgProgram,{[rt.selected]:s,[rt.live]:d,[rt.disabled]:a}),style:{width:rt.width},"data-testid":(t.data.id,void 0),children:[x&&n.jsx("img",{className:rt.epgProgramImage,src:g,alt:w}),P&&n.jsx("div",{className:rt.epgLiveTag,children:h("live")}),n.jsxs("div",{className:rt.epgProgramContent,children:[r&&d&&n.jsx("div",{className:rt.epgLiveTag,children:h("live")}),n.jsx("h2",{className:rt.epgProgramTitle,children:f}),n.jsxs("span",{className:rt.epgProgramText,children:[_," - ",b]})]})]})})},Q1="_timelineBox_10xo1_1",X1="_timelineTime_10xo1_5",Z1="_timelineContainer_10xo1_16",eS="_timelineDividers_10xo1_23",tS="_timelineDivider_10xo1_23",en={timelineBox:Q1,timelineTime:X1,timelineContainer:Z1,timelineDividers:eS,timelineDivider:tS},sS=({isBaseTimeFormat:t,dayWidth:e,hourWidth:s,numberOfHoursInDay:r,offsetStartHoursRange:a,isSidebar:o,sidebarWidth:i})=>{const{time:c,dividers:l,formatTime:d}=hu(r,t),u=()=>l.map((p,g)=>n.jsx("div",{className:en.timelineDivider,style:{marginRight:s/4}},g)),h=p=>n.jsxs("div",{className:en.timelineBox,style:{width:s},children:[n.jsx("time",{className:en.timelineTime,children:d(p+a).toLowerCase()}),n.jsx("div",{className:en.timelineDividers,children:u()})]},p);return n.jsx("div",{className:en.timelineContainer,style:{width:e,left:o?i:0},children:c.map((p,g)=>h(g))})},nS="_epg_j4bmq_1",rS="_firstFrame_j4bmq_8",aS="_epgSpinner_j4bmq_42",oS="_timelineControl_j4bmq_50",iS="_timelineNowButton_j4bmq_65",cS="_leftControl_j4bmq_76",lS="_rightControl_j4bmq_77",us={epg:nS,firstFrame:rS,epgSpinner:aS,timelineControl:oS,timelineNowButton:iS,leftControl:cS,rightControl:lS};function dS({channels:t,selectedChannel:e,onChannelClick:s,onProgramClick:r,program:a}){const o=sd(),i=pe(),{t:c}=I("common"),l=i<z.sm,d=l?70:184,u=l?d-10:d-24,h=l?80:106,{getEpgProps:p,getLayoutProps:g,onScrollToNow:f,onScrollLeft:y,onScrollRight:v}=$1({channels:t,sidebarWidth:d,itemHeight:h}),_=m.useMemo(()=>Object.fromEntries(t.map(x=>[x.id,x.catchupHours])),[t]),b=m.useMemo(()=>Object.fromEntries(t.map(x=>[x.id,x.title])),[t]);return n.jsxs("div",{className:L(us.epg,o&&us.firstFrame),children:[n.jsxs("div",{className:us.timelineControl,children:[n.jsx(D,{className:us.timelineNowButton,variant:"contained",label:c("now"),color:"primary",onClick:f,size:"small"}),n.jsx(Re,{className:us.leftControl,"aria-label":c("slide_left"),onClick:()=>y(),children:n.jsx(V,{icon:ja})}),n.jsx(Re,{className:us.rightControl,"aria-label":c("slide_right"),onClick:()=>v(),children:n.jsx(V,{icon:_n})})]}),n.jsx(mu,{...p(),loader:n.jsx(vs,{className:us.epgSpinner}),children:n.jsx(pu,{...g(),renderTimeline:x=>n.jsx(sS,{...x}),renderChannel:({channel:x})=>n.jsx(F1,{channel:x,channelItemWidth:u,sidebarWidth:d,onClick:P=>{s(P.uuid),f()},title:b[x.uuid]||"",isActive:e?.id===x.uuid},x.uuid),renderProgram:({program:x,isBaseTimeFormat:P})=>{const w=_[x.data.channelUuid],j=fu(new Date(x.data.since),Kc(new Date,w));return n.jsx(K1,{program:x,disabled:j,onClick:S=>!j&&r(S.data.id,S.data.channelUuid),isActive:a?.id===x.data.id,compact:l,isBaseTimeFormat:P},x.data.id)}})})]})}const uS="_epgContainer_17asv_1",hS="_catchupButton_17asv_11",mS="_tag_17asv_17",Or={epgContainer:uS,catchupButton:hS,tag:mS},pS=({data:{feedid:t,playlist:e}})=>{const{t:s}=I("epg"),{config:r}=H(({config:k})=>({config:k}),Q),{siteName:a}=r,o=re(),i=se(),c=m.useMemo(()=>new URLSearchParams(o.search),[o.search]),l=c.get("play")==="1",d=c.get("channel")??void 0,u=c.get("start"),h=c.get("end"),p=c.get("beginning")==="1",g=()=>t&&i(Ts(t,d)),[f]=m.useState(d),{channels:y,channel:v,program:_,setActiveChannel:b}=I1({playlist:e,initialChannelId:f,enableAutoUpdate:!p}),{isLive:x,isVod:P,isWatchableFromBeginning:w}=N1({program:_,catchupHours:v?.catchupHours}),j=m.useMemo(()=>e.find(({mediaid:k})=>v?.id===k),[v?.id,e]),{isEntitled:S}=qs(j),C=m.useMemo(()=>_?{title:_.title,description:_.description||"",image:_.backgroundImage,canWatch:x||P&&w,canWatchFromBeginning:S&&x&&w}:{title:v?.title||"",description:v?.description||"",image:v?.backgroundImage,canWatch:!0,canWatchFromBeginning:!1},[v?.backgroundImage,v?.description,v?.title,S,x,P,w,_]),E=m.useMemo(()=>{if(!v)return"";if(!_)return n.jsx(Xr,{isLive:!0,children:s("common:live")});const k=new Date(_.startTime),O=new Date(_.endTime),Y=gu(O,k),ce=pa(Y,{minutesAbbreviation:s("common:abbreviation.minutes")}),ne=[s("on_channel",{name:v.title}),ce].filter(Boolean);return n.jsxs(n.Fragment,{children:[n.jsx(Xr,{className:Or.tag,isLive:x,children:x?s("common:live"):`${qa(k,"p")} - ${qa(O,"p")}`}),n.jsx(ts,{attributes:ne})]})},[v,x,_,s]),A=(k,O)=>{b(O,k),(document.scrollingElement||document.body).scroll({top:0,behavior:"smooth"})},T=k=>{b(k)};if(m.useEffect(()=>{v&&t&&d!==v.id&&i(Ts(t,v.id),{replace:!0})},[i,t,v,d]),!v||!t)return n.jsx(ws,{});const $=`${M.APP_PUBLIC_URL}${Ts(t,v.id)}`,U=`${v.title} - ${a}`,F=j?n.jsx(Gs,{title:j.title,description:j.description,url:window.location.href}):null,N=j?n.jsxs(n.Fragment,{children:[n.jsx(bs,{item:j,playUrl:ye(Ts(t,d,!0),{start:P?_?.startTime:void 0,end:P?_?.endTime:void 0}),disabled:!C.canWatch}),C.canWatchFromBeginning&&n.jsx(D,{className:Or.catchupButton,onClick:()=>i(ye(Ts(t||"",d,!0),{start:_?.startTime,beginning:1})),label:s("start_from_beginning"),startIcon:n.jsx(V,{icon:ed})})]}):null;return n.jsxs(n.Fragment,{children:[n.jsxs(Tt,{children:[n.jsx("title",{children:U}),n.jsx("link",{rel:"canonical",href:$}),n.jsx("meta",{name:"description",content:j?.description}),n.jsx("meta",{property:"og:description",content:j?.description}),n.jsx("meta",{property:"og:title",content:U}),n.jsx("meta",{property:"og:type",content:"video.other"}),j?.image&&n.jsx("meta",{property:"og:image",content:j.image?.replace(/^https:/,"http:")}),j?.image&&n.jsx("meta",{property:"og:image:secure_url",content:j.image?.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:image:width",content:j?.image?"720":""}),n.jsx("meta",{property:"og:image:height",content:j?.image?"406":""}),n.jsx("meta",{name:"twitter:title",content:U}),n.jsx("meta",{name:"twitter:description",content:j?.description}),n.jsx("meta",{name:"twitter:image",content:j?.image}),n.jsx("meta",{property:"og:video",content:$.replace(/^https:/,"http:")}),n.jsx("meta",{property:"og:video:secure_url",content:$.replace(/^http:/,"https:")}),n.jsx("meta",{property:"og:video:type",content:"text/html"}),n.jsx("meta",{property:"og:video:width",content:"1280"}),n.jsx("meta",{property:"og:video:height",content:"720"}),j?.tags?.split(",").map(k=>n.jsx("meta",{property:"og:video:tag",content:k},k)),j?n.jsx("script",{type:"application/ld+json",children:Da(j,M.APP_PUBLIC_URL)}):null]}),n.jsxs(ld,{title:C.title,description:C.description,image:C.image,startWatchingButton:N,shareButton:F,primaryMetadata:E,children:[j&&n.jsx(vn,{open:l&&S,onClose:g,item:j,title:C.title,primaryMetadata:E,feedId:t,liveStartDateTime:u,liveEndDateTime:h,liveFromBeginning:p}),n.jsx("div",{className:Or.epgContainer,children:n.jsx(dS,{channels:y,onChannelClick:T,onProgramClick:A,selectedChannel:v,program:_})})]})]})},Fa=new Ma,Sd=new Ma;Fa.registerDefault(wd);Fa.registerByContentType(pS,Eu.live);Sd.registerDefault(wd);const Rc=({type:t})=>{const s=Rs().id||"",{isFetching:r,error:a,data:o}=gn(s,{},!0,!0,t),{t:i}=I("error");if(r)return n.jsx(ws,{});if(a||!o)return n.jsx(Ke,{title:i("playlist_not_found")});if(o.playlist.length===0)return n.jsx(Ke,{title:i("empty_shelves_heading"),message:i("empty_shelves_description")});const c=t===Ft.content_list?Sd.getScreen(o):Fa.getScreen(o);return n.jsx(Vs,{open:!0,children:n.jsx(c,{data:o,isLoading:r})},s)},fS="_header_1ydaw_1",gS="_fixed_1ydaw_7",_S="_container_1ydaw_18",yS="_menu_1ydaw_27",vS="_iconButton_1ydaw_31",xS="_brand_1ydaw_39",bS="_nav_1ydaw_43",wS="_skipToContent_1ydaw_68",SS="_actions_1ydaw_102",jS="_search_1ydaw_113",CS="_brandCentered_1ydaw_117",PS="_navButton_1ydaw_121",ES="_searchActive_1ydaw_147",ct={header:fS,fixed:gS,static:"_static_1ydaw_12",container:_S,menu:yS,iconButton:vS,brand:xS,nav:bS,skipToContent:wS,actions:SS,search:jS,brandCentered:CS,navButton:PS,searchActive:ES},kS=Symbol("HEADER"),IS=({children:t,className:e,headerType:s="static",searchActive:r})=>{const a=L(ct.header,ct[s],e,{[ct.searchActive]:r});return n.jsx("header",{className:a,children:n.jsx("div",{className:ct.container,children:t})})},NS=rs(kS,IS),AS="_footer_pj6tn_1",TS="_list_pj6tn_10",LS="_testFixMargin_pj6tn_23",Mr={footer:AS,list:TS,testFixMargin:LS},$S=({text:t})=>{const e=t.split("|").map(a=>a.trim()),s=e.map((a,o)=>n.jsx(Hs,{markdownString:a,inline:!0,tag:e.length>1?"li":"div"},o)),r=e.length>1?n.jsx("ul",{className:Mr.list,children:s}):s;return n.jsx("footer",{className:L(Mr.footer,{[Mr.testFixMargin]:Mu}),children:r})},OS=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),m.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})),MS=({className:t,sideBarOpen:e,onClick:s})=>{const{t:r}=I("menu");return n.jsx("div",{className:L(ct.menu,t),children:n.jsx(Re,{className:ct.iconButton,"aria-label":r("open_menu"),"aria-expanded":e,onClick:s,children:n.jsx(V,{icon:OS})})})},DS=100,RS=({className:t,navItems:e})=>{const s=m.useRef(null),r=a=>{if(!s.current)return;const o=s.current.getBoundingClientRect(),c=a.target.getBoundingClientRect().left+s.current.scrollLeft-o.left,l=c<o.width/2?0:c-DS;s.current.scrollTo({left:l,behavior:"smooth"})};return n.jsx("nav",{className:L(ct.nav,t),ref:s,children:n.jsx("ul",{onFocus:r,children:e.map((a,o)=>n.jsx("li",{children:n.jsx(D,{activeClassname:ct.navButton,label:a.label,to:a.to,variant:"text"})},o))})})},FS="_logo_1yd6a_1",BS={logo:FS},US=({src:t,alt:e="logo",onLoad:s})=>{const[r,a]=m.useState({height:void 0,width:void 0}),o=i=>{const{height:c,width:l}=i.currentTarget;a({height:c,width:l}),s()};return n.jsx(dn,{to:"/",children:n.jsx("img",{className:BS.logo,alt:e,src:t,height:r.height,width:r.width,onLoad:o,onError:s})})},HS=({className:t,siteName:e,logoSrc:s,setLogoLoaded:r})=>{const{t:a}=I("menu");return s?n.jsx("div",{className:L(ct.brand,t),children:n.jsx(US,{alt:a("logo_alt",{siteName:e}),src:s,onLoad:()=>r(!0)})}):null},WS=({children:t,className:e})=>n.jsx("div",{className:L(ct.actions,e),children:t}),VS=({className:t})=>{const{t:e}=I("menu");return n.jsx("a",{href:"#content",className:L(ct.skipToContent,t),children:e("skip_to_content")})},qS="_sidebar_1ve1d_1",zS="_heading_1ve1d_20",GS="_group_1ve1d_25",Dr={sidebar:qS,heading:zS,group:GS},JS=Symbol("SIDEBAR"),YS=({children:t,...e})=>n.jsx(Xn,{direction:"left",...e,children:t}),KS=({isOpen:t,onClose:e,children:s})=>{const{t:r}=I("menu");return n.jsx(pn,{open:t,onClose:e,AnimationComponent:YS,children:n.jsxs("div",{className:Dr.sidebar,id:"sidebar",children:[n.jsx("div",{className:Dr.heading,children:n.jsx(Re,{onClick:e,"aria-label":r("close_menu"),children:n.jsx(V,{icon:Zn})})}),n.jsx("nav",{className:Dr.group,onClick:e,children:s})]})})},QS=rs(JS,KS),XS="_menuButton_5vhgl_1",ZS="_small_5vhgl_24",ej="_startIcon_5vhgl_28",tj="_active_5vhgl_41",As={menuButton:XS,small:ZS,startIcon:ej,active:tj},sj=Symbol("MENU_BUTTON"),nj=({label:t,to:e,onClick:s,onBlur:r,onFocus:a,tabIndex:o=0,active:i=!1,startIcon:c,small:l=!1,...d})=>{const u=c?n.jsx("div",{className:As.startIcon,children:c}):null,h=p=>L(As.menuButton,{[As.small]:l},{[As.active]:p});return e?n.jsxs(zc,{onBlur:r,onFocus:a,onClick:s,className:({isActive:p})=>h(p||i),to:e,tabIndex:o,end:!0,children:[u,n.jsx("span",{className:As.label,children:t})]}):n.jsxs("div",{role:"button",onBlur:r,onFocus:a,className:h(i),onClick:s,tabIndex:o,...d,children:[u,n.jsx("span",{className:As.label,children:t})]})},Ls=rs(sj,nj),rj="_popover_px6io_1",aj="_menuItems_px6io_5",oj="_divider_px6io_16",ij="_small_px6io_29",cj="_sectionHeader_px6io_43",rn={popover:rj,menuItems:aj,divider:oj,small:ij,sectionHeader:cj},jd=({showPaymentItems:t,small:e=!1,onButtonClick:s,favoritesEnabled:r,focusable:a,titleId:o})=>{const{t:i}=I("user"),c=se(),l=W(ie),d=a?0:-1,u=m.useCallback(async()=>{s&&s(),await l.logout(),c("/",{replace:!0})},[s,c,l]);return n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:rn.sectionHeader,id:o,children:i("nav.settings")}),n.jsxs("ul",{className:rn.menuItems,children:[n.jsx("li",{children:n.jsx(Ls,{small:e,onClick:s,to:zu,label:i("nav.account"),startIcon:n.jsx(V,{icon:ka}),tabIndex:d})}),r&&n.jsx("li",{children:n.jsx(Ls,{small:e,onClick:s,to:Gu,label:i("nav.favorites"),startIcon:n.jsx(V,{icon:Ia}),tabIndex:d})}),t&&n.jsx("li",{children:n.jsx(Ls,{small:e,onClick:s,to:Ju,label:i("nav.payments"),startIcon:n.jsx(V,{icon:rd}),tabIndex:d})}),n.jsx("li",{className:L(rn.divider,{[rn.small]:e}),children:n.jsx(Ls,{small:e,onClick:u,label:i("nav.logout"),startIcon:n.jsx(V,{icon:ad}),tabIndex:d})})]})]})},lj="_buttonContainer_ak6a2_1",dj="_separator_ak6a2_10",Cd={buttonContainer:lj,separator:dj},uj=({sideBarOpen:t,canLogin:e,isLoggedIn:s,favoritesEnabled:r,onLoginClick:a,onSignUpClick:o})=>{const{t:i}=I("menu"),c=dt("usermenu-title");return e?s?n.jsx("section",{"aria-labelledby":c,children:n.jsx(jd,{focusable:t,favoritesEnabled:r,titleId:c,showPaymentItems:!0})}):n.jsxs("div",{className:Cd.buttonContainer,children:[n.jsx(D,{tabIndex:t?0:-1,onClick:a,label:i("sign_in"),fullWidth:!0}),n.jsx(D,{tabIndex:t?0:-1,variant:"contained",color:"primary",onClick:o,label:i("sign_up"),fullWidth:!0})]}):null},hj=()=>{const{t}=I("common"),e=xs("label"),s=se(),r=re(),a=Ee(f=>f.sideBarOpen),{config:{menu:o,features:i},accessModel:c}=H(f=>({config:f.config,accessModel:f.accessModel})),l=B(({user:f})=>!!f),d=!!i?.favoritesList,u=c!==Ae.AVOD,h=()=>Ee.setState({sideBarOpen:!1}),p=()=>{s(q(r,"login"))},g=()=>{s(q(r,"create-account"))};return n.jsxs(QS,{isOpen:a,onClose:h,children:[n.jsxs("ul",{children:[n.jsx("li",{children:n.jsx(Ls,{label:t("home"),to:"/"})}),o.map(({contentId:f,type:y,label:v,custom:_})=>n.jsx("li",{children:n.jsx(Ls,{label:_?.[e]||v,to:ul({type:y,contentId:f})})},f))]}),n.jsx("hr",{className:Cd.separator}),n.jsx(uj,{sideBarOpen:a,favoritesEnabled:d,canLogin:u,isLoggedIn:l,onLoginClick:p,onSignUpClick:g})]})},mj=()=>{const{t}=I("common"),{siteName:e,description:s}=H(({config:a})=>a,Q),r=s||t("default_description");return n.jsxs(Tt,{children:[n.jsx("title",{children:e}),n.jsx("meta",{name:"description",content:r}),n.jsx("meta",{property:"og:description",content:r}),n.jsx("meta",{property:"og:title",content:e}),n.jsx("meta",{name:"twitter:title",content:e}),n.jsx("meta",{name:"twitter:description",content:r})]})},Pd=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})),pj=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M9 1C4.58 1 1 4.58 1 9s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4 10.87L11.87 13 9 10.13 6.13 13 5 11.87 7.87 9 5 6.13 6.13 5 9 7.87 11.87 5 13 6.13 10.13 9 13 11.87z"})),fj="_searchBar_1plps_1",gj="_searchForm_1plps_6",_j="_icon_1plps_10",yj="_input_1plps_18",vj="_clearButton_1plps_42",tn={searchBar:fj,searchForm:gj,icon:_j,input:yj,clearButton:vj},xj=({query:t,onQueryChange:e,onClearButtonClick:s,onClose:r,inputRef:a})=>{const{t:o}=I("search"),i=c=>{c.preventDefault(),a?.current.focus(),document.querySelector("#content")?.focus()};return n.jsxs("div",{className:tn.searchBar,children:[n.jsx(V,{icon:Pd,className:tn.icon}),n.jsxs("form",{className:tn.searchForm,role:"search",onSubmit:i,children:[n.jsx("label",{htmlFor:"searchbar-input",className:"hidden",children:o("search_bar.search_label")}),n.jsx("input",{className:tn.input,id:"searchbar-input",type:"search",value:t,onChange:e,onKeyDown:c=>c.key==="Escape"&&r?.(),placeholder:o("search_bar.search_placeholder"),ref:a}),t?n.jsx(Re,{className:tn.clearButton,"aria-label":o("search_bar.clear_search_label"),onClick:s,children:n.jsx(V,{icon:pj})}):null]})]})},qn=({children:t,className:e,...s})=>n.jsx(Re,{className:L(ct.iconButton,e),...s,children:t}),bj="_searchContainer_1s5uc_1",wj={searchContainer:bj},Sj=()=>{const{t}=I("menu"),e=re(),s=m.useRef(null),r=H(({config:y})=>y),{features:a,custom:o}=r,{searchPlaylist:i}=a||{},c=ns(o?.appContentSearch),l=!!i||c,{searchQuery:d,searchActive:u}=Ee(({searchQuery:y,searchActive:v,userMenuOpen:_,languageMenuOpen:b})=>({languageMenuOpen:b,searchQuery:y,searchActive:v,userMenuOpen:_}),Q),{updateSearchQuery:h,resetSearchQuery:p}=nd(),g=()=>{p(),Ee.setState({searchActive:!1})},f=()=>{Ee.setState({searchActive:!0,preSearchPage:`${e.pathname}${e.search||""}`})};return m.useEffect(()=>{u&&s.current&&s.current.focus()},[u]),l?u?n.jsxs("div",{className:wj.searchContainer,children:[n.jsx(xj,{query:d,onQueryChange:y=>h(y.target.value),onClearButtonClick:()=>h(""),inputRef:s,onClose:g}),n.jsx(qn,{"aria-label":t("search_close"),onClick:g,children:n.jsx(V,{icon:Zn})})]}):n.jsx(qn,{"aria-label":t("search_open"),onClick:f,children:n.jsx(V,{icon:Pd})}):null},jj=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"})),Cj="_panel_jhs6c_1",Pj={panel:Cj},Ed=({children:t,...e})=>n.jsx("div",{className:Pj.panel,...e,children:t}),Ej=({callback:t,children:e})=>{const s=m.useRef();return m.useEffect(()=>{const r=a=>{!s.current||!(a.target instanceof Node)||s.current!==a.target&&!s.current?.contains(a.target)&&t()};return setTimeout(()=>document.addEventListener("click",r),1),()=>document.removeEventListener("click",r)},[t]),he.cloneElement(e,{ref:r=>{s.current=r}})},kj="_popover_1efkk_1",Ij={popover:kj},kd=({children:t,className:e,isOpen:s,onClose:r})=>n.jsx(Xn,{open:s,duration:250,direction:"right",style:{position:"relative"},children:n.jsx(Ej,{callback:r,children:n.jsx("div",{className:L(Ij.popover,e),children:t})})}),Nj="_menuItems_1oh0j_5",Aj="_menuItem_1oh0j_5",Tj="_menuItemActive_1oh0j_28",Rr={menuItems:Nj,menuItem:Aj,menuItemActive:Tj},Lj=({onClick:t,className:e,languages:s,currentLanguage:r,languageMenuOpen:a,closeLanguageMenu:o,openLanguageMenu:i})=>{const{t:c}=I("menu"),l=(u,h)=>{u.preventDefault(),t?.(h),o()},d=()=>{a?o():i()};return n.jsxs("div",{children:[n.jsx(qn,{"data-testid":void 0,"aria-controls":"language-panel","aria-expanded":a,"aria-haspopup":"menu",className:e,"aria-label":c("language_menu"),onClick:d,onBlur:o,children:n.jsx(V,{icon:jj})}),n.jsx(kd,{isOpen:a,onClose:o,children:n.jsx(Ed,{id:"language-panel",children:n.jsx("ul",{className:Rr.menuItems,children:s.map(({code:u,displayName:h})=>{const p=r?.code===u,g=L(Rr.menuItem,{[Rr.menuItemActive]:p});return n.jsx("li",{className:g,onClick:f=>l(f,u),children:n.jsx(ln,{onFocus:i,onBlur:o,href:"#","aria-current":p,children:h})},u)})})})})]})},$j=()=>{const{i18n:t}=I("menu"),e=H(d=>d.supportedLanguages),s=Ee(d=>d.languageMenuOpen),r=W(fs),a=W(Ms),o=m.useCallback(()=>Ee.setState({languageMenuOpen:!0}),[]),i=m.useCallback(()=>Ee.setState({languageMenuOpen:!1}),[]),c=d=>{t.changeLanguage(d),r.restoreFavorites(d),a.restoreWatchHistory(d)},l=m.useMemo(()=>e.find(({code:d})=>d===t.language),[t.language,e]);return e.length<2?null:n.jsx(Lj,{openLanguageMenu:o,closeLanguageMenu:i,languageMenuOpen:s,onClick:c,languages:e,currentLanguage:l})},Oj=({isLoggedIn:t,favoritesEnabled:e,open:s,onClose:r,onOpen:a,onLoginButtonClick:o,onSignUpButtonClick:i})=>{const{t:c}=I("menu");return t?n.jsxs("div",{children:[n.jsx(qn,{"aria-label":c("open_user_menu"),"aria-controls":"menu_panel","aria-expanded":s,"aria-haspopup":"menu",onClick:a,onBlur:r,children:n.jsx(V,{icon:ka})}),n.jsx(kd,{className:rn.popover,isOpen:s,onClose:r,children:n.jsx(Ed,{id:"menu_panel",children:n.jsx("div",{onFocus:a,onBlur:r,children:n.jsx(jd,{focusable:s,onButtonClick:r,showPaymentItems:!0,favoritesEnabled:e,small:!0})})})})]}):n.jsxs(n.Fragment,{children:[n.jsx(D,{onClick:o,label:c("sign_in"),"aria-haspopup":"dialog"}),n.jsx(D,{variant:"contained",color:"primary",onClick:i,label:c("sign_up"),"aria-haspopup":"dialog"})]})},Mj=()=>{const t=pe(),e=se(),s=re(),r=Ee(g=>g.userMenuOpen),{config:{features:a},accessModel:o}=H(g=>({config:g.config,accessModel:g.accessModel})),i=B(({user:g})=>!!g),c=!!a?.favoritesList,l=o!==Ae.AVOD,d=m.useCallback(()=>Ee.setState({userMenuOpen:!0}),[]),u=m.useCallback(()=>Ee.setState({userMenuOpen:!1}),[]),h=()=>e(q(s,"login")),p=()=>e(q(s,"create-account"));return!l||t<=z.sm?null:n.jsx(Oj,{open:r,onOpen:d,onClose:u,isLoggedIn:i,favoritesEnabled:c,onLoginButtonClick:h,onSignUpButtonClick:p})},Dj="_layout_1116c_1",Rj="_main_1116c_6",Fc={layout:Dj,main:Rj},Fj=()=>{const{t}=I("common"),e=xs("label"),{config:s}=H(({config:v,accessModel:_,supportedLanguages:b})=>({config:v,accessModel:_,supportedLanguages:b}),Q),{menu:r,assets:a,siteName:o,styling:i}=s,{footerText:c}=i||{},l=c||$u(M.APP_FOOTER_TEXT),{sideBarOpen:d,searchActive:u,cookieWallOpen:h}=Ee(v=>({sideBarOpen:v.sideBarOpen,searchActive:v.searchActive,cookieWallOpen:v.cookieWallOpen})),p=a.banner,g=()=>Ee.setState({sideBarOpen:!0}),f=[{label:t("home"),to:"/"},...r.map(({label:v,contentId:_,type:b,custom:x})=>({label:x?.[e]||v,to:ul({type:b,contentId:_,label:v})}))],y={inert:d||h?"":void 0};return n.jsxs("div",{className:Fc.layout,children:[n.jsx(mj,{}),n.jsxs("div",{...y,children:[n.jsxs(NS,{searchActive:u,children:[n.jsx(VS,{}),n.jsx(MS,{sideBarOpen:d,onClick:g}),n.jsx(HS,{siteName:o,logoSrc:p,setLogoLoaded:()=>{}}),n.jsx(RS,{navItems:f}),n.jsxs(WS,{children:[n.jsx(Sj,{}),n.jsx($j,{}),n.jsx(Mj,{})]})]}),n.jsx("main",{id:"content",className:Fc.main,tabIndex:-1,children:n.jsx(na,{})}),!!l&&n.jsx($S,{text:l})]}),n.jsx(hj,{})]})},Bj="_flexBox_17rhj_1",Uj="_controls_17rhj_9",Bc={flexBox:Bj,controls:Uj};function Hj({className:t,panelHeaderClassName:e,label:s,editButton:r,saveButton:a,cancelButton:o,onSubmit:i,content:c,readOnly:l=!1}){const d=dt(s),{formState:{values:u,activeSectionId:h,errors:p,isBusy:g},setFormState:f,isLoading:y,onCancel:v}=m.useContext(Id),_=d===h,b=m.useCallback(({currentTarget:w})=>{if(!w)return;const{name:j,type:S}=w,C=S==="checkbox"?w.checked:w.value;_||v(),f(E=>{const A={...E.values};return j.split(".").reduce((T,$,U,F)=>(U===F.length-1?T[$]=C:T[$]={...T[$]},T[$]),A),{...E,values:A,activeSectionId:d}})},[_,v,d,f]),x=m.useCallback(async function(j){if(j?.preventDefault(),i){let S;try{f(C=>({...C,isBusy:!0,errors:[]})),S=await i(u)}catch(C){S={errors:Array.of(C instanceof Error?C.message:C)}}if(S?.errors?.length){f(C=>({...C,errors:S?.errors,isBusy:!1}));return}}f(S=>({...S,activeSectionId:void 0,isBusy:!1}))},[i,f,u]),P=m.useCallback(function(){_||(v(),f(j=>({...j,activeSectionId:d})))},[_,v,d,f]);return n.jsxs("section",{"aria-labelledby":d,className:t,children:[n.jsx("div",{className:e,children:n.jsx("h2",{id:d,children:s})}),g&&_&&n.jsx(ve,{transparentBackground:!0}),c&&n.jsx("form",{className:Bc.flexBox,noValidate:!0,onSubmit:w=>w.preventDefault(),children:c({values:u,isEditing:_,isBusy:g,onChange:b,..._?{errors:p}:{}})}),(a||r||o)&&n.jsx("div",{className:Bc.controls,children:_?n.jsxs(n.Fragment,{children:[a&&n.jsx(D,{label:a,type:"submit",onClick:x,disabled:y}),o&&n.jsx(D,{label:o,type:"reset",variant:"text",onClick:v})]}):!l&&r&&(typeof r=="object"?r:n.jsx(D,{label:r,type:"button",onClick:P,disabled:y}))})]})}const Id=m.createContext(void 0);function Wj({isLoading:t,initialValues:e,onReset:s,children:r}){const[a,o]=m.useState({values:e,activeSectionId:void 0,isDirty:!1,isBusy:!1}),i=m.useCallback(function(){o(l=>({...l,values:e,isDirty:!1,activeSectionId:void 0,success:!1,errors:void 0})),s?.()},[e,s]);return m.useEffect(()=>{a.activeSectionId||o(c=>({...c,values:e}))},[e,a.activeSectionId]),n.jsx(Id.Provider,{value:{isLoading:t,onCancel:i,formState:a,setFormState:o},children:r?.map((c,l)=>n.jsx(Hj,{...c},l))})}const Vj="_textWithButtonContainer_1cz0o_1",qj="_customFields_1cz0o_7",Fr={textWithButtonContainer:Vj,customFields:qj},zj=()=>{const t=W(ie),{t:e,i18n:s}=I("user"),r=Fe(),a=se(),o=re(),[i,c]=va(),l=it(t.exportAccountData),[d,u]=m.useState(!1),h=l.isSuccess?e("account.export_data_success"):e("account.export_data_error"),p=s.language!==M.APP_DEFAULT_LANGUAGE?M.APP_DEFAULT_LANGUAGE:void 0,{canUpdateEmail:g}=t.getFeatures();m.useEffect(()=>{(l.isSuccess||l.isError)&&u(!0)},[l.isSuccess,l.isError]);const{customer:f,customerConsents:y,publisherConsents:v}=B(({user:k,customerConsents:O,publisherConsents:Y})=>({customer:k,customerConsents:O,publisherConsents:Y}),Q),{canChangePasswordWithOldPassword:_,canExportAccountData:b,canDeleteAccount:x}=t.getFeatures(),P=f?.metadata?.register_source,w=P&&P!=="inplayer"||!1,j=w&&!f?.metadata?.has_password||!1;m.useEffect(()=>{if(!v){t.getPublisherConsents();return}},[t,v]);const[S,C]=m.useMemo(()=>{const k=[],O=[];return v?.forEach(Y=>{!Y?.type||Y?.type==="checkbox"?k.push(Y):O.push(Y)}),[k,O]},[v]),E=m.useMemo(()=>Nh(v,y),[v,y]),A=m.useMemo(()=>Ih(v,y),[v,y]),T=m.useMemo(()=>({...f,consents:E,consentsValues:A,confirmationPassword:""}),[f,E,A]),$=k=>{const O=ea.sanitize(k),Y=/<a(.|\n)*?>/.test(O),ce=/<\/a(.|\n)*?>/.test(O);return Y&&ce?n.jsx("span",{dangerouslySetInnerHTML:{__html:k}}):k};function U(k){const O={};return k?.flatMap(Y=>Y.split(",")).forEach(Y=>{switch(Y.trim()){case"Invalid param email":O.form=e("account.errors.validation_error"),O.email=e("account.errors.invalid_param_email");break;case"Customer email already exists":O.form=e("account.errors.validation_error"),O.email=e("account.errors.email_exists");break;case"Please enter a valid e-mail address.":O.form=e("account.errors.validation_error"),O.email=e("account.errors.please_enter_valid_email");break;case"Invalid confirmationPassword":{O.form=e("account.errors.validation_error"),O.confirmationPassword=e("account.errors.invalid_password");break}case"firstName can have max 50 characters.":{O.form=e("account.errors.validation_error"),O.firstName=e("account.errors.first_name_too_long");break}case"lastName can have max 50 characters.":{O.form=e("account.errors.validation_error"),O.lastName=e("account.errors.last_name_too_long");break}case"Email update not supported":{O.form=e("account.errors.email_update_not_supported");break}case"Wrong email/password combination":{O.form=e("account.errors.wrong_combination");break}default:{O.form=e("account.errors.unknown_error"),Pe("Account","Unknown error",{error:Y});break}}}),O}function F(k){return{...k,className:He.panel,panelHeaderClassName:He.panelHeader,saveButton:e("account.save"),cancelButton:e("account.cancel"),content:O=>{const Y=U(O.errors);return n.jsxs(n.Fragment,{children:[Y?.form?n.jsx(Ie,{variant:"error",children:Y.form}):null,k.content?.({...O,errors:Y})]})}}}const N=async()=>{if(f){if(w&&j)return await t.resetPassword(f.email,""),a(q(o,"add-password"));a(q(o,_?"edit-password":"reset-password"))}};return n.jsxs(n.Fragment,{children:[n.jsx("h1",{className:"hideUntilFocus",children:e("nav.account")}),n.jsx(Wj,{initialValues:T,children:[F({label:e("account.about_you"),editButton:e("account.edit_information"),onSubmit:async k=>{const O=Bn(v,{...k.metadata,...k.consentsValues}),Y=await t.updateUser({firstName:k.firstName||"",lastName:k.lastName||"",metadata:{...k.metadata,...zr(O),consents:JSON.stringify(O)}});return r(e("account.update_success",{section:e("account.about_you")}),"success"),Y},content:k=>n.jsxs(n.Fragment,{children:[n.jsx(ae,{name:"firstName",label:e("account.firstname"),value:k.values.firstName||"",onChange:k.onChange,error:!!k.errors?.firstName,helperText:k.errors?.firstName,disabled:k.isBusy,editing:k.isEditing,autoComplete:"given-name",lang:p}),n.jsx(ae,{name:"lastName",label:e("account.lastname"),value:k.values.lastName||"",onChange:k.onChange,error:!!k.errors?.lastName,helperText:k.errors?.lastName,disabled:k.isBusy,editing:k.isEditing,autoComplete:"family-name",lang:p})]})}),F({label:e("account.email"),onSubmit:async k=>{if(!k.email||!k.confirmationPassword)throw new Error("Wrong email/password combination");const O=await t.updateUser({email:k.email||"",confirmationPassword:k.confirmationPassword});return r(e("account.update_success",{section:e("account.email")}),"success"),O},editButton:e("account.edit_account"),readOnly:!g,content:k=>n.jsxs(n.Fragment,{children:[n.jsx(ae,{name:"email",label:e("account.email"),value:k.values.email||"",onChange:k.onChange,error:!!k.errors?.email,helperText:k.errors?.email,disabled:k.isBusy,editing:k.isEditing,autoComplete:"email",required:!0}),k.isEditing&&n.jsx(ae,{name:"confirmationPassword",label:e("account.confirm_password"),value:k.values.confirmationPassword,onChange:k.onChange,error:!!k.errors?.confirmationPassword,helperText:k.errors?.confirmationPassword,type:i?"text":"password",disabled:k.isBusy,autoComplete:"current-password",rightControl:n.jsx(Re,{"aria-label":e("account.view_password"),onClick:()=>c(),"aria-pressed":i,children:n.jsx(V,{icon:i?xa:ba})}),required:!0})]})}),F({label:e("account.security"),editButton:n.jsx(D,{label:e(j?"account.add_password":"account.edit_password"),type:"button",onClick:()=>f?N():null})}),F({label:e("account.terms_and_tracking"),saveButton:e("account.update_consents"),onSubmit:async k=>{const O=await t.updateConsents(Bn(v,k.consentsValues));return r(e("account.update_success",{section:e("account.terms_and_tracking")}),"success"),O},content:k=>n.jsx(n.Fragment,{children:S?.map((O,Y)=>n.jsx(er,{name:`consentsValues.${O.name}`,checked:ns(k.values.consentsValues?.[O.name]),onChange:k.onChange,checkboxLabel:$(O.label),disabled:O.required||k.isBusy,required:O.required,lang:p},Y))})}),C?.length&&F({label:e("account.other_registration_details"),saveButton:e("account.update_consents"),onSubmit:k=>t.updateConsents(Bn(v,k.consentsValues)),content:k=>n.jsx("div",{className:Fr.customFields,"data-testid":void 0,children:C.map(O=>n.jsx(Yl,{type:O.type,name:`consentsValues.${O.name}`,options:O.options,label:$(O.label),placeholder:O.placeholder,value:k.values.consentsValues[O.name],disabled:O.type==="checkbox"&&O.required||k.isBusy,onChange:k.onChange,required:O.required},O.name))})}),b&&F({label:e("account.export_data_title"),content:k=>n.jsxs("div",{className:Fr.textWithButtonContainer,children:[n.jsx("div",{children:n.jsx(Gc,{t:e,i18nKey:"account.export_data_body",values:{email:k.values.email}})}),n.jsx("div",{children:n.jsx(D,{label:e("account.export_data_title"),type:"button",disabled:l.isLoading,onClick:async()=>{l.mutate()}})})]})}),x&&F({label:e("account.delete_account.title"),content:()=>n.jsxs("div",{className:Fr.textWithButtonContainer,children:[n.jsx("div",{children:e("account.delete_account.body")}),n.jsx("div",{children:n.jsx(D,{label:e("account.delete_account.title"),type:"button",variant:"danger",onClick:()=>{a(q(o,j?"warning-account-deletion":"delete-account"))}})})]})})].filter(Fu)}),b&&n.jsx(Oa,{open:d,message:h,onClose:()=>u(!1),isSuccess:l.isSuccess})]})},Gj="_header_ljwt2_1",Jj={header:Gj},Yj={[z.xs]:2,[z.sm]:3,[z.md]:3,[z.lg]:3,[z.xl]:3},Kj=({playlist:t,accessModel:e,hasSubscription:s,onCardHover:r,onClearFavoritesClick:a})=>{const{t:o}=I("user"),i=c=>ue({id:c.mediaid,title:c.title,playlistId:c.feedid});return n.jsxs("div",{children:[n.jsxs("div",{className:Jj.header,children:[n.jsx("h1",{children:o("favorites.title")}),t.playlist.length>0?n.jsx(D,{label:o("favorites.clear"),onClick:a}):null]}),t.playlist.length>0?n.jsx(zs,{getUrl:i,playlist:t,onCardHover:r,cols:Yj,isLoading:!1,accessModel:e,isLoggedIn:!0,hasSubscription:s}):n.jsx("p",{children:o("favorites.no_favorites")})]})},Qj=()=>{const t=W(fs),{accessModel:e,favoritesList:s}=H(l=>({accessModel:l.accessModel,favoritesList:l.config.features?.favoritesList}),Q),{t:r}=I("user"),[a,o]=m.useState(!1),{subscription:i}=B(),c=pt(l=>l.getPlaylist());return s?n.jsxs(n.Fragment,{children:[n.jsx(Kj,{playlist:c,onClearFavoritesClick:()=>o(!0),accessModel:e,hasSubscription:!!i}),n.jsx(V_,{open:a,title:r("favorites.clear_favorites_title"),body:r("favorites.clear_favorites_body"),onConfirm:async()=>{await t.clear(),o(!1)},onClose:()=>o(!1)})]}):null},Xj=(t,e,s,r)=>{const a=W(ie),o=W(vt),i=it(a.updateUser,{onSuccess:()=>{B.setState({loading:!1})}});return it(o.changeSubscription,{onSuccess:()=>{!t&&e&&i.mutate({firstName:s?.firstName||"",lastName:s?.lastName||"",metadata:{[`${r}_pending_downgrade`]:e}})}})},Zj=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{d:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"})),eC="_offerSwitchContainer_booqe_1",tC="_activeOfferSwitchContainer_booqe_13",sC="_offerSwitchInfoContainer_booqe_18",nC="_offerSwitchPlanContainer_booqe_28",rC="_currentPlanHeading_booqe_36",aC="_activeCurrentPlanHeading_booqe_41",oC="_nextBillingDate_booqe_45",iC="_price_booqe_51",cC="_paymentFrequency_booqe_57",Rt={offerSwitchContainer:eC,activeOfferSwitchContainer:tC,offerSwitchInfoContainer:sC,offerSwitchPlanContainer:nC,currentPlanHeading:rC,activeCurrentPlanHeading:aC,nextBillingDate:oC,price:iC,paymentFrequency:cC},lC=({isCurrentOffer:t,pendingDowngradeOfferId:e,offer:s,selected:r,onChange:a,expiresAt:o})=>{const{t:i,i18n:c}=I(["user","account"]),{customerPriceInclTax:l,customerCurrency:d,period:u}=s,h=e===s.offerId;return n.jsxs("div",{className:L(Rt.offerSwitchContainer,{[Rt.activeOfferSwitchContainer]:r}),children:[n.jsx(er,{disabled:h,name:s.offerId,checked:r,onChange:()=>a(s.offerId)}),n.jsxs("div",{className:Rt.offerSwitchInfoContainer,children:[(t||h)&&n.jsxs("div",{className:L(Rt.currentPlanHeading,{[Rt.activeCurrentPlanHeading]:r}),children:[t&&i("user:payment.current_plan").toUpperCase(),h&&i("user:payment.pending_downgrade").toUpperCase()]}),n.jsxs("div",{className:Rt.offerSwitchPlanContainer,children:[n.jsx("div",{children:i(`user:payment.${u==="month"?"monthly":"annual"}_subscription`)}),(t||h)&&o&&n.jsxs("div",{className:Rt.nextBillingDate,children:[t&&!e&&i("user:payment.next_billing_date_on",{date:kt(new Date(o*1e3),c.language)}),h&&i("user:payment.downgrade_on",{date:kt(new Date(o*1e3),c.language)})]})]})]}),n.jsxs("div",{className:Rt.price,children:[ot(l,d,void 0),n.jsxs("span",{className:Rt.paymentFrequency,children:["/",i(`account:periods.${u}_one`)]})]})]})},dC="_infoBox_6csa0_1",uC="_transactionItem_6csa0_22",hC="_pendingSwitch_6csa0_31",mC="_transactionDetails_6csa0_36",pC="_transactionPrice_6csa0_56",fC="_price_6csa0_60",gC="_explanation_6csa0_69",_C="_cardDetails_6csa0_73",yC="_paypal_6csa0_78",vC="_upgradeSubscription_6csa0_90",xC="_changePlanContainer_6csa0_99",bC="_changePlanButtons_6csa0_105",wC="_changePlanCancelButton_6csa0_112",SC="_editCard_6csa0_116",De={infoBox:dC,transactionItem:uC,pendingSwitch:hC,transactionDetails:mC,transactionPrice:pC,price:fC,explanation:gC,cardDetails:_C,paypal:yC,upgradeSubscription:vC,changePlanContainer:xC,changePlanButtons:bC,changePlanCancelButton:wC,editCard:SC},Uc=4,jC=({accessModel:t,activePaymentDetail:e,activeSubscription:s,pendingOffer:r,transactions:a,customer:o,isLoading:i,panelClassName:c,panelHeaderClassName:l,onShowAllTransactionsClick:d,showAllTransactions:u,onShowReceiptClick:h,canRenewSubscription:p=!1,canShowReceipts:g=!1,canUpdatePaymentMethod:f,onUpgradeSubscriptionClick:y,offerSwitchesAvailable:v,offers:_=[],pendingDowngradeOfferId:b="",changeSubscriptionPlan:x,onChangePlanClick:P,selectedOfferId:w,setSelectedOfferId:j,isUpgradeOffer:S,setIsUpgradeOffer:C,isExternalPaymentProvider:E,paymentProvider:A,paymentProviderLink:T})=>{const $=dt("subscription-details"),U=dt("payment-method"),F=dt("billing-history"),{t:N,i18n:k}=I(["user","account"]),O=a?a?.length-Uc:0,Y=O>0,ce=se(),ne=re(),Te=s?.period==="granted",Se=pe()===z.xs,[fe,$e]=m.useState(!1);m.useEffect(()=>{fe||j(s?.accessFeeId??null)},[s,fe,j]),m.useEffect(()=>{$e(!1)},[s?.status,s?.pendingSwitchId]),m.useEffect(()=>{w&&_&&C((_.find(X=>X.offerId===w)?.customerPriceInclTax??0)>(_.find(X=>X.offerId===s?.accessFeeId)?.customerPriceInclTax??0))},[w,_,s,C]);function Oe(){ce(q(ne,"choose-offer"))}function Qe(){ce(q(ne,"edit-card"))}function G(){ce(q(ne,"unsubscribe"))}function be(){ce(q(ne,"renew-subscription"))}function ze(X){switch(X){case"month":return N("user:payment.monthly_subscription");case"year":return N("user:payment.annual_subscription");case"day":return N("user:payment.daily_subscription");case"week":return N("user:payment.weekly_subscription");case"granted":return N("user:payment.granted_subscription");default:return N("user:payment.other")}}const Xe=!E&&v||!fe&&!p;return n.jsxs(n.Fragment,{children:[n.jsx(Oa,{isSuccess:!x.isError,message:x.isError?N("user:payment.change_plan_error"):S?N("user:payment.upgrade_plan_success"):N("user:payment.downgrade_plan_success",{date:s?.expiresAt&&kt(new Date(s.expiresAt*1e3),k.language)}),open:fe&&(x.isSuccess||x.isError),onClose:()=>{x.reset(),$e(!1)}}),n.jsx("h1",{className:"hideUntilFocus",children:N("nav.payments")}),t===Ae.SVOD&&n.jsxs("section",{"aria-labelledby":$,className:c,children:[n.jsx("div",{className:l,children:n.jsx("h2",{id:$,children:N(fe?"user:payment.change_plan":"user:payment.subscription_details")})}),s?n.jsxs(he.Fragment,{children:[!fe&&n.jsxs("div",{className:De.infoBox,children:[n.jsxs("p",{children:[n.jsx("strong",{children:ze(s.period)})," ",n.jsx("br",{}),s.status==="active"&&!Te&&!b?N("user:payment.next_billing_date_on",{date:kt(new Date(s.expiresAt*1e3),k.language)}):N("user:payment.subscription_expires_on",{date:kt(new Date(s.expiresAt*1e3),k.language)}),(r||b)&&s.status!=="cancelled"&&n.jsx("span",{className:De.pendingSwitch,children:N("user:payment.pending_offer_switch",{title:ze(r?.period||_.find(X=>X.offerId===b)?.period||"month")})})]}),!Te&&n.jsxs("p",{className:De.price,children:[n.jsx("strong",{children:ot(s.nextPaymentPrice,s.nextPaymentCurrency,o.country)}),n.jsxs("small",{children:["/",N(`account:periods.${s.period}`)]})]})]},s.subscriptionId),E?n.jsxs("p",{className:De.explanation,children:[N("account:external_payment.explanation",{paymentProvider:A})," ",n.jsx(ln,{href:T,target:"_blank",children:N("account:external_payment.manage_subscription")})]}):Xe&&n.jsx(D,{className:De.upgradeSubscription,label:N("user:payment.change_subscription"),disabled:!p&&s.status==="cancelled",onClick:()=>{_.length>1&&!p?$e(!0):y?.()},fullWidth:Se,color:"primary","data-testid":"change-subscription-button"}),(s.status==="active"||s.status==="active_trial")&&!Te&&!fe&&p?n.jsx(D,{label:N("user:payment.cancel_subscription"),onClick:G,fullWidth:Se,"data-testid":"cancel-subscription-button"}):p?n.jsx(D,{label:N("user:payment.renew_subscription"),onClick:be}):null]}):i?null:n.jsxs(he.Fragment,{children:[n.jsx("p",{children:N("user:payment.no_subscription")}),n.jsx(D,{variant:"contained",color:"primary",label:N("user:payment.complete_subscription"),onClick:Oe})]}),fe&&n.jsxs("div",{className:De.changePlanContainer,children:[_.filter(X=>X.planSwitchEnabled).map(X=>n.jsx(lC,{isCurrentOffer:X.offerId===s?.accessFeeId,pendingDowngradeOfferId:b,offer:X,selected:w===X.offerId,onChange:Ht=>j(Ht),expiresAt:s?.expiresAt},X.offerId)),n.jsxs("div",{className:De.changePlanButtons,children:[n.jsx(D,{label:N("user:account.save"),onClick:P,disabled:w===s?.accessFeeId||x.isLoading}),n.jsx(D,{label:N("user:account.cancel"),onClick:()=>$e(!1),variant:"text"}),s?.status!=="cancelled"&&n.jsx(D,{className:De.changePlanCancelButton,label:N("user:payment.cancel_subscription"),onClick:G,variant:"danger","data-testid":"cancel-subscription-button"})]})]})]}),n.jsxs("section",{"aria-labelledby":U,className:c,children:[n.jsx("div",{className:l,children:n.jsx("h2",{id:U,children:N("user:payment.payment_method")})}),e?e.paymentMethod==="paypal"?n.jsxs("div",{children:[n.jsxs("div",{className:De.paypal,children:[n.jsx(V,{icon:wa})," ",N("account:payment.paypal")]}),e.currency]}):n.jsxs("div",{children:[n.jsx(ae,{label:N("user:payment.card_number"),name:"cardNumber",value:`   ${e.paymentMethodSpecificParams.lastCardFourDigits||""}`,"aria-label":N("user:payment.card_number_hidden",{number:e.paymentMethodSpecificParams.lastCardFourDigits}),editing:!1,autoComplete:"cc-number"}),n.jsxs("div",{className:De.cardDetails,children:[n.jsx(ae,{label:N("user:payment.expiry_date"),name:"cardExpiry",value:e.paymentMethodSpecificParams.cardExpirationDate,editing:!1,autoComplete:"cc-exp"}),n.jsx(ae,{label:N("user:payment.security_code"),name:"cardSecurityCode",value:"******",editing:!1,"aria-label":N("user:payment.security_code_hidden"),autoComplete:"cc-csc"})]}),n.jsx(D,{className:L({[De.editCard]:f}),label:N("account:payment.edit_card"),variant:"outlined",onClick:Qe})]},e.id):n.jsx("div",{children:n.jsx("p",{children:!i&&N("user:payment.no_payment_methods")})}),f&&n.jsx(D,{label:N("user:payment.update_payment_details"),type:"button",onClick:()=>ce(q(ne,"payment-method"))})]}),n.jsxs("section",{"aria-labelledby":F,className:c,children:[n.jsx("div",{className:l,children:n.jsx("h2",{id:F,children:N("user:payment.billing_history")})}),a?.length?n.jsxs(he.Fragment,{children:[a?.slice(0,u?9999:Uc).map(X=>n.jsxs("div",{className:De.infoBox,children:[n.jsxs("p",{className:De.transactionItem,children:[n.jsx("strong",{children:kt(new Date(X.transactionDate*1e3),k.language)}),n.jsx("span",{children:X.offerTitle}),n.jsx("span",{children:X.transactionId})]}),n.jsxs("div",{className:De.transactionDetails,children:[n.jsx("div",{className:De.transactionPrice,children:!Te&&N("user:payment.price_paid_with",{price:ot(parseFloat(X.transactionPriceInclTax),X.transactionCurrency,X.customerCountry),method:X.paymentMethod})}),g&&n.jsx(Re,{"aria-label":N("user:payment.show_receipt"),onClick:()=>!i&&h(X?.trxToken??X.transactionId),children:n.jsx(V,{icon:Zj})})]})]},X.transactionId)),!u&&Y?n.jsxs(he.Fragment,{children:[n.jsx("p",{children:N("user:payment.hidden_transactions",{count:O})}),n.jsx(D,{label:N("user:payment.show_all"),onClick:d})]}):null]}):n.jsx("div",{children:n.jsx("p",{children:!i&&N("user:payment.no_transactions")})})]}),i&&n.jsx(ve,{inline:!0})]})},CC=(t,e)=>{if(t instanceof Blob){const s=window.URL.createObjectURL(new Blob([t])),r=document.createElement("a");r.href=s,r.setAttribute("download",`receipt_${e}.pdf`),document.body.appendChild(r),r.click()}else{const s=window.open("",`Receipt ${e}`,""),r=window.atob(t);s&&(s.opener=null,s.document.write(r),s.document.close())}},PC=["Apple In-App","storekit2","Google In-App","android","Roku In-App"],sn={apple:"https://support.apple.com/118428",google:"https://support.google.com/googleplay/answer/7018481",roku:"https://support.roku.com/article/208756478"},EC={apple:sn.apple,storekit2:sn.apple,google:sn.google,android:sn.google,roku:sn.roku},kC=()=>{const t=W(ie),e=se(),{accessModel:s}=H(({accessModel:N})=>({accessModel:N}),Q),{user:r,subscription:a,transactions:o,activePayment:i,pendingOffer:c,loading:l}=B(),{canUpdatePaymentMethod:d,canShowReceipts:u,canRenewSubscription:h}=t.getFeatures(),{subscriptionOffers:p,switchSubscriptionOffers:g}=Sa(),[f,y]=m.useState(!1),[v,_]=m.useState(!1),[b,x]=m.useState(a?.accessFeeId??null),[P,w]=m.useState(void 0),j=re();m.useEffect(()=>{s===Ae.AVOD&&e(cn)},[s,e]);const S=async()=>e(q(j,"upgrade-subscription")),C=async N=>{_(!0);try{const k=await t.getReceipt(N);k&&CC(k,N)}catch(k){throw new Error("Couldn't parse receipt. "+(k instanceof Error?k.message:""))}_(!1)},E=Xj(P??!1,b,r,a?.subscriptionId),A=async()=>{b&&a?.subscriptionId&&E.mutate({accessFeeId:b.slice(1),subscriptionId:`${a.subscriptionId}`})};if(!r)return n.jsx(ve,{});const T=r.metadata?.[`${a?.subscriptionId}_pending_downgrade`]||"",$=!!a&&PC.includes(a.paymentMethod),U=a?.paymentMethod.split(" ")[0]||"unknown",F=EC[U.toLowerCase()];return n.jsx(jC,{accessModel:s,activeSubscription:a,activePaymentDetail:i,transactions:o,customer:r,pendingOffer:c,isLoading:l||v,panelClassName:He.panel,panelHeaderClassName:He.panelHeader,onShowAllTransactionsClick:()=>y(!0),showAllTransactions:f,canUpdatePaymentMethod:d,canRenewSubscription:h,onUpgradeSubscriptionClick:S,offerSwitchesAvailable:g.length>0,canShowReceipts:u,onShowReceiptClick:C,offers:p,pendingDowngradeOfferId:T,changeSubscriptionPlan:E,onChangePlanClick:A,selectedOfferId:b,setSelectedOfferId:N=>x(N),isUpgradeOffer:P,setIsUpgradeOffer:N=>w(N),isExternalPaymentProvider:$,paymentProvider:U,paymentProviderLink:F})};function IC(){const t=se(),e=re(),s=B(i=>typeof i.user?.uuid=="string"?i.user.uuid:void 0),r=W(ie),{hasNotifications:a}=r?.getFeatures()||{},o=ee((i,c)=>{t(q(e,i,c))});m.useEffect(()=>{!s||!a||r?.subscribeToNotifications({uuid:s,onMessage:async i=>{if(i){const c=JSON.parse(i);switch(c.type){case".failed":case"payment.card.failed":case"subscribe.failed":o("payment-error",c.resource?.message);break;case"payment.card.success":await Promise.allSettled([Cl.invalidateQueries(["entitlements"]),r.reloadSubscriptions()]),o(null);break;case"subscribe.success":await r.reloadSubscriptions();break;case"access.revoked":await r.reloadSubscriptions();break;case"payment.card.requires.action":case"subscribe.requires.action":window.location.href=c.resource?.redirect_to_url;break}}}})},[r,a,o,s])}const NC=()=>{const{i18n:t}=I(),e=re(),s=B(r=>({loading:r.loading,user:r.user}),Q);return IC(),m.useEffect(()=>{document.documentElement.setAttribute("lang",t.language)},[t.language]),s.user&&!s.loading&&window.location.href.includes("#token")?n.jsx(Os,{to:{...e,hash:""},replace:!0}):n.jsx(na,{})};function AC(){const{t}=I("error");return n.jsx(_u,{children:n.jsx(Me,{element:n.jsx(NC,{}),children:n.jsxs(Me,{element:n.jsx(Fj,{}),errorElement:n.jsx(q_,{}),children:[n.jsx(Me,{index:!0,element:n.jsx(ax,{})}),n.jsx(Me,{path:la,element:n.jsx(Rc,{type:Ft.playlist})}),n.jsx(Me,{path:nl,element:n.jsx(Rc,{type:Ft.content_list})}),n.jsx(Me,{path:sl,element:n.jsx(j1,{})}),n.jsx(Me,{path:Hu,element:n.jsx(Nw,{})}),n.jsx(Me,{path:Wu,element:n.jsx(mx,{})}),n.jsxs(Me,{path:qu,element:n.jsx(bx,{}),children:[n.jsx(Me,{path:cn,element:n.jsx(zj,{})}),n.jsx(Me,{path:da,element:n.jsx(Qj,{})}),n.jsx(Me,{path:ua,element:n.jsx(kC,{})}),n.jsx(Me,{path:"*",element:n.jsx(Os,{to:cn})})]}),n.jsx(Me,{path:Vu,element:n.jsx(Z_,{})}),n.jsx(Me,{path:"/*",element:n.jsx(Ke,{title:t("notfound_error_heading","Not found"),message:t("notfound_error_description","This page doesn't exist.")})})]})})})}const TC=t=>(typeof t=="string"?t.replace(/\s+/g,"").split(","):[]).map(s=>({type:"playlist",contentId:s})),LC=({data:t})=>{const e=m.useMemo(()=>TC(t.playlists||t.playlist),[t.playlist,t.playlists]);return m.useEffect(()=>{(document.scrollingElement||document.body).scroll({top:0}),document.querySelector("#video-details button")?.focus()},[t]),n.jsxs("header",{children:[n.jsxs(Aa,{image:t.backgroundImage,children:[n.jsx(id,{title:t.title}),n.jsx(Ta,{description:t.description})]}),n.jsx(td,{rows:e})]})};function $C(){$t.registerByContentType(LC,Ve.hub)}function OC(t,e){const[s,r]=Ds();return m.useLayoutEffect(()=>{t&&(s.has(nn)&&(!e||e===t?.defaultConfigSource)&&r(a=>(a.delete(nn),a),{replace:!0}),e&&e!==t?.defaultConfigSource&&s.get(nn)!==e&&r(a=>(a.set(nn,e),a),{replace:!0}))},[e,s,r,t]),e}const MC=({error:t})=>t instanceof $s?n.jsx(Ke,{title:t.payload.title,message:t.payload.description,helpLink:t.payload.helpLink,error:t}):n.jsx(Ke,{error:t}),DC=({query:t})=>{const{isLoading:e,error:s}=t;return e?n.jsx(ve,{}):s?n.jsx(MC,{error:s}):null},RC=({onReady:t})=>{const e=F_(window.location.href,t);return OC(e.data?.settings,e.data?.configSource),n.jsx(DC,{query:e})},FC=()=>{const[t,e]=m.useState(!1);m.useEffect(()=>{$C()},[]);const s=m.useCallback(async r=>{r&&(B_(r),e(!0))},[]);return n.jsxs(n.Fragment,{children:[t&&n.jsx(AC,{}),t&&n.jsx(M_,{}),t&&n.jsx(Xm,{onOpen:()=>Ee.setState({cookieWallOpen:!0}),onClose:()=>Ee.setState({cookieWallOpen:!1})}),n.jsx(RC,{onReady:s})]})};function BC(){const[t,e]=m.useState({isLoading:!0});return m.useEffect(()=>{vm().then(()=>e({isLoading:!1})).catch(s=>e({isLoading:!1,error:s}))},[]),t.isLoading?n.jsx(ve,{}):t.error?(Pe("App","Failed to load translations",{error:t.error}),n.jsx(Pl,{title:"Unable to load translations",message:"Check your language settings and try again later. If the problem persists contact technical support.",error:t.error})):n.jsx(Yh,{children:n.jsx(yu,{children:n.jsx(fm,{children:n.jsx(FC,{})})})})}const UC=Object.freeze(Object.defineProperty({__proto__:null,default:BC},Symbol.toStringTag,{value:"Module"}));export{ra as _,w0 as a,GC as c,JC as g};
//# sourceMappingURL=index-CcuyHatq.js.map
